nohup: ignoring input
10:20:07 [INFO] __main__: === Game Server starting ===
10:20:07 [INFO] __main__: Loading configuration …
10:20:07 [INFO] __main__:   items:        210 loaded from config
10:20:07 [INFO] __main__:   map:          4 paths, 23 build tiles from config/maps/default.yaml
10:20:07 [INFO] __main__:   ai_templates: 2 entries from config/ai_templates.yaml
10:20:07 [INFO] __main__: Initializing persistence …
10:20:07 [INFO] gameserver.persistence.database: Database connected: gameserver.db
10:20:07 [INFO] __main__:   database:     connected (gameserver.db)
10:20:07 [INFO] gameserver.persistence.state_load: Restoring state from state.yaml (saved at 2026-02-08T10:20:05, version 1)
10:20:07 [INFO] gameserver.persistence.state_load: Restored 2 empires, 0 attacks, 0 battles
10:20:07 [INFO] __main__:   state:        restored from disk (2 empires, 0 attacks)
10:20:07 [INFO] __main__: Creating services …
10:20:07 [INFO] __main__:   upgrade_provider: 210 items registered
10:20:07 [INFO] __main__:   all services created
10:20:07 [INFO] __main__: Wiring event handlers …
10:20:07 [INFO] __main__:   event handlers registered
10:20:07 [INFO] gameserver.engine.empire_service: Empire registered: uid=100 name='TestImperium'
10:20:07 [INFO] gameserver.engine.empire_service: Empire registered: uid=2 name='Empire1'
10:20:07 [INFO] __main__: Restored 2 empires from saved state
10:20:07 [INFO] __main__: Starting network server …
10:20:07 [INFO] gameserver.network.handlers: Registered 29 message handlers: summary_request, item_request, military_request, new_item, new_structure, delete_structure, upgrade_structure, citizen_upgrade, change_citizen, increase_life, new_army, new_attack_request, change_army, new_wave, change_wave, end_siege, battle_register, battle_unregister, battle_next_wave_request, notification_request, user_message, timeline_request, userinfo_request, hall_of_fame_request, preferences_request, change_preferences, auth_request, signup, create_empire
10:20:07 [INFO] websockets.server: server listening on 0.0.0.0:8765
10:20:07 [INFO] gameserver.network.server: WebSocket server listening on ws://0.0.0.0:8765
10:20:07 [INFO] __main__:   WebSocket server listening on 0.0.0.0:8765
10:20:07 [INFO] gameserver.debug.dashboard: Debug dashboard running at http://0.0.0.0:9000/
10:20:07 [INFO] __main__: Starting game loop …
10:20:07 [INFO] __main__:   game loop running (1 s tick)
10:20:08 [INFO] websockets.server: connection open
10:20:08 [INFO] gameserver.network.server: Session registered: uid=-1
10:20:08 [INFO] gameserver.network.server: Client connected: uid=-1 remote=('192.168.178.2', 54946)
10:20:08 [INFO] gameserver.network.auth: Login success: eem (uid=2)
10:22:19 [INFO] gameserver.network.server: Session removed: uid=-1
10:22:20 [INFO] websockets.server: connection open
10:22:20 [INFO] gameserver.network.server: Session registered: uid=-2
10:22:20 [INFO] gameserver.network.server: Client connected: uid=-2 remote=('192.168.178.2', 60774)
10:22:20 [INFO] gameserver.network.auth: Login success: eem (uid=2)
10:22:32 [INFO] gameserver.network.server: Session removed: uid=-2
10:22:32 [INFO] websockets.server: connection open
10:22:32 [INFO] gameserver.network.server: Session registered: uid=-3
10:22:32 [INFO] gameserver.network.server: Client connected: uid=-3 remote=('192.168.178.2', 60781)
10:22:32 [INFO] gameserver.network.auth: Login success: eem (uid=2)
10:22:33 [INFO] gameserver.network.server: Session removed: uid=-3
10:22:33 [INFO] websockets.server: connection open
10:22:33 [INFO] gameserver.network.server: Session registered: uid=-4
10:22:33 [INFO] gameserver.network.server: Client connected: uid=-4 remote=('192.168.178.2', 60783)
10:22:33 [INFO] gameserver.network.auth: Login success: eem (uid=2)
10:22:33 [INFO] gameserver.network.server: Session removed: uid=-4
10:22:33 [INFO] websockets.server: connection open
10:22:33 [INFO] gameserver.network.server: Session registered: uid=-5
10:22:33 [INFO] gameserver.network.server: Client connected: uid=-5 remote=('192.168.178.2', 60788)
10:22:33 [INFO] gameserver.network.auth: Login success: eem (uid=2)
10:23:56 [INFO] gameserver.network.server: Session removed: uid=-5
10:23:56 [INFO] websockets.server: connection open
10:23:56 [INFO] gameserver.network.server: Session registered: uid=-6
10:23:56 [INFO] gameserver.network.server: Client connected: uid=-6 remote=('192.168.178.2', 61681)
10:23:56 [INFO] gameserver.network.auth: Login success: eem (uid=2)
10:25:00 [INFO] gameserver.network.server: Session removed: uid=-6
10:25:00 [INFO] websockets.server: connection open
10:25:00 [INFO] gameserver.network.server: Session registered: uid=-7
10:25:00 [INFO] gameserver.network.server: Client connected: uid=-7 remote=('192.168.178.2', 49843)
10:25:00 [INFO] gameserver.network.auth: Login success: eem (uid=2)
10:32:54 [INFO] gameserver.network.server: Session removed: uid=-7
10:32:54 [INFO] websockets.server: connection open
10:32:54 [INFO] gameserver.network.server: Session registered: uid=-8
10:32:54 [INFO] gameserver.network.server: Client connected: uid=-8 remote=('192.168.178.2', 57852)
10:32:54 [INFO] gameserver.network.auth: Login success: eem (uid=2)
10:35:58 [INFO] gameserver.network.server: Session removed: uid=-8
10:35:58 [INFO] websockets.server: connection open
10:35:58 [INFO] gameserver.network.server: Session registered: uid=-9
10:35:58 [INFO] gameserver.network.server: Client connected: uid=-9 remote=('192.168.178.2', 65249)
10:35:58 [INFO] gameserver.network.auth: Login success: eem (uid=2)
10:36:40 [INFO] gameserver.debug.dashboard: Signal sent (handled): type=summary_request sender=2
10:39:33 [INFO] __main__: Shutdown signal received — stopping …
10:39:33 [INFO] __main__: Shutting down …
10:39:33 [INFO] gameserver.persistence.state_save: Game state saved to state.yaml (2 empires, 0 attacks, 0 battles)
10:39:33 [INFO] websockets.server: server closing
10:39:33 [INFO] gameserver.network.server: Session removed: uid=-9
10:39:33 [INFO] websockets.server: server closed
10:39:33 [INFO] gameserver.network.server: WebSocket server stopped
10:39:33 [INFO] __main__:   WebSocket server stopped
10:39:33 [INFO] __main__:   debug dashboard stopped
10:39:33 [INFO] __main__:   database closed
10:39:33 [INFO] __main__:   goodbye
12:40:09 [INFO] __main__: === Game Server starting ===
12:40:09 [INFO] __main__: Loading configuration …
12:40:10 [INFO] __main__:   items:        210 loaded from config
12:40:10 [INFO] __main__:   map:          4 paths, 23 build tiles from config/maps/default.yaml
12:40:10 [INFO] __main__:   ai_templates: 2 entries from config/ai_templates.yaml
12:40:10 [INFO] gameserver.loaders.game_config_loader: Loaded game config from config/game.yaml (29 keys)
12:40:10 [INFO] __main__:   game_config:  loaded
12:40:10 [INFO] __main__: Initializing persistence …
12:40:10 [INFO] gameserver.persistence.database: Database connected: gameserver.db
12:40:10 [INFO] __main__:   database:     connected (gameserver.db)
12:40:10 [INFO] gameserver.persistence.state_load: Restoring state from state.yaml (saved at 2026-02-08T12:35:38, version 1)
12:40:10 [INFO] gameserver.persistence.state_load: Restored 2 empires, 0 attacks, 0 battles
12:40:10 [INFO] __main__:   state:        restored from disk (2 empires, 0 attacks)
12:40:10 [INFO] __main__: Creating services …
12:40:10 [INFO] __main__:   upgrade_provider: 210 items registered
12:40:10 [INFO] __main__:   all services created
12:40:10 [INFO] __main__: Wiring event handlers …
12:40:10 [INFO] __main__:   event handlers registered
12:40:10 [INFO] gameserver.engine.empire_service: Empire registered: uid=100 name='TestImperium'
12:40:10 [INFO] gameserver.engine.empire_service: Empire 100: recalculated effects → {}
12:40:10 [INFO] gameserver.engine.empire_service: Empire registered: uid=2 name='Empire1'
12:40:10 [INFO] gameserver.engine.empire_service: Empire 2: recalculated effects → {'gold_offset': 0.1}
12:40:10 [INFO] __main__: Restored 2 empires from saved state
12:40:10 [INFO] __main__: Starting network server …
12:40:10 [INFO] gameserver.network.handlers: Registered 29 message handlers: summary_request, item_request, military_request, new_item, new_structure, delete_structure, upgrade_structure, citizen_upgrade, change_citizen, increase_life, new_army, new_attack_request, change_army, new_wave, change_wave, end_siege, battle_register, battle_unregister, battle_next_wave_request, notification_request, user_message, timeline_request, userinfo_request, hall_of_fame_request, preferences_request, change_preferences, auth_request, signup, create_empire
12:40:10 [INFO] websockets.server: server listening on 0.0.0.0:8765
12:40:10 [INFO] gameserver.network.server: WebSocket server listening on ws://0.0.0.0:8765
12:40:10 [INFO] __main__:   WebSocket server listening on 0.0.0.0:8765
12:40:10 [INFO] gameserver.debug.dashboard: Debug dashboard running at http://0.0.0.0:9000/
12:40:10 [INFO] __main__: Starting game loop …
12:40:10 [INFO] __main__:   game loop running (1 s tick)
12:40:31 [INFO] websockets.server: connection open
12:40:31 [INFO] gameserver.network.server: Session registered: uid=-1
12:40:31 [INFO] gameserver.network.server: Client connected: uid=-1 remote=('192.168.178.2', 56636)
12:40:31 [INFO] gameserver.network.auth: Login success: eem (uid=2)
12:42:17 [INFO] __main__: Shutdown signal received — stopping …
12:42:17 [INFO] __main__: Shutting down …
12:42:17 [INFO] gameserver.persistence.state_save: Game state saved to state.yaml (2 empires, 0 attacks, 0 battles)
12:42:17 [INFO] websockets.server: server closing
12:42:17 [INFO] gameserver.network.server: Session removed: uid=-1
12:42:17 [INFO] websockets.server: server closed
12:42:17 [INFO] gameserver.network.server: WebSocket server stopped
12:42:17 [INFO] __main__:   WebSocket server stopped
12:42:17 [INFO] __main__:   debug dashboard stopped
12:42:17 [INFO] __main__:   database closed
12:42:17 [INFO] __main__:   goodbye
12:42:19 [INFO] __main__: === Game Server starting ===
12:42:19 [INFO] __main__: Loading configuration …
12:42:20 [INFO] __main__:   items:        210 loaded from config
12:42:20 [INFO] __main__:   map:          4 paths, 23 build tiles from config/maps/default.yaml
12:42:20 [INFO] __main__:   ai_templates: 2 entries from config/ai_templates.yaml
12:42:20 [INFO] gameserver.loaders.game_config_loader: Loaded game config from config/game.yaml (29 keys)
12:42:20 [INFO] __main__:   game_config:  loaded
12:42:20 [INFO] __main__: Initializing persistence …
12:42:20 [INFO] gameserver.persistence.database: Database connected: gameserver.db
12:42:20 [INFO] __main__:   database:     connected (gameserver.db)
12:42:20 [INFO] gameserver.persistence.state_load: Restoring state from state.yaml (saved at 2026-02-08T12:42:17, version 1)
12:42:20 [INFO] gameserver.persistence.state_load: Restored 2 empires, 0 attacks, 0 battles
12:42:20 [INFO] __main__:   state:        restored from disk (2 empires, 0 attacks)
12:42:20 [INFO] __main__: Creating services …
12:42:20 [INFO] __main__:   upgrade_provider: 210 items registered
12:42:20 [INFO] __main__:   all services created
12:42:20 [INFO] __main__: Wiring event handlers …
12:42:20 [INFO] __main__:   event handlers registered
12:42:20 [INFO] gameserver.engine.empire_service: Empire registered: uid=100 name='TestImperium'
12:42:20 [INFO] gameserver.engine.empire_service: Empire 100: recalculated effects → {}
12:42:20 [INFO] gameserver.engine.empire_service: Empire registered: uid=2 name='Empire1'
12:42:20 [INFO] gameserver.engine.empire_service: Empire 2: recalculated effects → {'gold_offset': 0.1}
12:42:20 [INFO] __main__: Restored 2 empires from saved state
12:42:20 [INFO] __main__: Starting network server …
12:42:20 [INFO] gameserver.network.handlers: Registered 29 message handlers: summary_request, item_request, military_request, new_item, new_structure, delete_structure, upgrade_structure, citizen_upgrade, change_citizen, increase_life, new_army, new_attack_request, change_army, new_wave, change_wave, end_siege, battle_register, battle_unregister, battle_next_wave_request, notification_request, user_message, timeline_request, userinfo_request, hall_of_fame_request, preferences_request, change_preferences, auth_request, signup, create_empire
12:42:20 [INFO] websockets.server: server listening on 0.0.0.0:8765
12:42:20 [INFO] gameserver.network.server: WebSocket server listening on ws://0.0.0.0:8765
12:42:20 [INFO] __main__:   WebSocket server listening on 0.0.0.0:8765
12:42:20 [INFO] gameserver.debug.dashboard: Debug dashboard running at http://0.0.0.0:9000/
12:42:20 [INFO] __main__: Starting game loop …
12:42:20 [INFO] __main__:   game loop running (1 s tick)
12:42:20 [INFO] websockets.server: connection open
12:42:20 [INFO] gameserver.network.server: Session registered: uid=-1
12:42:20 [INFO] gameserver.network.server: Client connected: uid=-1 remote=('192.168.178.2', 59611)
12:42:20 [INFO] gameserver.network.auth: Login success: eem (uid=2)
12:42:27 [INFO] gameserver.network.server: Session removed: uid=-1
12:42:27 [INFO] websockets.server: connection open
12:42:27 [INFO] gameserver.network.server: Session registered: uid=-2
12:42:27 [INFO] gameserver.network.server: Client connected: uid=-2 remote=('192.168.178.2', 59634)
12:42:27 [INFO] gameserver.network.auth: Login success: eem (uid=2)
12:42:30 [INFO] gameserver.engine.empire_service: Empire 2: started building MAIN_HOUSE (effort=100.0)
12:42:30 [INFO] gameserver.network.handlers: new_item success uid=2 iid=MAIN_HOUSE
12:44:09 [INFO] gameserver.engine.empire_service: Empire 2: building MAIN_HOUSE completed
12:44:40 [INFO] gameserver.network.server: Session removed: uid=-2
12:44:40 [INFO] websockets.server: connection open
12:44:40 [INFO] gameserver.network.server: Session registered: uid=-3
12:44:40 [INFO] gameserver.network.server: Client connected: uid=-3 remote=('192.168.178.2', 60855)
12:44:40 [INFO] gameserver.network.auth: Login success: eem (uid=2)
13:15:01 [INFO] __main__: Shutdown signal received — stopping …
13:15:02 [INFO] __main__: Shutting down …
13:15:02 [INFO] gameserver.persistence.state_save: Game state saved to state.yaml (2 empires, 0 attacks, 0 battles)
13:15:02 [INFO] websockets.server: server closing
13:15:02 [INFO] gameserver.network.server: Session removed: uid=-3
13:15:02 [INFO] websockets.server: server closed
13:15:02 [INFO] gameserver.network.server: WebSocket server stopped
13:15:02 [INFO] __main__:   WebSocket server stopped
13:15:02 [INFO] __main__:   debug dashboard stopped
13:15:02 [INFO] __main__:   database closed
13:15:02 [INFO] __main__:   goodbye
13:15:03 [INFO] __main__: === Game Server starting ===
13:15:03 [INFO] __main__: Loading configuration …
Traceback (most recent call last):
  File "/usr/lib/python3.9/runpy.py", line 197, in _run_module_as_main
    return _run_code(code, main_globals, None,
  File "/usr/lib/python3.9/runpy.py", line 87, in _run_code
    exec(code, run_globals)
  File "/home/pi/e3/python_server/src/gameserver/main.py", line 426, in <module>
    main()
  File "/home/pi/e3/python_server/src/gameserver/main.py", line 422, in main
    asyncio.run(_start())
  File "/usr/lib/python3.9/asyncio/runners.py", line 44, in run
    return loop.run_until_complete(main)
  File "/usr/lib/python3.9/asyncio/base_events.py", line 642, in run_until_complete
    return future.result()
  File "/home/pi/e3/python_server/src/gameserver/main.py", line 370, in _start
    config = load_configuration()
  File "/home/pi/e3/python_server/src/gameserver/main.py", line 127, in load_configuration
    items = load_items(items_path)
  File "/home/pi/e3/python_server/src/gameserver/loaders/item_loader.py", line 83, in load_items
    data = yaml.safe_load(f) or {}
  File "/home/pi/e3/.venv/lib/python3.9/site-packages/yaml/__init__.py", line 125, in safe_load
    return load(stream, SafeLoader)
  File "/home/pi/e3/.venv/lib/python3.9/site-packages/yaml/__init__.py", line 81, in load
    return loader.get_single_data()
  File "/home/pi/e3/.venv/lib/python3.9/site-packages/yaml/constructor.py", line 49, in get_single_data
    node = self.get_single_node()
  File "/home/pi/e3/.venv/lib/python3.9/site-packages/yaml/composer.py", line 36, in get_single_node
    document = self.compose_document()
  File "/home/pi/e3/.venv/lib/python3.9/site-packages/yaml/composer.py", line 55, in compose_document
    node = self.compose_node(None, None)
  File "/home/pi/e3/.venv/lib/python3.9/site-packages/yaml/composer.py", line 84, in compose_node
    node = self.compose_mapping_node(anchor)
  File "/home/pi/e3/.venv/lib/python3.9/site-packages/yaml/composer.py", line 133, in compose_mapping_node
    item_value = self.compose_node(node, item_key)
  File "/home/pi/e3/.venv/lib/python3.9/site-packages/yaml/composer.py", line 84, in compose_node
    node = self.compose_mapping_node(anchor)
  File "/home/pi/e3/.venv/lib/python3.9/site-packages/yaml/composer.py", line 127, in compose_mapping_node
    while not self.check_event(MappingEndEvent):
  File "/home/pi/e3/.venv/lib/python3.9/site-packages/yaml/parser.py", line 98, in check_event
    self.current_event = self.state()
  File "/home/pi/e3/.venv/lib/python3.9/site-packages/yaml/parser.py", line 428, in parse_block_mapping_key
    if self.check_token(KeyToken):
  File "/home/pi/e3/.venv/lib/python3.9/site-packages/yaml/scanner.py", line 115, in check_token
    while self.need_more_tokens():
  File "/home/pi/e3/.venv/lib/python3.9/site-packages/yaml/scanner.py", line 152, in need_more_tokens
    self.stale_possible_simple_keys()
  File "/home/pi/e3/.venv/lib/python3.9/site-packages/yaml/scanner.py", line 291, in stale_possible_simple_keys
    raise ScannerError("while scanning a simple key", key.mark,
yaml.scanner.ScannerError: while scanning a simple key
  in "config/buildings.yaml", line 286, column 3
could not find expected ':'
  in "config/buildings.yaml", line 288, column 1
13:15:45 [INFO] __main__: === Game Server starting ===
13:15:45 [INFO] __main__: Loading configuration …
13:15:46 [INFO] __main__:   items:        210 loaded from config
13:15:46 [INFO] __main__:   map:          4 paths, 23 build tiles from config/maps/default.yaml
13:15:46 [INFO] __main__:   ai_templates: 2 entries from config/ai_templates.yaml
13:15:46 [INFO] gameserver.loaders.game_config_loader: Loaded game config from config/game.yaml (29 keys)
13:15:46 [INFO] __main__:   game_config:  loaded
13:15:46 [INFO] __main__: Initializing persistence …
13:15:46 [INFO] gameserver.persistence.database: Database connected: gameserver.db
13:15:46 [INFO] __main__:   database:     connected (gameserver.db)
13:15:46 [INFO] gameserver.persistence.state_load: Restoring state from state.yaml (saved at 2026-02-08T13:15:02, version 1)
13:15:46 [INFO] gameserver.persistence.state_load: Restored 2 empires, 0 attacks, 0 battles
13:15:46 [INFO] __main__:   state:        restored from disk (2 empires, 0 attacks)
13:15:46 [INFO] __main__: Creating services …
13:15:46 [INFO] __main__:   upgrade_provider: 210 items registered
13:15:46 [INFO] __main__:   all services created
13:15:46 [INFO] __main__: Wiring event handlers …
13:15:46 [INFO] __main__:   event handlers registered
13:15:46 [INFO] gameserver.engine.empire_service: Empire registered: uid=100 name='TestImperium'
13:15:46 [INFO] gameserver.engine.empire_service: Empire 100: recalculated effects → {}
13:15:46 [INFO] gameserver.engine.empire_service: Empire registered: uid=2 name='Empire1'
13:15:46 [INFO] gameserver.engine.empire_service: Empire 2: recalculated effects → {'gold_offset': 0.15000000000000002}
13:15:46 [INFO] __main__: Restored 2 empires from saved state
13:15:46 [INFO] __main__: Starting network server …
13:15:46 [INFO] gameserver.network.handlers: Registered 29 message handlers: summary_request, item_request, military_request, new_item, new_structure, delete_structure, upgrade_structure, citizen_upgrade, change_citizen, increase_life, new_army, new_attack_request, change_army, new_wave, change_wave, end_siege, battle_register, battle_unregister, battle_next_wave_request, notification_request, user_message, timeline_request, userinfo_request, hall_of_fame_request, preferences_request, change_preferences, auth_request, signup, create_empire
13:15:46 [INFO] websockets.server: server listening on 0.0.0.0:8765
13:15:46 [INFO] gameserver.network.server: WebSocket server listening on ws://0.0.0.0:8765
13:15:46 [INFO] __main__:   WebSocket server listening on 0.0.0.0:8765
13:15:46 [INFO] gameserver.debug.dashboard: Debug dashboard running at http://0.0.0.0:9000/
13:15:46 [INFO] __main__: Starting game loop …
13:15:46 [INFO] __main__:   game loop running (1 s tick)
13:15:46 [INFO] websockets.server: connection open
13:15:46 [INFO] gameserver.network.server: Session registered: uid=-1
13:15:46 [INFO] gameserver.network.server: Client connected: uid=-1 remote=('192.168.178.2', 57131)
13:15:46 [INFO] gameserver.network.auth: Login success: eem (uid=2)
13:16:18 [INFO] gameserver.network.server: Session removed: uid=-1
13:16:18 [INFO] websockets.server: connection open
13:16:18 [INFO] gameserver.network.server: Session registered: uid=-2
13:16:18 [INFO] gameserver.network.server: Client connected: uid=-2 remote=('192.168.178.2', 57192)
13:16:18 [INFO] gameserver.network.auth: Login success: eem (uid=2)
13:21:33 [INFO] gameserver.engine.empire_service: Empire 2: started research HUNTING (effort=20.0)
13:21:33 [INFO] gameserver.network.handlers: new_item success uid=2 iid=HUNTING
13:21:53 [INFO] gameserver.engine.empire_service: Empire 2: knowledge HUNTING completed
13:25:51 [INFO] gameserver.network.server: Session removed: uid=-2
13:25:51 [INFO] websockets.server: connection open
13:25:51 [INFO] gameserver.network.server: Session registered: uid=-3
13:25:51 [INFO] gameserver.network.server: Client connected: uid=-3 remote=('192.168.178.2', 56773)
13:25:51 [INFO] gameserver.network.auth: Login success: eem (uid=2)
13:26:23 [INFO] __main__: Shutdown signal received — stopping …
13:26:24 [INFO] __main__: Shutting down …
13:26:24 [INFO] gameserver.persistence.state_save: Game state saved to state.yaml (2 empires, 0 attacks, 0 battles)
13:26:24 [INFO] websockets.server: server closing
13:26:24 [INFO] gameserver.network.server: Session removed: uid=-3
13:26:24 [INFO] websockets.server: server closed
13:26:24 [INFO] gameserver.network.server: WebSocket server stopped
13:26:24 [INFO] __main__:   WebSocket server stopped
13:26:24 [INFO] __main__:   debug dashboard stopped
13:26:24 [INFO] __main__:   database closed
13:26:24 [INFO] __main__:   goodbye
13:26:25 [INFO] __main__: === Game Server starting ===
13:26:25 [INFO] __main__: Loading configuration …
13:26:26 [INFO] __main__:   items:        210 loaded from config
13:26:26 [INFO] __main__:   map:          4 paths, 23 build tiles from config/maps/default.yaml
13:26:26 [INFO] __main__:   ai_templates: 2 entries from config/ai_templates.yaml
13:26:26 [INFO] gameserver.loaders.game_config_loader: Loaded game config from config/game.yaml (29 keys)
13:26:26 [INFO] __main__:   game_config:  loaded
13:26:26 [INFO] __main__: Initializing persistence …
13:26:26 [INFO] gameserver.persistence.database: Database connected: gameserver.db
13:26:26 [INFO] __main__:   database:     connected (gameserver.db)
13:26:26 [INFO] gameserver.persistence.state_load: Restoring state from state.yaml (saved at 2026-02-08T13:26:24, version 1)
13:26:26 [INFO] gameserver.persistence.state_load: Restored 2 empires, 0 attacks, 0 battles
13:26:26 [INFO] __main__:   state:        restored from disk (2 empires, 0 attacks)
13:26:26 [INFO] __main__: Creating services …
13:26:26 [INFO] __main__:   upgrade_provider: 210 items registered
13:26:26 [INFO] __main__:   all services created
13:26:26 [INFO] __main__: Wiring event handlers …
13:26:26 [INFO] __main__:   event handlers registered
13:26:26 [INFO] gameserver.engine.empire_service: Empire registered: uid=100 name='TestImperium'
13:26:26 [INFO] gameserver.engine.empire_service: Empire 100: recalculated effects → {}
13:26:26 [INFO] gameserver.engine.empire_service: Empire registered: uid=2 name='Empire1'
13:26:26 [INFO] gameserver.engine.empire_service: Empire 2: recalculated effects → {'gold_offset': 0.15000000000000002}
13:26:26 [INFO] __main__: Restored 2 empires from saved state
13:26:26 [INFO] __main__: Starting network server …
13:26:26 [INFO] gameserver.network.handlers: Registered 29 message handlers: summary_request, item_request, military_request, new_item, new_structure, delete_structure, upgrade_structure, citizen_upgrade, change_citizen, increase_life, new_army, new_attack_request, change_army, new_wave, change_wave, end_siege, battle_register, battle_unregister, battle_next_wave_request, notification_request, user_message, timeline_request, userinfo_request, hall_of_fame_request, preferences_request, change_preferences, auth_request, signup, create_empire
13:26:26 [INFO] websockets.server: server listening on 0.0.0.0:8765
13:26:26 [INFO] gameserver.network.server: WebSocket server listening on ws://0.0.0.0:8765
13:26:26 [INFO] __main__:   WebSocket server listening on 0.0.0.0:8765
13:26:26 [INFO] gameserver.debug.dashboard: Debug dashboard running at http://0.0.0.0:9000/
13:26:26 [INFO] __main__: Starting game loop …
13:26:26 [INFO] __main__:   game loop running (1 s tick)
13:26:27 [INFO] websockets.server: connection open
13:26:27 [INFO] gameserver.network.server: Session registered: uid=-1
13:26:27 [INFO] gameserver.network.server: Client connected: uid=-1 remote=('192.168.178.2', 56819)
13:26:27 [INFO] gameserver.network.auth: Login success: eem (uid=2)
13:26:29 [INFO] gameserver.network.server: Session removed: uid=-1
13:26:29 [INFO] websockets.server: connection open
13:26:29 [INFO] gameserver.network.server: Session registered: uid=-2
13:26:29 [INFO] gameserver.network.server: Client connected: uid=-2 remote=('192.168.178.2', 56842)
13:26:29 [INFO] gameserver.network.auth: Login success: eem (uid=2)
13:26:42 [INFO] gameserver.engine.empire_service: Empire 2: started research MYSTIC (effort=100.0)
13:26:42 [INFO] gameserver.network.handlers: new_item success uid=2 iid=MYSTIC
13:27:03 [INFO] gameserver.network.server: Session removed: uid=-2
13:27:03 [INFO] websockets.server: connection open
13:27:03 [INFO] gameserver.network.server: Session registered: uid=-3
13:27:03 [INFO] gameserver.network.server: Client connected: uid=-3 remote=('192.168.178.2', 52638)
13:27:03 [INFO] gameserver.network.auth: Login success: eem (uid=2)
13:27:04 [INFO] gameserver.network.server: Session removed: uid=-3
13:27:04 [INFO] websockets.server: connection open
13:27:04 [INFO] gameserver.network.server: Session registered: uid=-4
13:27:04 [INFO] gameserver.network.server: Client connected: uid=-4 remote=('192.168.178.2', 52659)
13:27:04 [INFO] gameserver.network.auth: Login success: eem (uid=2)
13:27:55 [INFO] gameserver.network.server: Session removed: uid=-4
13:27:55 [INFO] websockets.server: connection open
13:27:55 [INFO] gameserver.network.server: Session registered: uid=-5
13:27:55 [INFO] gameserver.network.server: Client connected: uid=-5 remote=('192.168.178.2', 54950)
13:27:55 [INFO] gameserver.network.auth: Login success: eem (uid=2)
13:27:57 [INFO] __main__: Shutdown signal received — stopping …
13:27:58 [INFO] __main__: Shutting down …
13:27:58 [INFO] gameserver.persistence.state_save: Game state saved to state.yaml (2 empires, 0 attacks, 0 battles)
13:27:58 [INFO] websockets.server: server closing
13:27:58 [INFO] gameserver.network.server: Session removed: uid=-5
13:27:58 [INFO] websockets.server: server closed
13:27:58 [INFO] gameserver.network.server: WebSocket server stopped
13:27:58 [INFO] __main__:   WebSocket server stopped
13:27:58 [INFO] __main__:   debug dashboard stopped
13:27:58 [INFO] __main__:   database closed
13:27:58 [INFO] __main__:   goodbye
13:27:59 [INFO] __main__: === Game Server starting ===
13:27:59 [INFO] __main__: Loading configuration …
13:28:00 [INFO] __main__:   items:        210 loaded from config
13:28:00 [INFO] __main__:   map:          4 paths, 23 build tiles from config/maps/default.yaml
13:28:00 [INFO] __main__:   ai_templates: 2 entries from config/ai_templates.yaml
13:28:00 [INFO] gameserver.loaders.game_config_loader: Loaded game config from config/game.yaml (29 keys)
13:28:00 [INFO] __main__:   game_config:  loaded
13:28:00 [INFO] __main__: Initializing persistence …
13:28:00 [INFO] gameserver.persistence.database: Database connected: gameserver.db
13:28:00 [INFO] __main__:   database:     connected (gameserver.db)
13:28:00 [INFO] gameserver.persistence.state_load: Restoring state from state.yaml (saved at 2026-02-08T13:27:58, version 1)
13:28:00 [INFO] gameserver.persistence.state_load: Restored 2 empires, 0 attacks, 0 battles
13:28:00 [INFO] __main__:   state:        restored from disk (2 empires, 0 attacks)
13:28:00 [INFO] __main__: Creating services …
13:28:00 [INFO] __main__:   upgrade_provider: 210 items registered
13:28:00 [INFO] __main__:   all services created
13:28:00 [INFO] __main__: Wiring event handlers …
13:28:00 [INFO] __main__:   event handlers registered
13:28:00 [INFO] gameserver.engine.empire_service: Empire registered: uid=100 name='TestImperium'
13:28:00 [INFO] gameserver.engine.empire_service: Empire 100: recalculated effects → {}
13:28:00 [INFO] gameserver.engine.empire_service: Empire registered: uid=2 name='Empire1'
13:28:00 [INFO] gameserver.engine.empire_service: Empire 2: recalculated effects → {'gold_offset': 0.15000000000000002}
13:28:00 [INFO] __main__: Restored 2 empires from saved state
13:28:00 [INFO] __main__: Starting network server …
13:28:00 [INFO] gameserver.network.handlers: Registered 29 message handlers: summary_request, item_request, military_request, new_item, new_structure, delete_structure, upgrade_structure, citizen_upgrade, change_citizen, increase_life, new_army, new_attack_request, change_army, new_wave, change_wave, end_siege, battle_register, battle_unregister, battle_next_wave_request, notification_request, user_message, timeline_request, userinfo_request, hall_of_fame_request, preferences_request, change_preferences, auth_request, signup, create_empire
13:28:00 [INFO] websockets.server: server listening on 0.0.0.0:8765
13:28:00 [INFO] gameserver.network.server: WebSocket server listening on ws://0.0.0.0:8765
13:28:00 [INFO] __main__:   WebSocket server listening on 0.0.0.0:8765
13:28:00 [INFO] gameserver.debug.dashboard: Debug dashboard running at http://0.0.0.0:9000/
13:28:00 [INFO] __main__: Starting game loop …
13:28:00 [INFO] __main__:   game loop running (1 s tick)
13:28:01 [INFO] websockets.server: connection open
13:28:01 [INFO] gameserver.network.server: Session registered: uid=-1
13:28:01 [INFO] gameserver.network.server: Client connected: uid=-1 remote=('192.168.178.2', 63715)
13:28:01 [INFO] gameserver.network.auth: Login success: eem (uid=2)
13:28:01 [INFO] gameserver.network.server: Session removed: uid=-1
13:28:02 [INFO] websockets.server: connection open
13:28:02 [INFO] gameserver.network.server: Session registered: uid=-2
13:28:02 [INFO] gameserver.network.server: Client connected: uid=-2 remote=('192.168.178.2', 63737)
13:28:02 [INFO] gameserver.network.auth: Login success: eem (uid=2)
13:31:00 [INFO] gameserver.network.server: Session removed: uid=-2
13:31:00 [INFO] websockets.server: connection open
13:31:00 [INFO] gameserver.network.server: Session registered: uid=-3
13:31:00 [INFO] gameserver.network.server: Client connected: uid=-3 remote=('192.168.178.2', 62671)
13:31:00 [INFO] gameserver.network.auth: Login success: eem (uid=2)
13:31:20 [INFO] gameserver.network.server: Session removed: uid=-3
13:31:20 [INFO] websockets.server: connection open
13:31:20 [INFO] gameserver.network.server: Session registered: uid=-4
13:31:20 [INFO] gameserver.network.server: Client connected: uid=-4 remote=('192.168.178.2', 62690)
13:31:20 [INFO] gameserver.network.auth: Login success: eem (uid=2)
13:31:28 [INFO] gameserver.network.server: Session removed: uid=-4
13:31:28 [INFO] websockets.server: connection open
13:31:28 [INFO] gameserver.network.server: Session registered: uid=-5
13:31:28 [INFO] gameserver.network.server: Client connected: uid=-5 remote=('192.168.178.2', 62698)
13:31:28 [INFO] gameserver.network.auth: Login success: eem (uid=2)
13:31:29 [INFO] gameserver.network.server: Session removed: uid=-5
13:31:29 [INFO] websockets.server: connection open
13:31:29 [INFO] gameserver.network.server: Session registered: uid=-6
13:31:29 [INFO] gameserver.network.server: Client connected: uid=-6 remote=('192.168.178.2', 62701)
13:31:29 [INFO] gameserver.network.auth: Login success: eem (uid=2)
13:31:32 [INFO] gameserver.network.server: Session removed: uid=-6
13:31:32 [INFO] websockets.server: connection open
13:31:32 [INFO] gameserver.network.server: Session registered: uid=-7
13:31:32 [INFO] gameserver.network.server: Client connected: uid=-7 remote=('192.168.178.2', 62706)
13:31:32 [INFO] gameserver.network.auth: Login success: eem (uid=2)
13:31:41 [INFO] gameserver.network.server: Session removed: uid=-7
13:31:41 [INFO] websockets.server: connection open
13:31:41 [INFO] gameserver.network.server: Session registered: uid=-8
13:31:41 [INFO] gameserver.network.server: Client connected: uid=-8 remote=('192.168.178.2', 62713)
13:31:41 [INFO] gameserver.network.auth: Login success: eem (uid=2)
13:31:58 [INFO] gameserver.debug.dashboard: Signal sent (handled): type=item_request sender=0
13:32:03 [INFO] gameserver.debug.dashboard: Signal sent (handled): type=summary_request sender=100
13:32:06 [INFO] gameserver.debug.dashboard: Signal sent (handled): type=summary_request sender=2
13:32:34 [INFO] __main__: Shutdown signal received — stopping …
13:32:35 [INFO] __main__: Shutting down …
13:32:35 [INFO] gameserver.persistence.state_save: Game state saved to state.yaml (2 empires, 0 attacks, 0 battles)
13:32:35 [INFO] websockets.server: server closing
13:32:35 [INFO] gameserver.network.server: Session removed: uid=-8
13:32:35 [INFO] websockets.server: server closed
13:32:35 [INFO] gameserver.network.server: WebSocket server stopped
13:32:35 [INFO] __main__:   WebSocket server stopped
13:32:35 [INFO] __main__:   debug dashboard stopped
13:32:35 [INFO] __main__:   database closed
13:32:35 [INFO] __main__:   goodbye
13:32:36 [INFO] __main__: === Game Server starting ===
13:32:36 [INFO] __main__: Loading configuration …
13:32:36 [INFO] __main__:   items:        210 loaded from config
13:32:36 [INFO] __main__:   map:          4 paths, 23 build tiles from config/maps/default.yaml
13:32:36 [INFO] __main__:   ai_templates: 2 entries from config/ai_templates.yaml
13:32:36 [INFO] gameserver.loaders.game_config_loader: Loaded game config from config/game.yaml (29 keys)
13:32:36 [INFO] __main__:   game_config:  loaded
13:32:36 [INFO] __main__: Initializing persistence …
13:32:36 [INFO] gameserver.persistence.database: Database connected: gameserver.db
13:32:36 [INFO] __main__:   database:     connected (gameserver.db)
13:32:36 [INFO] gameserver.persistence.state_load: Restoring state from state.yaml (saved at 2026-02-08T13:32:35, version 1)
13:32:36 [INFO] gameserver.persistence.state_load: Restored 2 empires, 0 attacks, 0 battles
13:32:36 [INFO] __main__:   state:        restored from disk (2 empires, 0 attacks)
13:32:36 [INFO] __main__: Creating services …
13:32:36 [INFO] __main__:   upgrade_provider: 210 items registered
13:32:36 [INFO] __main__:   all services created
13:32:36 [INFO] __main__: Wiring event handlers …
13:32:36 [INFO] __main__:   event handlers registered
13:32:36 [INFO] gameserver.engine.empire_service: Empire registered: uid=100 name='TestImperium'
13:32:36 [INFO] gameserver.engine.empire_service: Empire 100: recalculated effects → {}
13:32:36 [INFO] gameserver.engine.empire_service: Empire registered: uid=2 name='Empire1'
13:32:36 [INFO] gameserver.engine.empire_service: Empire 2: recalculated effects → {'gold_offset': 0.15000000000000002}
13:32:36 [INFO] __main__: Restored 2 empires from saved state
13:32:36 [INFO] __main__: Starting network server …
13:32:36 [INFO] gameserver.network.handlers: Registered 29 message handlers: summary_request, item_request, military_request, new_item, new_structure, delete_structure, upgrade_structure, citizen_upgrade, change_citizen, increase_life, new_army, new_attack_request, change_army, new_wave, change_wave, end_siege, battle_register, battle_unregister, battle_next_wave_request, notification_request, user_message, timeline_request, userinfo_request, hall_of_fame_request, preferences_request, change_preferences, auth_request, signup, create_empire
13:32:36 [INFO] websockets.server: server listening on 0.0.0.0:8765
13:32:36 [INFO] gameserver.network.server: WebSocket server listening on ws://0.0.0.0:8765
13:32:36 [INFO] __main__:   WebSocket server listening on 0.0.0.0:8765
13:32:36 [INFO] gameserver.debug.dashboard: Debug dashboard running at http://0.0.0.0:9000/
13:32:36 [INFO] __main__: Starting game loop …
13:32:36 [INFO] __main__:   game loop running (1 s tick)
13:32:38 [INFO] websockets.server: connection open
13:32:38 [INFO] gameserver.network.server: Session registered: uid=-1
13:32:38 [INFO] gameserver.network.server: Client connected: uid=-1 remote=('192.168.178.2', 55671)
13:32:38 [INFO] gameserver.network.auth: Login success: eem (uid=2)
13:33:08 [INFO] gameserver.network.server: Session removed: uid=-1
13:33:09 [INFO] websockets.server: connection open
13:33:09 [INFO] gameserver.network.server: Session registered: uid=-2
13:33:09 [INFO] gameserver.network.server: Client connected: uid=-2 remote=('192.168.178.2', 55961)
13:33:09 [INFO] gameserver.network.auth: Login success: eem (uid=2)
13:33:10 [INFO] gameserver.network.server: Session removed: uid=-2
13:33:10 [INFO] websockets.server: connection open
13:33:10 [INFO] gameserver.network.server: Session registered: uid=-3
13:33:10 [INFO] gameserver.network.server: Client connected: uid=-3 remote=('192.168.178.2', 55965)
13:33:10 [INFO] gameserver.network.auth: Login success: eem (uid=2)
13:33:13 [INFO] gameserver.network.server: Session removed: uid=-3
13:33:13 [INFO] websockets.server: connection open
13:33:13 [INFO] gameserver.network.server: Session registered: uid=-4
13:33:13 [INFO] gameserver.network.server: Client connected: uid=-4 remote=('192.168.178.2', 55987)
13:33:13 [INFO] gameserver.network.auth: Login success: eem (uid=2)
13:34:21 [INFO] gameserver.engine.empire_service: Empire 2: started building EARTH_WALL (effort=150.0)
13:34:21 [INFO] gameserver.network.handlers: new_item success uid=2 iid=EARTH_WALL
13:34:28 [INFO] __main__: Shutdown signal received — stopping …
13:34:29 [INFO] __main__: Shutting down …
13:34:29 [INFO] gameserver.persistence.state_save: Game state saved to state.yaml (2 empires, 0 attacks, 0 battles)
13:34:29 [INFO] websockets.server: server closing
13:34:29 [INFO] gameserver.network.server: Session removed: uid=-4
13:34:29 [INFO] websockets.server: server closed
13:34:29 [INFO] gameserver.network.server: WebSocket server stopped
13:34:29 [INFO] __main__:   WebSocket server stopped
13:34:29 [INFO] __main__:   debug dashboard stopped
13:34:29 [INFO] __main__:   database closed
13:34:29 [INFO] __main__:   goodbye
13:34:31 [INFO] __main__: === Game Server starting ===
13:34:31 [INFO] __main__: Loading configuration …
13:34:31 [INFO] __main__:   items:        210 loaded from config
13:34:31 [INFO] __main__:   map:          4 paths, 23 build tiles from config/maps/default.yaml
13:34:31 [INFO] __main__:   ai_templates: 2 entries from config/ai_templates.yaml
13:34:31 [INFO] gameserver.loaders.game_config_loader: Loaded game config from config/game.yaml (29 keys)
13:34:31 [INFO] __main__:   game_config:  loaded
13:34:31 [INFO] __main__: Initializing persistence …
13:34:32 [INFO] gameserver.persistence.database: Database connected: gameserver.db
13:34:32 [INFO] __main__:   database:     connected (gameserver.db)
13:34:32 [INFO] gameserver.persistence.state_load: Restoring state from state.yaml (saved at 2026-02-08T13:34:29, version 1)
13:34:32 [INFO] gameserver.persistence.state_load: Restored 2 empires, 0 attacks, 0 battles
13:34:32 [INFO] __main__:   state:        restored from disk (2 empires, 0 attacks)
13:34:32 [INFO] __main__: Creating services …
13:34:32 [INFO] __main__:   upgrade_provider: 210 items registered
13:34:32 [INFO] __main__:   all services created
13:34:32 [INFO] __main__: Wiring event handlers …
13:34:32 [INFO] __main__:   event handlers registered
13:34:32 [INFO] gameserver.engine.empire_service: Empire registered: uid=100 name='TestImperium'
13:34:32 [INFO] gameserver.engine.empire_service: Empire 100: recalculated effects → {}
13:34:32 [INFO] gameserver.engine.empire_service: Empire registered: uid=2 name='Empire1'
13:34:32 [INFO] gameserver.engine.empire_service: Empire 2: recalculated effects → {'gold_offset': 0.15000000000000002}
13:34:32 [INFO] __main__: Restored 2 empires from saved state
13:34:32 [INFO] __main__: Starting network server …
13:34:32 [INFO] gameserver.network.handlers: Registered 29 message handlers: summary_request, item_request, military_request, new_item, new_structure, delete_structure, upgrade_structure, citizen_upgrade, change_citizen, increase_life, new_army, new_attack_request, change_army, new_wave, change_wave, end_siege, battle_register, battle_unregister, battle_next_wave_request, notification_request, user_message, timeline_request, userinfo_request, hall_of_fame_request, preferences_request, change_preferences, auth_request, signup, create_empire
13:34:32 [INFO] websockets.server: server listening on 0.0.0.0:8765
13:34:32 [INFO] gameserver.network.server: WebSocket server listening on ws://0.0.0.0:8765
13:34:32 [INFO] __main__:   WebSocket server listening on 0.0.0.0:8765
13:34:32 [INFO] gameserver.debug.dashboard: Debug dashboard running at http://0.0.0.0:9000/
13:34:32 [INFO] __main__: Starting game loop …
13:34:32 [INFO] __main__:   game loop running (1 s tick)
13:34:32 [INFO] websockets.server: connection open
13:34:32 [INFO] gameserver.network.server: Session registered: uid=-1
13:34:32 [INFO] gameserver.network.server: Client connected: uid=-1 remote=('192.168.178.2', 56773)
13:34:32 [INFO] gameserver.network.auth: Login success: eem (uid=2)
13:34:53 [INFO] gameserver.network.server: Session removed: uid=-1
13:34:53 [INFO] websockets.server: connection open
13:34:53 [INFO] gameserver.network.server: Session registered: uid=-2
13:34:53 [INFO] gameserver.network.server: Client connected: uid=-2 remote=('192.168.178.2', 60033)
13:34:53 [INFO] gameserver.network.auth: Login success: eem (uid=2)
13:34:54 [INFO] gameserver.network.server: Session removed: uid=-2
13:34:54 [INFO] websockets.server: connection open
13:34:54 [INFO] gameserver.network.server: Session registered: uid=-3
13:34:54 [INFO] gameserver.network.server: Client connected: uid=-3 remote=('192.168.178.2', 60035)
13:34:54 [INFO] gameserver.network.auth: Login success: eem (uid=2)
13:34:55 [INFO] gameserver.network.server: Session removed: uid=-3
13:34:55 [INFO] websockets.server: connection open
13:34:55 [INFO] gameserver.network.server: Session registered: uid=-4
13:34:55 [INFO] gameserver.network.server: Client connected: uid=-4 remote=('192.168.178.2', 60037)
13:34:55 [INFO] gameserver.network.auth: Login success: eem (uid=2)
13:34:56 [INFO] __main__: Shutdown signal received — stopping …
13:34:57 [INFO] __main__: Shutting down …
13:34:57 [INFO] gameserver.persistence.state_save: Game state saved to state.yaml (2 empires, 0 attacks, 0 battles)
13:34:57 [INFO] websockets.server: server closing
13:34:57 [INFO] gameserver.network.server: Session removed: uid=-4
13:34:57 [INFO] websockets.server: server closed
13:34:57 [INFO] gameserver.network.server: WebSocket server stopped
13:34:57 [INFO] __main__:   WebSocket server stopped
13:34:57 [INFO] __main__:   debug dashboard stopped
13:34:57 [INFO] __main__:   database closed
13:34:57 [INFO] __main__:   goodbye
13:34:58 [INFO] __main__: === Game Server starting ===
13:34:58 [INFO] __main__: Loading configuration …
13:34:59 [INFO] __main__:   items:        210 loaded from config
13:34:59 [INFO] __main__:   map:          4 paths, 23 build tiles from config/maps/default.yaml
13:34:59 [INFO] __main__:   ai_templates: 2 entries from config/ai_templates.yaml
13:34:59 [INFO] gameserver.loaders.game_config_loader: Loaded game config from config/game.yaml (29 keys)
13:34:59 [INFO] __main__:   game_config:  loaded
13:34:59 [INFO] __main__: Initializing persistence …
13:34:59 [INFO] gameserver.persistence.database: Database connected: gameserver.db
13:34:59 [INFO] __main__:   database:     connected (gameserver.db)
13:34:59 [INFO] gameserver.persistence.state_load: Restoring state from state.yaml (saved at 2026-02-08T13:34:57, version 1)
13:34:59 [INFO] gameserver.persistence.state_load: Restored 2 empires, 0 attacks, 0 battles
13:34:59 [INFO] __main__:   state:        restored from disk (2 empires, 0 attacks)
13:34:59 [INFO] __main__: Creating services …
13:34:59 [INFO] __main__:   upgrade_provider: 210 items registered
13:34:59 [INFO] __main__:   all services created
13:34:59 [INFO] __main__: Wiring event handlers …
13:34:59 [INFO] __main__:   event handlers registered
13:34:59 [INFO] gameserver.engine.empire_service: Empire registered: uid=100 name='TestImperium'
13:34:59 [INFO] gameserver.engine.empire_service: Empire 100: recalculated effects → {}
13:34:59 [INFO] gameserver.engine.empire_service: Empire registered: uid=2 name='Empire1'
13:34:59 [INFO] gameserver.engine.empire_service: Empire 2: recalculated effects → {'gold_offset': 0.15000000000000002}
13:34:59 [INFO] __main__: Restored 2 empires from saved state
13:34:59 [INFO] __main__: Starting network server …
13:34:59 [INFO] gameserver.network.handlers: Registered 29 message handlers: summary_request, item_request, military_request, new_item, new_structure, delete_structure, upgrade_structure, citizen_upgrade, change_citizen, increase_life, new_army, new_attack_request, change_army, new_wave, change_wave, end_siege, battle_register, battle_unregister, battle_next_wave_request, notification_request, user_message, timeline_request, userinfo_request, hall_of_fame_request, preferences_request, change_preferences, auth_request, signup, create_empire
13:34:59 [INFO] websockets.server: server listening on 0.0.0.0:8765
13:34:59 [INFO] gameserver.network.server: WebSocket server listening on ws://0.0.0.0:8765
13:34:59 [INFO] __main__:   WebSocket server listening on 0.0.0.0:8765
13:34:59 [INFO] gameserver.debug.dashboard: Debug dashboard running at http://0.0.0.0:9000/
13:34:59 [INFO] __main__: Starting game loop …
13:34:59 [INFO] __main__:   game loop running (1 s tick)
13:35:00 [INFO] websockets.server: connection open
13:35:00 [INFO] gameserver.network.server: Session registered: uid=-1
13:35:00 [INFO] gameserver.network.server: Client connected: uid=-1 remote=('192.168.178.2', 60043)
13:35:00 [INFO] gameserver.network.auth: Login success: eem (uid=2)
13:35:01 [INFO] gameserver.network.server: Session removed: uid=-1
13:35:01 [INFO] websockets.server: connection open
13:35:01 [INFO] gameserver.network.server: Session registered: uid=-2
13:35:01 [INFO] gameserver.network.server: Client connected: uid=-2 remote=('192.168.178.2', 60047)
13:35:01 [INFO] gameserver.network.auth: Login success: eem (uid=2)
13:35:02 [INFO] gameserver.network.server: Session removed: uid=-2
13:35:02 [INFO] websockets.server: connection open
13:35:02 [INFO] gameserver.network.server: Session registered: uid=-3
13:35:02 [INFO] gameserver.network.server: Client connected: uid=-3 remote=('192.168.178.2', 60052)
13:35:02 [INFO] gameserver.network.auth: Login success: eem (uid=2)
13:35:02 [INFO] gameserver.network.server: Session removed: uid=-3
13:35:02 [INFO] websockets.server: connection open
13:35:02 [INFO] gameserver.network.server: Session registered: uid=-4
13:35:02 [INFO] gameserver.network.server: Client connected: uid=-4 remote=('192.168.178.2', 60054)
13:35:02 [INFO] gameserver.network.auth: Login success: eem (uid=2)
13:35:03 [INFO] gameserver.network.server: Session removed: uid=-4
13:35:03 [INFO] websockets.server: connection open
13:35:03 [INFO] gameserver.network.server: Session registered: uid=-5
13:35:03 [INFO] gameserver.network.server: Client connected: uid=-5 remote=('192.168.178.2', 60056)
13:35:03 [INFO] gameserver.network.auth: Login success: eem (uid=2)
13:35:04 [INFO] gameserver.network.server: Session removed: uid=-5
13:35:04 [INFO] websockets.server: connection open
13:35:04 [INFO] gameserver.network.server: Session registered: uid=-6
13:35:04 [INFO] gameserver.network.server: Client connected: uid=-6 remote=('192.168.178.2', 60076)
13:35:04 [INFO] gameserver.network.auth: Login success: eem (uid=2)
14:06:51 [INFO] __main__: Shutdown signal received — stopping …
14:06:52 [INFO] __main__: Shutting down …
14:06:52 [INFO] gameserver.persistence.state_save: Game state saved to state.yaml (2 empires, 0 attacks, 0 battles)
14:06:52 [INFO] websockets.server: server closing
14:06:52 [INFO] gameserver.network.server: Session removed: uid=-6
14:06:52 [INFO] websockets.server: server closed
14:06:52 [INFO] gameserver.network.server: WebSocket server stopped
14:06:52 [INFO] __main__:   WebSocket server stopped
14:06:52 [INFO] __main__:   debug dashboard stopped
14:06:52 [INFO] __main__:   database closed
14:06:52 [INFO] __main__:   goodbye
14:07:12 [INFO] __main__: === Game Server starting ===
14:07:12 [INFO] __main__: Loading configuration …
14:07:13 [INFO] __main__:   items:        210 loaded from config
14:07:13 [INFO] __main__:   map:          4 paths, 23 build tiles from config/maps/default.yaml
14:07:13 [INFO] __main__:   ai_templates: 2 entries from config/ai_templates.yaml
14:07:13 [INFO] gameserver.loaders.game_config_loader: Loaded game config from config/game.yaml (29 keys)
14:07:13 [INFO] __main__:   game_config:  loaded
14:07:13 [INFO] __main__: Initializing persistence …
14:07:13 [INFO] gameserver.persistence.database: Database connected: gameserver.db
14:07:13 [INFO] __main__:   database:     connected (gameserver.db)
14:07:13 [INFO] gameserver.persistence.state_load: Restoring state from state.yaml (saved at 2026-02-08T13:34:57, version 1)
14:07:13 [INFO] gameserver.persistence.state_load: Restored 2 empires, 0 attacks, 0 battles
14:07:13 [INFO] __main__:   state:        restored from disk (2 empires, 0 attacks)
14:07:13 [INFO] __main__: Creating services …
14:07:13 [INFO] __main__:   upgrade_provider: 210 items registered
14:07:13 [INFO] __main__:   all services created
14:07:13 [INFO] __main__: Wiring event handlers …
14:07:13 [INFO] __main__:   event handlers registered
14:07:13 [INFO] gameserver.engine.empire_service: Empire registered: uid=100 name='TestImperium'
14:07:13 [INFO] gameserver.engine.empire_service: Empire 100: recalculated effects → {}
14:07:13 [INFO] gameserver.engine.empire_service: Empire registered: uid=2 name='Empire1'
14:07:13 [INFO] gameserver.engine.empire_service: Empire 2: recalculated effects → {'gold_offset': 0.15000000000000002}
14:07:13 [INFO] __main__: Restored 2 empires from saved state
14:07:13 [INFO] __main__: Starting network server …
14:07:13 [INFO] gameserver.network.handlers: Registered 29 message handlers: summary_request, item_request, military_request, new_item, new_structure, delete_structure, upgrade_structure, citizen_upgrade, change_citizen, increase_life, new_army, new_attack_request, change_army, new_wave, change_wave, end_siege, battle_register, battle_unregister, battle_next_wave_request, notification_request, user_message, timeline_request, userinfo_request, hall_of_fame_request, preferences_request, change_preferences, auth_request, signup, create_empire
14:07:13 [INFO] websockets.server: server listening on 0.0.0.0:8765
14:07:13 [INFO] gameserver.network.server: WebSocket server listening on ws://0.0.0.0:8765
14:07:13 [INFO] __main__:   WebSocket server listening on 0.0.0.0:8765
14:07:13 [INFO] gameserver.debug.dashboard: Debug dashboard running at http://0.0.0.0:9000/
14:07:13 [INFO] __main__: Starting game loop …
14:07:13 [INFO] __main__:   game loop running (1 s tick)
14:07:15 [INFO] websockets.server: connection open
14:07:15 [INFO] gameserver.network.server: Session registered: uid=-1
14:07:15 [INFO] gameserver.network.server: Client connected: uid=-1 remote=('192.168.178.2', 54946)
14:07:15 [INFO] gameserver.network.auth: Login success: eem (uid=2)
14:07:37 [INFO] gameserver.engine.empire_service: Empire 2: knowledge MYSTIC completed
14:07:45 [INFO] gameserver.network.server: Session removed: uid=-1
14:07:46 [INFO] websockets.server: connection open
14:07:46 [INFO] gameserver.network.server: Session registered: uid=-2
14:07:46 [INFO] gameserver.network.server: Client connected: uid=-2 remote=('192.168.178.2', 58495)
14:07:46 [INFO] gameserver.network.auth: Login success: eem (uid=2)
14:08:16 [INFO] gameserver.network.handlers: new_item failed uid=2 iid=STONE_CIRCLE: Build queue is busy
14:09:36 [INFO] gameserver.engine.empire_service: Empire 2: building EARTH_WALL completed
14:10:32 [INFO] __main__: Shutdown signal received — stopping …
14:10:32 [INFO] __main__: Shutting down …
14:10:32 [INFO] gameserver.persistence.state_save: Game state saved to state.yaml (2 empires, 0 attacks, 0 battles)
14:10:32 [INFO] websockets.server: server closing
14:10:32 [INFO] gameserver.network.server: Session removed: uid=-2
14:10:32 [INFO] websockets.server: server closed
14:10:32 [INFO] gameserver.network.server: WebSocket server stopped
14:10:32 [INFO] __main__:   WebSocket server stopped
14:10:32 [INFO] __main__:   debug dashboard stopped
14:10:32 [INFO] __main__:   database closed
14:10:32 [INFO] __main__:   goodbye
14:10:33 [INFO] __main__: === Game Server starting ===
14:10:33 [INFO] __main__: Loading configuration …
14:10:34 [INFO] __main__:   items:        210 loaded from config
14:10:34 [INFO] __main__:   map:          4 paths, 23 build tiles from config/maps/default.yaml
14:10:34 [INFO] __main__:   ai_templates: 2 entries from config/ai_templates.yaml
14:10:34 [INFO] gameserver.loaders.game_config_loader: Loaded game config from config/game.yaml (29 keys)
14:10:34 [INFO] __main__:   game_config:  loaded
14:10:34 [INFO] __main__: Initializing persistence …
14:10:34 [INFO] gameserver.persistence.database: Database connected: gameserver.db
14:10:34 [INFO] __main__:   database:     connected (gameserver.db)
14:10:34 [INFO] gameserver.persistence.state_load: Restoring state from state.yaml (saved at 2026-02-08T14:10:32, version 1)
14:10:34 [INFO] gameserver.persistence.state_load: Restored 2 empires, 0 attacks, 0 battles
14:10:34 [INFO] __main__:   state:        restored from disk (2 empires, 0 attacks)
14:10:34 [INFO] __main__: Creating services …
14:10:34 [INFO] __main__:   upgrade_provider: 210 items registered
14:10:34 [INFO] __main__:   all services created
14:10:34 [INFO] __main__: Wiring event handlers …
14:10:34 [INFO] __main__:   event handlers registered
14:10:34 [INFO] gameserver.engine.empire_service: Empire registered: uid=100 name='TestImperium'
14:10:34 [INFO] gameserver.engine.empire_service: Empire 100: recalculated effects → {}
14:10:34 [INFO] gameserver.engine.empire_service: Empire registered: uid=2 name='Empire1'
14:10:34 [INFO] gameserver.engine.empire_service: Empire 2: recalculated effects → {'gold_offset': 0.15000000000000002}
14:10:34 [INFO] __main__: Restored 2 empires from saved state
14:10:34 [INFO] __main__: Starting network server …
14:10:34 [INFO] gameserver.network.handlers: Registered 29 message handlers: summary_request, item_request, military_request, new_item, new_structure, delete_structure, upgrade_structure, citizen_upgrade, change_citizen, increase_life, new_army, new_attack_request, change_army, new_wave, change_wave, end_siege, battle_register, battle_unregister, battle_next_wave_request, notification_request, user_message, timeline_request, userinfo_request, hall_of_fame_request, preferences_request, change_preferences, auth_request, signup, create_empire
14:10:34 [INFO] websockets.server: server listening on 0.0.0.0:8765
14:10:34 [INFO] gameserver.network.server: WebSocket server listening on ws://0.0.0.0:8765
14:10:34 [INFO] __main__:   WebSocket server listening on 0.0.0.0:8765
14:10:34 [INFO] gameserver.debug.dashboard: Debug dashboard running at http://0.0.0.0:9000/
14:10:34 [INFO] __main__: Starting game loop …
14:10:34 [INFO] __main__:   game loop running (1 s tick)
14:10:35 [INFO] websockets.server: connection open
14:10:35 [INFO] gameserver.network.server: Session registered: uid=-1
14:10:35 [INFO] gameserver.network.server: Client connected: uid=-1 remote=('192.168.178.2', 50876)
14:10:35 [INFO] gameserver.network.auth: Login success: eem (uid=2)
14:10:36 [INFO] gameserver.network.server: Session removed: uid=-1
14:10:36 [INFO] websockets.server: connection open
14:10:36 [INFO] gameserver.network.server: Session registered: uid=-2
14:10:36 [INFO] gameserver.network.server: Client connected: uid=-2 remote=('192.168.178.2', 50897)
14:10:36 [INFO] gameserver.network.auth: Login success: eem (uid=2)
14:10:40 [INFO] gameserver.engine.empire_service: Empire 2: started research CRAFTSMANSHIP (effort=200.0)
14:10:40 [INFO] gameserver.network.handlers: new_item success uid=2 iid=CRAFTSMANSHIP
14:10:43 [INFO] gameserver.engine.empire_service: Empire 2: started research DOMESTICATION (effort=150.0)
14:10:43 [INFO] gameserver.network.handlers: new_item success uid=2 iid=DOMESTICATION
14:11:02 [INFO] gameserver.network.server: Session removed: uid=-2
14:11:02 [INFO] websockets.server: connection open
14:11:02 [INFO] gameserver.network.server: Session registered: uid=-3
14:11:02 [INFO] gameserver.network.server: Client connected: uid=-3 remote=('192.168.178.2', 50908)
14:11:02 [INFO] gameserver.network.auth: Login success: eem (uid=2)
14:11:07 [INFO] gameserver.debug.dashboard: Signal sent (handled): type=summary_request sender=2
14:11:18 [INFO] gameserver.debug.dashboard: Signal sent (handled): type=summary_request sender=2
14:11:19 [INFO] gameserver.debug.dashboard: Signal sent (handled): type=summary_request sender=2
14:12:06 [INFO] gameserver.debug.dashboard: Signal sent (handled): type=summary_request sender=2
14:12:07 [INFO] gameserver.debug.dashboard: Signal sent (handled): type=summary_request sender=2
14:12:23 [INFO] __main__: Shutdown signal received — stopping …
14:12:24 [INFO] __main__: Shutting down …
14:12:24 [INFO] gameserver.persistence.state_save: Game state saved to state.yaml (2 empires, 0 attacks, 0 battles)
14:12:24 [INFO] websockets.server: server closing
14:12:24 [INFO] gameserver.network.server: Session removed: uid=-3
14:12:24 [INFO] websockets.server: server closed
14:12:24 [INFO] gameserver.network.server: WebSocket server stopped
14:12:24 [INFO] __main__:   WebSocket server stopped
14:12:24 [INFO] __main__:   debug dashboard stopped
14:12:24 [INFO] __main__:   database closed
14:12:24 [INFO] __main__:   goodbye
14:15:50 [INFO] __main__: === Game Server starting ===
14:15:50 [INFO] __main__: Loading configuration …
14:15:50 [INFO] __main__:   items:        210 loaded from config
14:15:51 [INFO] __main__:   map:          4 paths, 23 build tiles from config/maps/default.yaml
14:15:51 [INFO] __main__:   ai_templates: 2 entries from config/ai_templates.yaml
14:15:51 [INFO] gameserver.loaders.game_config_loader: Loaded game config from config/game.yaml (29 keys)
14:15:51 [INFO] __main__:   game_config:  loaded
14:15:51 [INFO] __main__: Initializing persistence …
14:15:51 [INFO] gameserver.persistence.database: Database connected: gameserver.db
14:15:51 [INFO] __main__:   database:     connected (gameserver.db)
14:15:51 [INFO] gameserver.persistence.state_load: Restoring state from state.yaml (saved at 2026-02-08T14:12:24, version 1)
14:15:51 [INFO] gameserver.persistence.state_load: Restored 2 empires, 0 attacks, 0 battles
14:15:51 [INFO] __main__:   state:        restored from disk (2 empires, 0 attacks)
14:15:51 [INFO] __main__: Creating services …
14:15:51 [INFO] __main__:   upgrade_provider: 210 items registered
14:15:51 [INFO] __main__:   all services created
14:15:51 [INFO] __main__: Wiring event handlers …
14:15:51 [INFO] __main__:   event handlers registered
14:15:51 [INFO] gameserver.engine.empire_service: Empire registered: uid=100 name='TestImperium'
14:15:51 [INFO] gameserver.engine.empire_service: Empire 100: recalculated effects → {}
14:15:51 [INFO] gameserver.engine.empire_service: Empire registered: uid=2 name='Empire1'
14:15:51 [INFO] gameserver.engine.empire_service: Empire 2: recalculated effects → {'gold_offset': 0.15000000000000002}
14:15:51 [INFO] __main__: Restored 2 empires from saved state
14:15:51 [INFO] __main__: Starting network server …
14:15:51 [INFO] gameserver.network.handlers: Registered 29 message handlers: summary_request, item_request, military_request, new_item, new_structure, delete_structure, upgrade_structure, citizen_upgrade, change_citizen, increase_life, new_army, new_attack_request, change_army, new_wave, change_wave, end_siege, battle_register, battle_unregister, battle_next_wave_request, notification_request, user_message, timeline_request, userinfo_request, hall_of_fame_request, preferences_request, change_preferences, auth_request, signup, create_empire
14:15:51 [INFO] websockets.server: server listening on 0.0.0.0:8765
14:15:51 [INFO] gameserver.network.server: WebSocket server listening on ws://0.0.0.0:8765
14:15:51 [INFO] __main__:   WebSocket server listening on 0.0.0.0:8765
14:15:51 [INFO] gameserver.debug.dashboard: Debug dashboard running at http://0.0.0.0:9000/
14:15:51 [INFO] __main__: Starting game loop …
14:15:51 [INFO] __main__:   game loop running (1 s tick)
14:16:22 [INFO] websockets.server: connection open
14:16:22 [INFO] gameserver.network.server: Session registered: uid=-1
14:16:22 [INFO] gameserver.network.server: Client connected: uid=-1 remote=('192.168.178.2', 61975)
14:16:22 [INFO] gameserver.network.auth: Login success: eem (uid=2)
14:16:40 [INFO] gameserver.engine.empire_service: Empire 2: knowledge DOMESTICATION completed
14:16:49 [INFO] gameserver.engine.empire_service: Empire 2: started research HORSEBACK_RIDING (effort=5000.0)
14:16:49 [INFO] gameserver.network.handlers: new_item success uid=2 iid=HORSEBACK_RIDING
14:16:55 [INFO] gameserver.engine.empire_service: Empire 2: started research CRAFTSMANSHIP (effort=200.0)
14:16:55 [INFO] gameserver.network.handlers: new_item success uid=2 iid=CRAFTSMANSHIP
14:17:02 [INFO] gameserver.engine.empire_service: Empire 2: started research HORSEBACK_RIDING (effort=5000.0)
14:17:02 [INFO] gameserver.network.handlers: new_item success uid=2 iid=HORSEBACK_RIDING
14:19:28 [INFO] __main__: Shutdown signal received — stopping …
14:19:29 [INFO] __main__: Shutting down …
14:19:29 [INFO] gameserver.persistence.state_save: Game state saved to state.yaml (2 empires, 0 attacks, 0 battles)
14:19:29 [INFO] websockets.server: server closing
14:19:29 [INFO] gameserver.network.server: Session removed: uid=-1
14:19:29 [INFO] websockets.server: server closed
14:19:29 [INFO] gameserver.network.server: WebSocket server stopped
14:19:29 [INFO] __main__:   WebSocket server stopped
14:19:29 [INFO] __main__:   debug dashboard stopped
14:19:29 [INFO] __main__:   database closed
14:19:29 [INFO] __main__:   goodbye
14:19:30 [INFO] __main__: === Game Server starting ===
14:19:30 [INFO] __main__: Loading configuration …
14:19:31 [INFO] __main__:   items:        210 loaded from config
14:19:31 [INFO] __main__:   map:          4 paths, 23 build tiles from config/maps/default.yaml
14:19:31 [INFO] __main__:   ai_templates: 2 entries from config/ai_templates.yaml
14:19:31 [INFO] gameserver.loaders.game_config_loader: Loaded game config from config/game.yaml (29 keys)
14:19:31 [INFO] __main__:   game_config:  loaded
14:19:31 [INFO] __main__: Initializing persistence …
14:19:31 [INFO] gameserver.persistence.database: Database connected: gameserver.db
14:19:31 [INFO] __main__:   database:     connected (gameserver.db)
14:19:31 [INFO] gameserver.persistence.state_load: Restoring state from state.yaml (saved at 2026-02-08T14:19:29, version 1)
14:19:31 [INFO] gameserver.persistence.state_load: Restored 2 empires, 0 attacks, 0 battles
14:19:31 [INFO] __main__:   state:        restored from disk (2 empires, 0 attacks)
14:19:31 [INFO] __main__: Creating services …
14:19:31 [INFO] __main__:   upgrade_provider: 210 items registered
14:19:31 [INFO] __main__:   all services created
14:19:31 [INFO] __main__: Wiring event handlers …
14:19:31 [INFO] __main__:   event handlers registered
14:19:31 [INFO] gameserver.engine.empire_service: Empire registered: uid=100 name='TestImperium'
14:19:31 [INFO] gameserver.engine.empire_service: Empire 100: recalculated effects → {}
14:19:31 [INFO] gameserver.engine.empire_service: Empire registered: uid=2 name='Empire1'
14:19:31 [INFO] gameserver.engine.empire_service: Empire 2: recalculated effects → {'gold_offset': 0.15000000000000002}
14:19:31 [INFO] __main__: Restored 2 empires from saved state
14:19:31 [INFO] __main__: Starting network server …
14:19:31 [INFO] gameserver.network.handlers: Registered 29 message handlers: summary_request, item_request, military_request, new_item, new_structure, delete_structure, upgrade_structure, citizen_upgrade, change_citizen, increase_life, new_army, new_attack_request, change_army, new_wave, change_wave, end_siege, battle_register, battle_unregister, battle_next_wave_request, notification_request, user_message, timeline_request, userinfo_request, hall_of_fame_request, preferences_request, change_preferences, auth_request, signup, create_empire
14:19:31 [INFO] websockets.server: server listening on 0.0.0.0:8765
14:19:31 [INFO] gameserver.network.server: WebSocket server listening on ws://0.0.0.0:8765
14:19:31 [INFO] __main__:   WebSocket server listening on 0.0.0.0:8765
14:19:31 [INFO] gameserver.debug.dashboard: Debug dashboard running at http://0.0.0.0:9000/
14:19:31 [INFO] __main__: Starting game loop …
14:19:31 [INFO] __main__:   game loop running (1 s tick)
14:19:32 [INFO] websockets.server: connection open
14:19:32 [INFO] gameserver.network.server: Session registered: uid=-1
14:19:32 [INFO] gameserver.network.server: Client connected: uid=-1 remote=('192.168.178.2', 63077)
14:19:32 [INFO] gameserver.network.auth: Login success: eem (uid=2)
14:19:33 [INFO] gameserver.network.server: Session removed: uid=-1
14:19:33 [INFO] websockets.server: connection open
14:19:33 [INFO] gameserver.network.server: Session registered: uid=-2
14:19:33 [INFO] gameserver.network.server: Client connected: uid=-2 remote=('192.168.178.2', 63097)
14:19:33 [INFO] gameserver.network.auth: Login success: eem (uid=2)
14:19:34 [INFO] gameserver.network.server: Session removed: uid=-2
14:19:34 [INFO] websockets.server: connection open
14:19:34 [INFO] gameserver.network.server: Session registered: uid=-3
14:19:34 [INFO] gameserver.network.server: Client connected: uid=-3 remote=('192.168.178.2', 63117)
14:19:34 [INFO] gameserver.network.auth: Login success: eem (uid=2)
14:22:20 [INFO] __main__: Shutdown signal received — stopping …
14:22:21 [INFO] __main__: Shutting down …
14:22:21 [INFO] gameserver.persistence.state_save: Game state saved to state.yaml (2 empires, 0 attacks, 0 battles)
14:22:21 [INFO] websockets.server: server closing
14:22:21 [INFO] gameserver.network.server: Session removed: uid=-3
14:22:21 [INFO] websockets.server: server closed
14:22:21 [INFO] gameserver.network.server: WebSocket server stopped
14:22:21 [INFO] __main__:   WebSocket server stopped
14:22:21 [INFO] __main__:   debug dashboard stopped
14:22:21 [INFO] __main__:   database closed
14:22:21 [INFO] __main__:   goodbye
14:22:23 [INFO] __main__: === Game Server starting ===
14:22:23 [INFO] __main__: Loading configuration …
14:22:23 [INFO] __main__:   items:        210 loaded from config
14:22:23 [INFO] __main__:   map:          4 paths, 23 build tiles from config/maps/default.yaml
14:22:23 [INFO] __main__:   ai_templates: 2 entries from config/ai_templates.yaml
14:22:23 [INFO] gameserver.loaders.game_config_loader: Loaded game config from config/game.yaml (29 keys)
14:22:23 [INFO] __main__:   game_config:  loaded
14:22:23 [INFO] __main__: Initializing persistence …
14:22:23 [INFO] gameserver.persistence.database: Database connected: gameserver.db
14:22:23 [INFO] __main__:   database:     connected (gameserver.db)
14:22:23 [INFO] gameserver.persistence.state_load: Restoring state from state.yaml (saved at 2026-02-08T14:22:21, version 1)
14:22:23 [INFO] gameserver.persistence.state_load: Restored 2 empires, 0 attacks, 0 battles
14:22:23 [INFO] __main__:   state:        restored from disk (2 empires, 0 attacks)
14:22:23 [INFO] __main__: Creating services …
14:22:23 [INFO] __main__:   upgrade_provider: 210 items registered
14:22:23 [INFO] __main__:   all services created
14:22:23 [INFO] __main__: Wiring event handlers …
14:22:23 [INFO] __main__:   event handlers registered
14:22:23 [INFO] gameserver.engine.empire_service: Empire registered: uid=100 name='TestImperium'
14:22:23 [INFO] gameserver.engine.empire_service: Empire 100: recalculated effects → {}
14:22:23 [INFO] gameserver.engine.empire_service: Empire registered: uid=2 name='Empire1'
14:22:23 [INFO] gameserver.engine.empire_service: Empire 2: recalculated effects → {'gold_offset': 0.15000000000000002}
14:22:23 [INFO] __main__: Restored 2 empires from saved state
14:22:23 [INFO] __main__: Starting network server …
14:22:23 [INFO] gameserver.network.handlers: Registered 29 message handlers: summary_request, item_request, military_request, new_item, new_structure, delete_structure, upgrade_structure, citizen_upgrade, change_citizen, increase_life, new_army, new_attack_request, change_army, new_wave, change_wave, end_siege, battle_register, battle_unregister, battle_next_wave_request, notification_request, user_message, timeline_request, userinfo_request, hall_of_fame_request, preferences_request, change_preferences, auth_request, signup, create_empire
14:22:23 [INFO] websockets.server: server listening on 0.0.0.0:8765
14:22:23 [INFO] gameserver.network.server: WebSocket server listening on ws://0.0.0.0:8765
14:22:23 [INFO] __main__:   WebSocket server listening on 0.0.0.0:8765
14:22:23 [INFO] gameserver.debug.dashboard: Debug dashboard running at http://0.0.0.0:9000/
14:22:23 [INFO] __main__: Starting game loop …
14:22:23 [INFO] __main__:   game loop running (1 s tick)
14:22:24 [INFO] websockets.server: connection open
14:22:24 [INFO] gameserver.network.server: Session registered: uid=-1
14:22:24 [INFO] gameserver.network.server: Client connected: uid=-1 remote=('192.168.178.2', 59348)
14:22:24 [INFO] gameserver.network.auth: Login success: eem (uid=2)
14:22:30 [INFO] gameserver.network.server: Session removed: uid=-1
14:22:31 [INFO] websockets.server: connection open
14:22:31 [INFO] gameserver.network.server: Session registered: uid=-2
14:22:31 [INFO] gameserver.network.server: Client connected: uid=-2 remote=('192.168.178.2', 59373)
14:22:31 [INFO] gameserver.network.auth: Login success: eem (uid=2)
14:22:52 [INFO] gameserver.network.server: Session removed: uid=-2
14:22:52 [INFO] websockets.server: connection open
14:22:52 [INFO] gameserver.network.server: Session registered: uid=-3
14:22:52 [INFO] gameserver.network.server: Client connected: uid=-3 remote=('192.168.178.2', 60781)
14:22:52 [INFO] gameserver.network.auth: Login success: eem (uid=2)
14:22:54 [INFO] gameserver.engine.empire_service: Empire 2: started building STONE_CIRCLE (effort=50.0)
14:22:54 [INFO] gameserver.network.handlers: new_item success uid=2 iid=STONE_CIRCLE
14:23:44 [INFO] gameserver.engine.empire_service: Empire 2: applied effects for STONE_CIRCLE: {'culture_offset': 0.1}
14:23:44 [INFO] gameserver.engine.empire_service: Empire 2: building STONE_CIRCLE completed
14:25:28 [INFO] __main__: Shutdown signal received — stopping …
14:25:29 [INFO] __main__: Shutting down …
14:25:29 [INFO] gameserver.persistence.state_save: Game state saved to state.yaml (2 empires, 0 attacks, 0 battles)
14:25:29 [INFO] websockets.server: server closing
14:25:29 [INFO] gameserver.network.server: Session removed: uid=-3
14:25:29 [INFO] websockets.server: server closed
14:25:29 [INFO] gameserver.network.server: WebSocket server stopped
14:25:29 [INFO] __main__:   WebSocket server stopped
14:25:29 [INFO] __main__:   debug dashboard stopped
14:25:29 [INFO] __main__:   database closed
14:25:29 [INFO] __main__:   goodbye
14:25:30 [INFO] __main__: === Game Server starting ===
14:25:30 [INFO] __main__: Loading configuration …
14:25:31 [INFO] __main__:   items:        210 loaded from config
14:25:31 [INFO] __main__:   map:          4 paths, 23 build tiles from config/maps/default.yaml
14:25:31 [INFO] __main__:   ai_templates: 2 entries from config/ai_templates.yaml
14:25:31 [INFO] gameserver.loaders.game_config_loader: Loaded game config from config/game.yaml (29 keys)
14:25:31 [INFO] __main__:   game_config:  loaded
14:25:31 [INFO] __main__: Initializing persistence …
14:25:31 [INFO] gameserver.persistence.database: Database connected: gameserver.db
14:25:31 [INFO] __main__:   database:     connected (gameserver.db)
14:25:31 [INFO] gameserver.persistence.state_load: Restoring state from state.yaml (saved at 2026-02-08T14:25:29, version 1)
14:25:31 [INFO] gameserver.persistence.state_load: Restored 2 empires, 0 attacks, 0 battles
14:25:31 [INFO] __main__:   state:        restored from disk (2 empires, 0 attacks)
14:25:31 [INFO] __main__: Creating services …
14:25:31 [INFO] __main__:   upgrade_provider: 210 items registered
14:25:31 [INFO] __main__:   all services created
14:25:31 [INFO] __main__: Wiring event handlers …
14:25:31 [INFO] __main__:   event handlers registered
14:25:31 [INFO] gameserver.engine.empire_service: Empire registered: uid=100 name='TestImperium'
14:25:31 [INFO] gameserver.engine.empire_service: Empire 100: recalculated effects → {}
14:25:31 [INFO] gameserver.engine.empire_service: Empire registered: uid=2 name='Empire1'
14:25:31 [INFO] gameserver.engine.empire_service: Empire 2: recalculated effects → {'gold_offset': 0.15000000000000002, 'culture_offset': 0.1}
14:25:31 [INFO] __main__: Restored 2 empires from saved state
14:25:31 [INFO] __main__: Starting network server …
14:25:31 [INFO] gameserver.network.handlers: Registered 29 message handlers: summary_request, item_request, military_request, new_item, new_structure, delete_structure, upgrade_structure, citizen_upgrade, change_citizen, increase_life, new_army, new_attack_request, change_army, new_wave, change_wave, end_siege, battle_register, battle_unregister, battle_next_wave_request, notification_request, user_message, timeline_request, userinfo_request, hall_of_fame_request, preferences_request, change_preferences, auth_request, signup, create_empire
14:25:31 [INFO] websockets.server: server listening on 0.0.0.0:8765
14:25:31 [INFO] gameserver.network.server: WebSocket server listening on ws://0.0.0.0:8765
14:25:31 [INFO] __main__:   WebSocket server listening on 0.0.0.0:8765
14:25:31 [INFO] gameserver.debug.dashboard: Debug dashboard running at http://0.0.0.0:9000/
14:25:31 [INFO] __main__: Starting game loop …
14:25:31 [INFO] __main__:   game loop running (1 s tick)
14:25:32 [INFO] websockets.server: connection open
14:25:32 [INFO] gameserver.network.server: Session registered: uid=-1
14:25:32 [INFO] gameserver.network.server: Client connected: uid=-1 remote=('192.168.178.2', 62721)
14:25:32 [INFO] gameserver.network.auth: Login success: eem (uid=2)
14:25:35 [INFO] gameserver.network.server: Session removed: uid=-1
14:25:35 [INFO] websockets.server: connection open
14:25:35 [INFO] gameserver.network.server: Session registered: uid=-2
14:25:35 [INFO] gameserver.network.server: Client connected: uid=-2 remote=('192.168.178.2', 62744)
14:25:35 [INFO] gameserver.network.auth: Login success: eem (uid=2)
14:25:46 [INFO] gameserver.engine.empire_service: Empire 2: started building SHRINE (effort=800.0)
14:25:46 [INFO] gameserver.network.handlers: new_item success uid=2 iid=SHRINE
14:25:58 [INFO] gameserver.engine.empire_service: Empire 2: started building EPIC_DRAWINGS (effort=1000.0)
14:25:58 [INFO] gameserver.network.handlers: new_item success uid=2 iid=EPIC_DRAWINGS
14:26:04 [INFO] gameserver.engine.empire_service: Empire 2: started building SHRINE (effort=800.0)
14:26:04 [INFO] gameserver.network.handlers: new_item success uid=2 iid=SHRINE
14:26:11 [INFO] gameserver.engine.empire_service: Empire 2: started building EPIC_DRAWINGS (effort=1000.0)
14:26:11 [INFO] gameserver.network.handlers: new_item success uid=2 iid=EPIC_DRAWINGS
14:26:17 [INFO] gameserver.engine.empire_service: Empire 2: started building SHRINE (effort=800.0)
14:26:17 [INFO] gameserver.network.handlers: new_item success uid=2 iid=SHRINE
14:28:19 [INFO] gameserver.network.server: Session removed: uid=-2
14:28:20 [INFO] websockets.server: connection open
14:28:20 [INFO] gameserver.network.server: Session registered: uid=-3
14:28:20 [INFO] gameserver.network.server: Client connected: uid=-3 remote=('192.168.178.2', 64399)
14:28:20 [INFO] gameserver.network.auth: Login success: eem (uid=2)
14:28:35 [INFO] gameserver.network.server: Session removed: uid=-3
14:28:36 [INFO] websockets.server: connection open
14:28:36 [INFO] gameserver.network.server: Session registered: uid=-4
14:28:36 [INFO] gameserver.network.server: Client connected: uid=-4 remote=('192.168.178.2', 61609)
14:28:36 [INFO] gameserver.network.auth: Login success: eem (uid=2)
14:28:41 [INFO] gameserver.network.server: Session removed: uid=-4
14:28:41 [INFO] websockets.server: connection open
14:28:41 [INFO] gameserver.network.server: Session registered: uid=-5
14:28:41 [INFO] gameserver.network.server: Client connected: uid=-5 remote=('192.168.178.2', 61634)
14:28:41 [INFO] gameserver.network.auth: Login success: eem (uid=2)
14:28:47 [INFO] gameserver.network.server: Session removed: uid=-5
14:28:47 [INFO] websockets.server: connection open
14:28:47 [INFO] gameserver.network.server: Session registered: uid=-6
14:28:47 [INFO] gameserver.network.server: Client connected: uid=-6 remote=('192.168.178.2', 61659)
14:28:47 [INFO] gameserver.network.auth: Login success: eem (uid=2)
14:29:53 [INFO] gameserver.engine.empire_service: Empire 2: started research CRAFTSMANSHIP (effort=200.0)
14:29:53 [INFO] gameserver.network.handlers: new_item success uid=2 iid=CRAFTSMANSHIP
14:31:50 [INFO] gameserver.network.server: Session removed: uid=-6
14:31:50 [INFO] websockets.server: connection open
14:31:50 [INFO] gameserver.network.server: Session registered: uid=-7
14:31:50 [INFO] gameserver.network.server: Client connected: uid=-7 remote=('192.168.178.2', 65401)
14:31:50 [INFO] gameserver.network.auth: Login success: eem (uid=2)
14:33:13 [INFO] gameserver.engine.empire_service: Empire 2: knowledge CRAFTSMANSHIP completed
14:34:00 [INFO] gameserver.network.server: Session removed: uid=-7
14:34:00 [INFO] websockets.server: connection open
14:34:00 [INFO] gameserver.network.server: Session registered: uid=-8
14:34:00 [INFO] gameserver.network.server: Client connected: uid=-8 remote=('192.168.178.2', 62566)
14:34:00 [INFO] gameserver.network.auth: Login success: eem (uid=2)
14:34:25 [INFO] gameserver.network.server: Session removed: uid=-8
14:34:25 [INFO] websockets.server: connection open
14:34:25 [INFO] gameserver.network.server: Session registered: uid=-9
14:34:25 [INFO] gameserver.network.server: Client connected: uid=-9 remote=('192.168.178.2', 62607)
14:34:25 [INFO] gameserver.network.auth: Login success: eem (uid=2)
14:34:41 [INFO] __main__: Shutdown signal received — stopping …
14:34:41 [INFO] __main__: Shutting down …
14:34:41 [INFO] gameserver.persistence.state_save: Game state saved to state.yaml (2 empires, 0 attacks, 0 battles)
14:34:41 [INFO] websockets.server: server closing
14:34:42 [INFO] gameserver.network.server: Session removed: uid=-9
14:34:42 [INFO] websockets.server: server closed
14:34:42 [INFO] gameserver.network.server: WebSocket server stopped
14:34:42 [INFO] __main__:   WebSocket server stopped
14:34:42 [INFO] __main__:   debug dashboard stopped
14:34:42 [INFO] __main__:   database closed
14:34:42 [INFO] __main__:   goodbye
14:34:43 [INFO] __main__: === Game Server starting ===
14:34:43 [INFO] __main__: Loading configuration …
14:34:44 [INFO] __main__:   items:        210 loaded from config
14:34:44 [INFO] __main__:   map:          4 paths, 23 build tiles from config/maps/default.yaml
14:34:44 [INFO] __main__:   ai_templates: 2 entries from config/ai_templates.yaml
14:34:44 [INFO] gameserver.loaders.game_config_loader: Loaded game config from config/game.yaml (29 keys)
14:34:44 [INFO] __main__:   game_config:  loaded
14:34:44 [INFO] __main__: Initializing persistence …
14:34:44 [INFO] gameserver.persistence.database: Database connected: gameserver.db
14:34:44 [INFO] __main__:   database:     connected (gameserver.db)
14:34:44 [INFO] gameserver.persistence.state_load: Restoring state from state.yaml (saved at 2026-02-08T14:34:41, version 1)
14:34:44 [INFO] gameserver.persistence.state_load: Restored 2 empires, 0 attacks, 0 battles
14:34:44 [INFO] __main__:   state:        restored from disk (2 empires, 0 attacks)
14:34:44 [INFO] __main__: Creating services …
14:34:44 [INFO] __main__:   upgrade_provider: 210 items registered
14:34:44 [INFO] __main__:   all services created
14:34:44 [INFO] __main__: Wiring event handlers …
14:34:44 [INFO] __main__:   event handlers registered
14:34:44 [INFO] gameserver.engine.empire_service: Empire registered: uid=100 name='TestImperium'
14:34:44 [INFO] gameserver.engine.empire_service: Empire 100: recalculated effects → {}
14:34:44 [INFO] gameserver.engine.empire_service: Empire registered: uid=2 name='Empire1'
14:34:44 [INFO] gameserver.engine.empire_service: Empire 2: recalculated effects → {'gold_offset': 0.15000000000000002, 'culture_offset': 0.1}
14:34:44 [INFO] __main__: Restored 2 empires from saved state
14:34:44 [INFO] __main__: Starting network server …
14:34:44 [INFO] gameserver.network.handlers: Registered 29 message handlers: summary_request, item_request, military_request, new_item, new_structure, delete_structure, upgrade_structure, citizen_upgrade, change_citizen, increase_life, new_army, new_attack_request, change_army, new_wave, change_wave, end_siege, battle_register, battle_unregister, battle_next_wave_request, notification_request, user_message, timeline_request, userinfo_request, hall_of_fame_request, preferences_request, change_preferences, auth_request, signup, create_empire
14:34:44 [INFO] websockets.server: server listening on 0.0.0.0:8765
14:34:44 [INFO] gameserver.network.server: WebSocket server listening on ws://0.0.0.0:8765
14:34:44 [INFO] __main__:   WebSocket server listening on 0.0.0.0:8765
14:34:44 [INFO] gameserver.debug.dashboard: Debug dashboard running at http://0.0.0.0:9000/
14:34:44 [INFO] __main__: Starting game loop …
14:34:44 [INFO] __main__:   game loop running (1 s tick)
14:34:45 [INFO] websockets.server: connection open
14:34:45 [INFO] gameserver.network.server: Session registered: uid=-1
14:34:45 [INFO] gameserver.network.server: Client connected: uid=-1 remote=('192.168.178.2', 59070)
14:34:45 [INFO] gameserver.network.auth: Login success: eem (uid=2)
14:34:46 [INFO] gameserver.network.server: Session removed: uid=-1
14:34:46 [INFO] websockets.server: connection open
14:34:46 [INFO] gameserver.network.server: Session registered: uid=-2
14:34:46 [INFO] gameserver.network.server: Client connected: uid=-2 remote=('192.168.178.2', 59092)
14:34:46 [INFO] gameserver.network.auth: Login success: eem (uid=2)
14:34:47 [INFO] gameserver.network.server: Session removed: uid=-2
14:34:47 [INFO] websockets.server: connection open
14:34:47 [INFO] gameserver.network.server: Session registered: uid=-3
14:34:47 [INFO] gameserver.network.server: Client connected: uid=-3 remote=('192.168.178.2', 59114)
14:34:47 [INFO] gameserver.network.auth: Login success: eem (uid=2)
14:36:09 [INFO] gameserver.network.server: Session removed: uid=-3
14:36:09 [INFO] websockets.server: connection open
14:36:09 [INFO] gameserver.network.server: Session registered: uid=-4
14:36:09 [INFO] gameserver.network.server: Client connected: uid=-4 remote=('192.168.178.2', 59178)
14:36:09 [INFO] gameserver.network.auth: Login success: eem (uid=2)
14:38:06 [INFO] gameserver.network.server: Session removed: uid=-4
14:38:06 [INFO] websockets.server: connection open
14:38:06 [INFO] gameserver.network.server: Session registered: uid=-5
14:38:06 [INFO] gameserver.network.server: Client connected: uid=-5 remote=('192.168.178.2', 56677)
14:38:06 [INFO] gameserver.network.auth: Login success: eem (uid=2)
14:38:12 [INFO] gameserver.network.server: Session removed: uid=-5
14:38:12 [INFO] websockets.server: connection open
14:38:12 [INFO] gameserver.network.server: Session registered: uid=-6
14:38:12 [INFO] gameserver.network.server: Client connected: uid=-6 remote=('192.168.178.2', 56706)
14:38:12 [INFO] gameserver.network.auth: Login success: eem (uid=2)
14:39:00 [INFO] gameserver.debug.dashboard: Signal sent (handled): type=citizen_upgrade sender=0
14:39:40 [INFO] gameserver.engine.empire_service: Empire 2: applied effects for SHRINE: {'culture_offset': 0.05}
14:39:40 [INFO] gameserver.engine.empire_service: Empire 2: building SHRINE completed
14:40:54 [INFO] __main__: Shutdown signal received — stopping …
14:40:55 [INFO] __main__: Shutting down …
14:40:55 [INFO] gameserver.persistence.state_save: Game state saved to state.yaml (2 empires, 0 attacks, 0 battles)
14:40:55 [INFO] websockets.server: server closing
14:40:55 [INFO] gameserver.network.server: Session removed: uid=-6
14:40:55 [INFO] websockets.server: server closed
14:40:55 [INFO] gameserver.network.server: WebSocket server stopped
14:40:55 [INFO] __main__:   WebSocket server stopped
14:40:55 [INFO] __main__:   debug dashboard stopped
14:40:55 [INFO] __main__:   database closed
14:40:55 [INFO] __main__:   goodbye
14:40:57 [INFO] __main__: === Game Server starting ===
14:40:57 [INFO] __main__: Loading configuration …
14:40:58 [INFO] __main__:   items:        210 loaded from config
14:40:58 [INFO] __main__:   map:          4 paths, 23 build tiles from config/maps/default.yaml
14:40:58 [INFO] __main__:   ai_templates: 2 entries from config/ai_templates.yaml
14:40:58 [INFO] gameserver.loaders.game_config_loader: Loaded game config from config/game.yaml (29 keys)
14:40:58 [INFO] __main__:   game_config:  loaded
14:40:58 [INFO] __main__: Initializing persistence …
14:40:58 [INFO] gameserver.persistence.database: Database connected: gameserver.db
14:40:58 [INFO] __main__:   database:     connected (gameserver.db)
14:40:58 [INFO] gameserver.persistence.state_load: Restoring state from state.yaml (saved at 2026-02-08T14:40:55, version 1)
14:40:58 [INFO] gameserver.persistence.state_load: Restored 2 empires, 0 attacks, 0 battles
14:40:58 [INFO] __main__:   state:        restored from disk (2 empires, 0 attacks)
14:40:58 [INFO] __main__: Creating services …
14:40:58 [INFO] __main__:   upgrade_provider: 210 items registered
14:40:58 [INFO] __main__:   all services created
14:40:58 [INFO] __main__: Wiring event handlers …
14:40:58 [INFO] __main__:   event handlers registered
14:40:58 [INFO] gameserver.engine.empire_service: Empire registered: uid=100 name='TestImperium'
14:40:58 [INFO] gameserver.engine.empire_service: Empire 100: recalculated effects → {}
14:40:58 [INFO] gameserver.engine.empire_service: Empire registered: uid=2 name='Empire1'
14:40:58 [INFO] gameserver.engine.empire_service: Empire 2: recalculated effects → {'gold_offset': 0.15000000000000002, 'culture_offset': 0.15000000000000002}
14:40:58 [INFO] __main__: Restored 2 empires from saved state
14:40:58 [INFO] __main__: Starting network server …
14:40:58 [INFO] gameserver.network.handlers: Registered 29 message handlers: summary_request, item_request, military_request, new_item, new_structure, delete_structure, upgrade_structure, citizen_upgrade, change_citizen, increase_life, new_army, new_attack_request, change_army, new_wave, change_wave, end_siege, battle_register, battle_unregister, battle_next_wave_request, notification_request, user_message, timeline_request, userinfo_request, hall_of_fame_request, preferences_request, change_preferences, auth_request, signup, create_empire
14:40:58 [INFO] websockets.server: server listening on 0.0.0.0:8765
14:40:58 [INFO] gameserver.network.server: WebSocket server listening on ws://0.0.0.0:8765
14:40:58 [INFO] __main__:   WebSocket server listening on 0.0.0.0:8765
14:40:58 [INFO] gameserver.debug.dashboard: Debug dashboard running at http://0.0.0.0:9000/
14:40:58 [INFO] __main__: Starting game loop …
14:40:58 [INFO] __main__:   game loop running (1 s tick)
14:41:00 [INFO] websockets.server: connection open
14:41:00 [INFO] gameserver.network.server: Session registered: uid=-1
14:41:00 [INFO] gameserver.network.server: Client connected: uid=-1 remote=('192.168.178.2', 62862)
14:41:04 [INFO] gameserver.network.auth: Login success: eem (uid=2)
14:42:29 [INFO] gameserver.network.server: Session removed: uid=-1
14:42:29 [INFO] websockets.server: connection open
14:42:29 [INFO] gameserver.network.server: Session registered: uid=-2
14:42:29 [INFO] gameserver.network.server: Client connected: uid=-2 remote=('192.168.178.2', 55078)
14:42:29 [INFO] gameserver.network.auth: Login success: eem (uid=2)
14:42:34 [INFO] __main__: Shutdown signal received — stopping …
14:42:35 [INFO] __main__: Shutting down …
14:42:35 [INFO] gameserver.persistence.state_save: Game state saved to state.yaml (2 empires, 0 attacks, 0 battles)
14:42:35 [INFO] websockets.server: server closing
14:42:35 [INFO] gameserver.network.server: Session removed: uid=-2
14:42:35 [INFO] websockets.server: server closed
14:42:35 [INFO] gameserver.network.server: WebSocket server stopped
14:42:35 [INFO] __main__:   WebSocket server stopped
14:42:35 [INFO] __main__:   debug dashboard stopped
14:42:35 [INFO] __main__:   database closed
14:42:35 [INFO] __main__:   goodbye
14:42:36 [INFO] __main__: === Game Server starting ===
14:42:36 [INFO] __main__: Loading configuration …
14:42:37 [INFO] __main__:   items:        210 loaded from config
14:42:37 [INFO] __main__:   map:          4 paths, 23 build tiles from config/maps/default.yaml
14:42:37 [INFO] __main__:   ai_templates: 2 entries from config/ai_templates.yaml
14:42:37 [INFO] gameserver.loaders.game_config_loader: Loaded game config from config/game.yaml (29 keys)
14:42:37 [INFO] __main__:   game_config:  loaded
14:42:37 [INFO] __main__: Initializing persistence …
14:42:37 [INFO] gameserver.persistence.database: Database connected: gameserver.db
14:42:37 [INFO] __main__:   database:     connected (gameserver.db)
14:42:37 [INFO] gameserver.persistence.state_load: Restoring state from state.yaml (saved at 2026-02-08T14:42:35, version 1)
14:42:37 [INFO] gameserver.persistence.state_load: Restored 2 empires, 0 attacks, 0 battles
14:42:37 [INFO] __main__:   state:        restored from disk (2 empires, 0 attacks)
14:42:37 [INFO] __main__: Creating services …
14:42:37 [INFO] __main__:   upgrade_provider: 210 items registered
14:42:37 [INFO] __main__:   all services created
14:42:37 [INFO] __main__: Wiring event handlers …
14:42:37 [INFO] __main__:   event handlers registered
14:42:37 [INFO] gameserver.engine.empire_service: Empire registered: uid=100 name='TestImperium'
14:42:37 [INFO] gameserver.engine.empire_service: Empire 100: recalculated effects → {}
14:42:37 [INFO] gameserver.engine.empire_service: Empire registered: uid=2 name='Empire1'
14:42:37 [INFO] gameserver.engine.empire_service: Empire 2: recalculated effects → {'gold_offset': 0.15000000000000002, 'culture_offset': 0.15000000000000002}
14:42:37 [INFO] __main__: Restored 2 empires from saved state
14:42:37 [INFO] __main__: Starting network server …
14:42:37 [INFO] gameserver.network.handlers: Registered 29 message handlers: summary_request, item_request, military_request, new_item, new_structure, delete_structure, upgrade_structure, citizen_upgrade, change_citizen, increase_life, new_army, new_attack_request, change_army, new_wave, change_wave, end_siege, battle_register, battle_unregister, battle_next_wave_request, notification_request, user_message, timeline_request, userinfo_request, hall_of_fame_request, preferences_request, change_preferences, auth_request, signup, create_empire
14:42:37 [INFO] websockets.server: server listening on 0.0.0.0:8765
14:42:37 [INFO] gameserver.network.server: WebSocket server listening on ws://0.0.0.0:8765
14:42:37 [INFO] __main__:   WebSocket server listening on 0.0.0.0:8765
14:42:37 [INFO] gameserver.debug.dashboard: Debug dashboard running at http://0.0.0.0:9000/
14:42:37 [INFO] __main__: Starting game loop …
14:42:37 [INFO] __main__:   game loop running (1 s tick)
14:42:38 [INFO] websockets.server: connection open
14:42:38 [INFO] gameserver.network.server: Session registered: uid=-1
14:42:38 [INFO] gameserver.network.server: Client connected: uid=-1 remote=('192.168.178.2', 52334)
14:42:38 [INFO] gameserver.network.auth: Login success: eem (uid=2)
14:42:39 [INFO] gameserver.network.server: Session removed: uid=-1
14:42:39 [INFO] websockets.server: connection open
14:42:39 [INFO] gameserver.network.server: Session registered: uid=-2
14:42:39 [INFO] gameserver.network.server: Client connected: uid=-2 remote=('192.168.178.2', 52356)
14:42:39 [INFO] gameserver.network.auth: Login success: eem (uid=2)
14:42:40 [INFO] gameserver.network.server: Session removed: uid=-2
14:42:40 [INFO] websockets.server: connection open
14:42:40 [INFO] gameserver.network.server: Session registered: uid=-3
14:42:40 [INFO] gameserver.network.server: Client connected: uid=-3 remote=('192.168.178.2', 52377)
14:42:40 [INFO] gameserver.network.auth: Login success: eem (uid=2)
14:42:41 [INFO] gameserver.network.handlers: citizen_upgrade success uid=2
14:42:42 [INFO] gameserver.network.handlers: citizen_upgrade failed uid=2: Not enough culture (need 125.0, have 20.9)
14:42:47 [INFO] gameserver.network.server: Session removed: uid=-3
14:42:47 [INFO] websockets.server: connection open
14:42:47 [INFO] gameserver.network.server: Session registered: uid=-4
14:42:47 [INFO] gameserver.network.server: Client connected: uid=-4 remote=('192.168.178.2', 55625)
14:42:47 [INFO] gameserver.network.auth: Login success: eem (uid=2)
14:42:52 [INFO] gameserver.network.handlers: citizen_upgrade failed uid=2: Not enough culture (need 125.0, have 22.4)
14:42:53 [INFO] gameserver.network.handlers: citizen_upgrade failed uid=2: Not enough culture (need 125.0, have 22.6)
14:44:15 [INFO] __main__: Shutdown signal received — stopping …
14:44:15 [INFO] __main__: Shutting down …
14:44:15 [INFO] gameserver.persistence.state_save: Game state saved to state.yaml (2 empires, 0 attacks, 0 battles)
14:44:15 [INFO] websockets.server: server closing
14:44:15 [INFO] gameserver.network.server: Session removed: uid=-4
14:44:15 [INFO] websockets.server: server closed
14:44:15 [INFO] gameserver.network.server: WebSocket server stopped
14:44:15 [INFO] __main__:   WebSocket server stopped
14:44:15 [INFO] __main__:   debug dashboard stopped
14:44:15 [INFO] __main__:   database closed
14:44:15 [INFO] __main__:   goodbye
14:44:17 [INFO] __main__: === Game Server starting ===
14:44:17 [INFO] __main__: Loading configuration …
14:44:17 [INFO] __main__:   items:        210 loaded from config
14:44:17 [INFO] __main__:   map:          4 paths, 23 build tiles from config/maps/default.yaml
14:44:17 [INFO] __main__:   ai_templates: 2 entries from config/ai_templates.yaml
14:44:17 [INFO] gameserver.loaders.game_config_loader: Loaded game config from config/game.yaml (29 keys)
14:44:17 [INFO] __main__:   game_config:  loaded
14:44:17 [INFO] __main__: Initializing persistence …
14:44:17 [INFO] gameserver.persistence.database: Database connected: gameserver.db
14:44:17 [INFO] __main__:   database:     connected (gameserver.db)
14:44:17 [INFO] gameserver.persistence.state_load: Restoring state from state.yaml (saved at 2026-02-08T14:44:15, version 1)
14:44:17 [INFO] gameserver.persistence.state_load: Restored 2 empires, 0 attacks, 0 battles
14:44:17 [INFO] __main__:   state:        restored from disk (2 empires, 0 attacks)
14:44:17 [INFO] __main__: Creating services …
14:44:17 [INFO] __main__:   upgrade_provider: 210 items registered
14:44:17 [INFO] __main__:   all services created
14:44:17 [INFO] __main__: Wiring event handlers …
14:44:17 [INFO] __main__:   event handlers registered
14:44:17 [INFO] gameserver.engine.empire_service: Empire registered: uid=100 name='TestImperium'
14:44:17 [INFO] gameserver.engine.empire_service: Empire 100: recalculated effects → {}
14:44:17 [INFO] gameserver.engine.empire_service: Empire registered: uid=2 name='Empire1'
14:44:17 [INFO] gameserver.engine.empire_service: Empire 2: recalculated effects → {'gold_offset': 0.15000000000000002, 'culture_offset': 0.15000000000000002}
14:44:17 [INFO] __main__: Restored 2 empires from saved state
14:44:17 [INFO] __main__: Starting network server …
14:44:17 [INFO] gameserver.network.handlers: Registered 29 message handlers: summary_request, item_request, military_request, new_item, new_structure, delete_structure, upgrade_structure, citizen_upgrade, change_citizen, increase_life, new_army, new_attack_request, change_army, new_wave, change_wave, end_siege, battle_register, battle_unregister, battle_next_wave_request, notification_request, user_message, timeline_request, userinfo_request, hall_of_fame_request, preferences_request, change_preferences, auth_request, signup, create_empire
14:44:17 [INFO] websockets.server: server listening on 0.0.0.0:8765
14:44:17 [INFO] gameserver.network.server: WebSocket server listening on ws://0.0.0.0:8765
14:44:17 [INFO] __main__:   WebSocket server listening on 0.0.0.0:8765
14:44:17 [INFO] gameserver.debug.dashboard: Debug dashboard running at http://0.0.0.0:9000/
14:44:17 [INFO] __main__: Starting game loop …
14:44:17 [INFO] __main__:   game loop running (1 s tick)
14:44:18 [INFO] websockets.server: connection open
14:44:18 [INFO] gameserver.network.server: Session registered: uid=-1
14:44:18 [INFO] gameserver.network.server: Client connected: uid=-1 remote=('192.168.178.2', 64459)
14:44:20 [INFO] gameserver.network.auth: Login success: eem (uid=2)
14:45:32 [INFO] __main__: Shutdown signal received — stopping …
14:45:33 [INFO] __main__: Shutting down …
14:45:33 [INFO] gameserver.persistence.state_save: Game state saved to state.yaml (2 empires, 0 attacks, 0 battles)
14:45:33 [INFO] websockets.server: server closing
14:45:33 [INFO] gameserver.network.server: Session removed: uid=-1
14:45:33 [INFO] websockets.server: server closed
14:45:33 [INFO] gameserver.network.server: WebSocket server stopped
14:45:33 [INFO] __main__:   WebSocket server stopped
14:45:33 [INFO] __main__:   debug dashboard stopped
14:45:33 [INFO] __main__:   database closed
14:45:33 [INFO] __main__:   goodbye
14:45:34 [INFO] __main__: === Game Server starting ===
14:45:34 [INFO] __main__: Loading configuration …
14:45:35 [INFO] __main__:   items:        210 loaded from config
14:45:35 [INFO] __main__:   map:          4 paths, 23 build tiles from config/maps/default.yaml
14:45:35 [INFO] __main__:   ai_templates: 2 entries from config/ai_templates.yaml
14:45:35 [INFO] gameserver.loaders.game_config_loader: Loaded game config from config/game.yaml (29 keys)
14:45:35 [INFO] __main__:   game_config:  loaded
14:45:35 [INFO] __main__: Initializing persistence …
14:45:35 [INFO] gameserver.persistence.database: Database connected: gameserver.db
14:45:35 [INFO] __main__:   database:     connected (gameserver.db)
14:45:35 [INFO] gameserver.persistence.state_load: Restoring state from state.yaml (saved at 2026-02-08T14:45:33, version 1)
14:45:35 [INFO] gameserver.persistence.state_load: Restored 2 empires, 0 attacks, 0 battles
14:45:35 [INFO] __main__:   state:        restored from disk (2 empires, 0 attacks)
14:45:35 [INFO] __main__: Creating services …
14:45:35 [INFO] __main__:   upgrade_provider: 210 items registered
14:45:35 [INFO] __main__:   all services created
14:45:35 [INFO] __main__: Wiring event handlers …
14:45:35 [INFO] __main__:   event handlers registered
14:45:35 [INFO] gameserver.engine.empire_service: Empire registered: uid=100 name='TestImperium'
14:45:35 [INFO] gameserver.engine.empire_service: Empire 100: recalculated effects → {}
14:45:35 [INFO] gameserver.engine.empire_service: Empire registered: uid=2 name='Empire1'
14:45:35 [INFO] gameserver.engine.empire_service: Empire 2: recalculated effects → {'gold_offset': 0.15000000000000002, 'culture_offset': 0.15000000000000002}
14:45:35 [INFO] __main__: Restored 2 empires from saved state
14:45:35 [INFO] __main__: Starting network server …
14:45:35 [INFO] gameserver.network.handlers: Registered 29 message handlers: summary_request, item_request, military_request, new_item, new_structure, delete_structure, upgrade_structure, citizen_upgrade, change_citizen, increase_life, new_army, new_attack_request, change_army, new_wave, change_wave, end_siege, battle_register, battle_unregister, battle_next_wave_request, notification_request, user_message, timeline_request, userinfo_request, hall_of_fame_request, preferences_request, change_preferences, auth_request, signup, create_empire
14:45:35 [INFO] websockets.server: server listening on 0.0.0.0:8765
14:45:35 [INFO] gameserver.network.server: WebSocket server listening on ws://0.0.0.0:8765
14:45:35 [INFO] __main__:   WebSocket server listening on 0.0.0.0:8765
14:45:35 [INFO] gameserver.debug.dashboard: Debug dashboard running at http://0.0.0.0:9000/
14:45:35 [INFO] __main__: Starting game loop …
14:45:35 [INFO] __main__:   game loop running (1 s tick)
14:45:36 [INFO] websockets.server: connection open
14:45:36 [INFO] gameserver.network.server: Session registered: uid=-1
14:45:36 [INFO] gameserver.network.server: Client connected: uid=-1 remote=('192.168.178.2', 53220)
14:45:36 [INFO] gameserver.network.auth: Login success: eem (uid=2)
14:45:37 [INFO] gameserver.network.server: Session removed: uid=-1
14:45:37 [INFO] websockets.server: connection open
14:45:37 [INFO] gameserver.network.server: Session registered: uid=-2
14:45:37 [INFO] gameserver.network.server: Client connected: uid=-2 remote=('192.168.178.2', 53242)
14:45:37 [INFO] gameserver.network.auth: Login success: eem (uid=2)
14:45:38 [INFO] gameserver.network.handlers: citizen_upgrade request from uid=-2
14:45:38 [WARNING] gameserver.network.handlers: citizen_upgrade failed: no empire found for uid=-2
14:46:59 [INFO] __main__: Shutdown signal received — stopping …
14:46:59 [INFO] __main__: Shutting down …
14:46:59 [INFO] gameserver.persistence.state_save: Game state saved to state.yaml (2 empires, 0 attacks, 0 battles)
14:46:59 [INFO] websockets.server: server closing
14:46:59 [INFO] gameserver.network.server: Session removed: uid=-2
14:46:59 [INFO] websockets.server: server closed
14:46:59 [INFO] gameserver.network.server: WebSocket server stopped
14:46:59 [INFO] __main__:   WebSocket server stopped
14:46:59 [INFO] __main__:   debug dashboard stopped
14:46:59 [INFO] __main__:   database closed
14:46:59 [INFO] __main__:   goodbye
14:47:01 [INFO] __main__: === Game Server starting ===
14:47:01 [INFO] __main__: Loading configuration …
14:47:01 [INFO] __main__:   items:        210 loaded from config
14:47:01 [INFO] __main__:   map:          4 paths, 23 build tiles from config/maps/default.yaml
14:47:01 [INFO] __main__:   ai_templates: 2 entries from config/ai_templates.yaml
14:47:02 [INFO] gameserver.loaders.game_config_loader: Loaded game config from config/game.yaml (29 keys)
14:47:02 [INFO] __main__:   game_config:  loaded
14:47:02 [INFO] __main__: Initializing persistence …
14:47:02 [INFO] gameserver.persistence.database: Database connected: gameserver.db
14:47:02 [INFO] __main__:   database:     connected (gameserver.db)
14:47:02 [INFO] gameserver.persistence.state_load: Restoring state from state.yaml (saved at 2026-02-08T14:46:59, version 1)
14:47:02 [INFO] gameserver.persistence.state_load: Restored 2 empires, 0 attacks, 0 battles
14:47:02 [INFO] __main__:   state:        restored from disk (2 empires, 0 attacks)
14:47:02 [INFO] __main__: Creating services …
14:47:02 [INFO] __main__:   upgrade_provider: 210 items registered
14:47:02 [INFO] __main__:   all services created
14:47:02 [INFO] __main__: Wiring event handlers …
14:47:02 [INFO] __main__:   event handlers registered
14:47:02 [INFO] gameserver.engine.empire_service: Empire registered: uid=100 name='TestImperium'
14:47:02 [INFO] gameserver.engine.empire_service: Empire 100: recalculated effects → {}
14:47:02 [INFO] gameserver.engine.empire_service: Empire registered: uid=2 name='Empire1'
14:47:02 [INFO] gameserver.engine.empire_service: Empire 2: recalculated effects → {'gold_offset': 0.15000000000000002, 'culture_offset': 0.15000000000000002}
14:47:02 [INFO] __main__: Restored 2 empires from saved state
14:47:02 [INFO] __main__: Starting network server …
14:47:02 [INFO] gameserver.network.handlers: Registered 29 message handlers: summary_request, item_request, military_request, new_item, new_structure, delete_structure, upgrade_structure, citizen_upgrade, change_citizen, increase_life, new_army, new_attack_request, change_army, new_wave, change_wave, end_siege, battle_register, battle_unregister, battle_next_wave_request, notification_request, user_message, timeline_request, userinfo_request, hall_of_fame_request, preferences_request, change_preferences, auth_request, signup, create_empire
14:47:02 [INFO] websockets.server: server listening on 0.0.0.0:8765
14:47:02 [INFO] gameserver.network.server: WebSocket server listening on ws://0.0.0.0:8765
14:47:02 [INFO] __main__:   WebSocket server listening on 0.0.0.0:8765
14:47:02 [INFO] gameserver.debug.dashboard: Debug dashboard running at http://0.0.0.0:9000/
14:47:02 [INFO] __main__: Starting game loop …
14:47:02 [INFO] __main__:   game loop running (1 s tick)
14:47:02 [INFO] websockets.server: connection open
14:47:02 [INFO] gameserver.network.server: Session registered: uid=-1
14:47:02 [INFO] gameserver.network.server: Client connected: uid=-1 remote=('192.168.178.2', 60324)
14:47:02 [INFO] gameserver.network.auth: Login success: eem (uid=2)
14:47:02 [INFO] gameserver.network.server: Session registered: uid=2
14:47:02 [INFO] gameserver.network.server: Session upgraded: guest=-1 → uid=2
14:47:05 [INFO] gameserver.network.server: Session removed: uid=2
14:47:05 [INFO] websockets.server: connection open
14:47:05 [INFO] gameserver.network.server: Session registered: uid=-2
14:47:05 [INFO] gameserver.network.server: Client connected: uid=-2 remote=('192.168.178.2', 60346)
14:47:05 [INFO] gameserver.network.auth: Login success: eem (uid=2)
14:47:05 [INFO] gameserver.network.server: Session registered: uid=2
14:47:05 [INFO] gameserver.network.server: Session upgraded: guest=-2 → uid=2
14:47:06 [INFO] gameserver.network.handlers: citizen_upgrade request from uid=2
14:47:06 [INFO] gameserver.network.handlers: citizen_upgrade failed uid=2: Not enough culture (need 125.0, have 58.9)
14:48:39 [INFO] __main__: Shutdown signal received — stopping …
14:48:40 [INFO] __main__: Shutting down …
14:48:40 [INFO] gameserver.persistence.state_save: Game state saved to state.yaml (2 empires, 0 attacks, 0 battles)
14:48:40 [INFO] websockets.server: server closing
14:48:40 [INFO] gameserver.network.server: Session removed: uid=2
14:48:40 [INFO] websockets.server: server closed
14:48:40 [INFO] gameserver.network.server: WebSocket server stopped
14:48:40 [INFO] __main__:   WebSocket server stopped
14:48:40 [INFO] __main__:   debug dashboard stopped
14:48:40 [INFO] __main__:   database closed
14:48:40 [INFO] __main__:   goodbye
14:48:42 [INFO] __main__: === Game Server starting ===
14:48:42 [INFO] __main__: Loading configuration …
14:48:43 [INFO] __main__:   items:        210 loaded from config
14:48:43 [INFO] __main__:   map:          4 paths, 23 build tiles from config/maps/default.yaml
14:48:43 [INFO] __main__:   ai_templates: 2 entries from config/ai_templates.yaml
14:48:43 [INFO] gameserver.loaders.game_config_loader: Loaded game config from config/game.yaml (29 keys)
14:48:43 [INFO] __main__:   game_config:  loaded
14:48:43 [INFO] __main__: Initializing persistence …
14:48:43 [INFO] gameserver.persistence.database: Database connected: gameserver.db
14:48:43 [INFO] __main__:   database:     connected (gameserver.db)
14:48:43 [INFO] gameserver.persistence.state_load: Restoring state from state.yaml (saved at 2026-02-08T14:48:40, version 1)
14:48:43 [INFO] gameserver.persistence.state_load: Restored 2 empires, 0 attacks, 0 battles
14:48:43 [INFO] __main__:   state:        restored from disk (2 empires, 0 attacks)
14:48:43 [INFO] __main__: Creating services …
14:48:43 [INFO] __main__:   upgrade_provider: 210 items registered
14:48:43 [INFO] __main__:   all services created
14:48:43 [INFO] __main__: Wiring event handlers …
14:48:43 [INFO] __main__:   event handlers registered
14:48:43 [INFO] gameserver.engine.empire_service: Empire registered: uid=100 name='TestImperium'
14:48:43 [INFO] gameserver.engine.empire_service: Empire 100: recalculated effects → {}
14:48:43 [INFO] gameserver.engine.empire_service: Empire registered: uid=2 name='Empire1'
14:48:43 [INFO] gameserver.engine.empire_service: Empire 2: recalculated effects → {'gold_offset': 0.15000000000000002, 'culture_offset': 0.15000000000000002}
14:48:43 [INFO] __main__: Restored 2 empires from saved state
14:48:43 [INFO] __main__: Starting network server …
14:48:43 [INFO] gameserver.network.handlers: Registered 29 message handlers: summary_request, item_request, military_request, new_item, new_structure, delete_structure, upgrade_structure, citizen_upgrade, change_citizen, increase_life, new_army, new_attack_request, change_army, new_wave, change_wave, end_siege, battle_register, battle_unregister, battle_next_wave_request, notification_request, user_message, timeline_request, userinfo_request, hall_of_fame_request, preferences_request, change_preferences, auth_request, signup, create_empire
14:48:43 [INFO] websockets.server: server listening on 0.0.0.0:8765
14:48:43 [INFO] gameserver.network.server: WebSocket server listening on ws://0.0.0.0:8765
14:48:43 [INFO] __main__:   WebSocket server listening on 0.0.0.0:8765
14:48:43 [INFO] gameserver.debug.dashboard: Debug dashboard running at http://0.0.0.0:9000/
14:48:43 [INFO] __main__: Starting game loop …
14:48:43 [INFO] __main__:   game loop running (1 s tick)
14:48:43 [INFO] websockets.server: connection open
14:48:43 [INFO] gameserver.network.server: Session registered: uid=-1
14:48:43 [INFO] gameserver.network.server: Client connected: uid=-1 remote=('192.168.178.2', 64573)
14:48:43 [INFO] gameserver.network.auth: Login success: eem (uid=2)
14:48:43 [INFO] gameserver.network.server: Session registered: uid=2
14:48:43 [INFO] gameserver.network.server: Session upgraded: guest=-1 → uid=2
14:48:44 [INFO] gameserver.network.handlers: citizen_upgrade request from uid=2
14:48:44 [INFO] gameserver.network.handlers: citizen_upgrade failed uid=2: Not enough culture (need 125.0, have 72.9)
14:50:19 [INFO] gameserver.network.server: Session removed: uid=2
14:50:19 [INFO] websockets.server: connection open
14:50:19 [INFO] gameserver.network.server: Session registered: uid=-2
14:50:19 [INFO] gameserver.network.server: Client connected: uid=-2 remote=('192.168.178.2', 55293)
14:50:19 [INFO] gameserver.network.auth: Login success: eem (uid=2)
14:50:19 [INFO] gameserver.network.server: Session registered: uid=2
14:50:19 [INFO] gameserver.network.server: Session upgraded: guest=-2 → uid=2
14:50:30 [INFO] __main__: Shutdown signal received — stopping …
14:50:30 [INFO] __main__: Shutting down …
14:50:30 [INFO] gameserver.persistence.state_save: Game state saved to state.yaml (2 empires, 0 attacks, 0 battles)
14:50:30 [INFO] websockets.server: server closing
14:50:30 [INFO] gameserver.network.server: Session removed: uid=2
14:50:30 [INFO] websockets.server: server closed
14:50:30 [INFO] gameserver.network.server: WebSocket server stopped
14:50:30 [INFO] __main__:   WebSocket server stopped
14:50:30 [INFO] __main__:   debug dashboard stopped
14:50:30 [INFO] __main__:   database closed
14:50:30 [INFO] __main__:   goodbye
14:52:02 [INFO] __main__: === Game Server starting ===
14:52:02 [INFO] __main__: Loading configuration …
14:52:03 [INFO] __main__:   items:        210 loaded from config
14:52:03 [INFO] __main__:   map:          4 paths, 23 build tiles from config/maps/default.yaml
14:52:03 [INFO] __main__:   ai_templates: 2 entries from config/ai_templates.yaml
14:52:03 [INFO] gameserver.loaders.game_config_loader: Loaded game config from config/game.yaml (29 keys)
14:52:03 [INFO] __main__:   game_config:  loaded
14:52:03 [INFO] __main__: Initializing persistence …
14:52:03 [INFO] gameserver.persistence.database: Database connected: gameserver.db
14:52:03 [INFO] __main__:   database:     connected (gameserver.db)
14:52:03 [INFO] gameserver.persistence.state_load: Restoring state from state.yaml (saved at 2026-02-08T14:50:30, version 1)
14:52:03 [INFO] gameserver.persistence.state_load: Restored 2 empires, 0 attacks, 0 battles
14:52:03 [INFO] __main__:   state:        restored from disk (2 empires, 0 attacks)
14:52:03 [INFO] __main__: Creating services …
14:52:03 [INFO] __main__:   upgrade_provider: 210 items registered
14:52:03 [INFO] __main__:   all services created
14:52:03 [INFO] __main__: Wiring event handlers …
14:52:03 [INFO] __main__:   event handlers registered
14:52:03 [INFO] gameserver.engine.empire_service: Empire registered: uid=100 name='TestImperium'
14:52:03 [INFO] gameserver.engine.empire_service: Empire 100: recalculated effects → {}
14:52:03 [INFO] gameserver.engine.empire_service: Empire registered: uid=2 name='Empire1'
14:52:03 [INFO] gameserver.engine.empire_service: Empire 2: recalculated effects → {'gold_offset': 0.15000000000000002, 'culture_offset': 0.15000000000000002}
14:52:03 [INFO] __main__: Restored 2 empires from saved state
14:52:03 [INFO] __main__: Starting network server …
14:52:03 [INFO] gameserver.network.handlers: Registered 29 message handlers: summary_request, item_request, military_request, new_item, new_structure, delete_structure, upgrade_structure, citizen_upgrade, change_citizen, increase_life, new_army, new_attack_request, change_army, new_wave, change_wave, end_siege, battle_register, battle_unregister, battle_next_wave_request, notification_request, user_message, timeline_request, userinfo_request, hall_of_fame_request, preferences_request, change_preferences, auth_request, signup, create_empire
14:52:03 [INFO] websockets.server: server listening on 0.0.0.0:8765
14:52:03 [INFO] gameserver.network.server: WebSocket server listening on ws://0.0.0.0:8765
14:52:03 [INFO] __main__:   WebSocket server listening on 0.0.0.0:8765
14:52:03 [INFO] gameserver.debug.dashboard: Debug dashboard running at http://0.0.0.0:9000/
14:52:03 [INFO] __main__: Starting game loop …
14:52:03 [INFO] __main__:   game loop running (1 s tick)
14:52:13 [INFO] websockets.server: connection open
14:52:13 [INFO] gameserver.network.server: Session registered: uid=-1
14:52:13 [INFO] gameserver.network.server: Client connected: uid=-1 remote=('192.168.178.2', 62539)
14:52:13 [INFO] gameserver.network.auth: Login success: eem (uid=2)
14:52:13 [INFO] gameserver.network.server: Session registered: uid=2
14:52:13 [INFO] gameserver.network.server: Session upgraded: guest=-1 → uid=2
14:52:17 [INFO] gameserver.network.auth: Login success: eem (uid=2)
14:52:17 [INFO] gameserver.network.server: Session registered: uid=2
14:52:17 [INFO] gameserver.network.server: Session upgraded: guest=2 → uid=2
14:52:20 [INFO] gameserver.network.handlers: change_citizen request from uid=2
14:52:20 [INFO] gameserver.network.handlers: change_citizen failed uid=2: Total citizens must remain 1 (got 0)
14:52:21 [INFO] gameserver.network.handlers: change_citizen request from uid=2
14:52:21 [INFO] gameserver.network.handlers: change_citizen failed uid=2: Total citizens must remain 1 (got 2)
14:52:22 [INFO] gameserver.network.handlers: change_citizen request from uid=2
14:52:22 [INFO] gameserver.network.handlers: change_citizen failed uid=2: Total citizens must remain 1 (got 2)
14:52:22 [INFO] gameserver.network.handlers: change_citizen request from uid=2
14:52:22 [INFO] gameserver.network.handlers: change_citizen failed uid=2: Total citizens must remain 1 (got 0)
14:52:25 [INFO] gameserver.network.handlers: change_citizen request from uid=2
14:52:25 [INFO] gameserver.network.handlers: change_citizen failed uid=2: Total citizens must remain 1 (got 0)
14:52:28 [INFO] gameserver.network.handlers: change_citizen request from uid=2
14:52:28 [INFO] gameserver.network.handlers: change_citizen failed uid=2: Total citizens must remain 1 (got 0)
14:52:30 [INFO] gameserver.network.handlers: change_citizen request from uid=2
14:52:30 [INFO] gameserver.network.handlers: change_citizen failed uid=2: Total citizens must remain 1 (got 0)
14:52:30 [INFO] gameserver.network.handlers: change_citizen request from uid=2
14:52:30 [INFO] gameserver.network.handlers: change_citizen failed uid=2: Total citizens must remain 1 (got 0)
14:52:30 [INFO] gameserver.network.handlers: change_citizen request from uid=2
14:52:30 [INFO] gameserver.network.handlers: change_citizen failed uid=2: Total citizens must remain 1 (got 0)
14:52:31 [INFO] gameserver.network.handlers: change_citizen request from uid=2
14:52:31 [INFO] gameserver.network.handlers: change_citizen failed uid=2: Total citizens must remain 1 (got 0)
14:54:25 [INFO] __main__: Shutdown signal received — stopping …
14:54:25 [INFO] __main__: Shutting down …
14:54:26 [INFO] gameserver.persistence.state_save: Game state saved to state.yaml (2 empires, 0 attacks, 0 battles)
14:54:26 [INFO] websockets.server: server closing
14:54:26 [INFO] gameserver.network.server: Session removed: uid=2
14:54:26 [INFO] websockets.server: server closed
14:54:26 [INFO] gameserver.network.server: WebSocket server stopped
14:54:26 [INFO] __main__:   WebSocket server stopped
14:54:26 [INFO] __main__:   debug dashboard stopped
14:54:26 [INFO] __main__:   database closed
14:54:26 [INFO] __main__:   goodbye
14:54:27 [INFO] __main__: === Game Server starting ===
14:54:27 [INFO] __main__: Loading configuration …
14:54:28 [INFO] __main__:   items:        210 loaded from config
14:54:28 [INFO] __main__:   map:          4 paths, 23 build tiles from config/maps/default.yaml
14:54:28 [INFO] __main__:   ai_templates: 2 entries from config/ai_templates.yaml
14:54:28 [INFO] gameserver.loaders.game_config_loader: Loaded game config from config/game.yaml (29 keys)
14:54:28 [INFO] __main__:   game_config:  loaded
14:54:28 [INFO] __main__: Initializing persistence …
14:54:28 [INFO] gameserver.persistence.database: Database connected: gameserver.db
14:54:28 [INFO] __main__:   database:     connected (gameserver.db)
14:54:28 [INFO] gameserver.persistence.state_load: Restoring state from state.yaml (saved at 2026-02-08T14:54:25, version 1)
14:54:28 [INFO] gameserver.persistence.state_load: Restored 2 empires, 0 attacks, 0 battles
14:54:28 [INFO] __main__:   state:        restored from disk (2 empires, 0 attacks)
14:54:28 [INFO] __main__: Creating services …
14:54:28 [INFO] __main__:   upgrade_provider: 210 items registered
14:54:28 [INFO] __main__:   all services created
14:54:28 [INFO] __main__: Wiring event handlers …
14:54:28 [INFO] __main__:   event handlers registered
14:54:28 [INFO] gameserver.engine.empire_service: Empire registered: uid=100 name='TestImperium'
14:54:28 [INFO] gameserver.engine.empire_service: Empire 100: recalculated effects → {}
14:54:28 [INFO] gameserver.engine.empire_service: Empire registered: uid=2 name='Empire1'
14:54:28 [INFO] gameserver.engine.empire_service: Empire 2: recalculated effects → {'gold_offset': 0.15000000000000002, 'culture_offset': 0.15000000000000002}
14:54:28 [INFO] __main__: Restored 2 empires from saved state
14:54:28 [INFO] __main__: Starting network server …
14:54:28 [INFO] gameserver.network.handlers: Registered 29 message handlers: summary_request, item_request, military_request, new_item, new_structure, delete_structure, upgrade_structure, citizen_upgrade, change_citizen, increase_life, new_army, new_attack_request, change_army, new_wave, change_wave, end_siege, battle_register, battle_unregister, battle_next_wave_request, notification_request, user_message, timeline_request, userinfo_request, hall_of_fame_request, preferences_request, change_preferences, auth_request, signup, create_empire
14:54:28 [INFO] websockets.server: server listening on 0.0.0.0:8765
14:54:28 [INFO] gameserver.network.server: WebSocket server listening on ws://0.0.0.0:8765
14:54:28 [INFO] __main__:   WebSocket server listening on 0.0.0.0:8765
14:54:28 [INFO] gameserver.debug.dashboard: Debug dashboard running at http://0.0.0.0:9000/
14:54:28 [INFO] __main__: Starting game loop …
14:54:28 [INFO] __main__:   game loop running (1 s tick)
14:54:29 [INFO] websockets.server: connection open
14:54:29 [INFO] gameserver.network.server: Session registered: uid=-1
14:54:29 [INFO] gameserver.network.server: Client connected: uid=-1 remote=('192.168.178.2', 51234)
14:54:29 [INFO] gameserver.network.auth: Login success: eem (uid=2)
14:54:29 [INFO] gameserver.network.server: Session registered: uid=2
14:54:29 [INFO] gameserver.network.server: Session upgraded: guest=-1 → uid=2
14:54:31 [INFO] gameserver.network.server: Session removed: uid=2
14:54:31 [INFO] websockets.server: connection open
14:54:31 [INFO] gameserver.network.server: Session registered: uid=-2
14:54:31 [INFO] gameserver.network.server: Client connected: uid=-2 remote=('192.168.178.2', 51256)
14:54:31 [INFO] gameserver.network.auth: Login success: eem (uid=2)
14:54:31 [INFO] gameserver.network.server: Session registered: uid=2
14:54:31 [INFO] gameserver.network.server: Session upgraded: guest=-2 → uid=2
14:54:32 [INFO] gameserver.network.handlers: change_citizen request from uid=2
14:54:32 [INFO] gameserver.network.handlers: change_citizen failed uid=2: Total citizens must remain 1 (got 0)
14:55:00 [INFO] __main__: Shutdown signal received — stopping …
14:55:01 [INFO] __main__: Shutting down …
14:55:01 [INFO] gameserver.persistence.state_save: Game state saved to state.yaml (2 empires, 0 attacks, 0 battles)
14:55:01 [INFO] websockets.server: server closing
14:55:01 [INFO] gameserver.network.server: Session removed: uid=2
14:55:01 [INFO] websockets.server: server closed
14:55:01 [INFO] gameserver.network.server: WebSocket server stopped
14:55:01 [INFO] __main__:   WebSocket server stopped
14:55:01 [INFO] __main__:   debug dashboard stopped
14:55:01 [INFO] __main__:   database closed
14:55:01 [INFO] __main__:   goodbye
14:55:04 [INFO] __main__: === Game Server starting ===
14:55:04 [INFO] __main__: Loading configuration …
14:55:05 [INFO] __main__:   items:        210 loaded from config
14:55:05 [INFO] __main__:   map:          4 paths, 23 build tiles from config/maps/default.yaml
14:55:05 [INFO] __main__:   ai_templates: 2 entries from config/ai_templates.yaml
14:55:05 [INFO] gameserver.loaders.game_config_loader: Loaded game config from config/game.yaml (29 keys)
14:55:05 [INFO] __main__:   game_config:  loaded
14:55:05 [INFO] __main__: Initializing persistence …
14:55:05 [INFO] gameserver.persistence.database: Database connected: gameserver.db
14:55:05 [INFO] __main__:   database:     connected (gameserver.db)
14:55:05 [INFO] gameserver.persistence.state_load: Restoring state from state.yaml (saved at 2026-02-08T14:55:01, version 1)
14:55:05 [INFO] gameserver.persistence.state_load: Restored 2 empires, 0 attacks, 0 battles
14:55:05 [INFO] __main__:   state:        restored from disk (2 empires, 0 attacks)
14:55:05 [INFO] __main__: Creating services …
14:55:05 [INFO] __main__:   upgrade_provider: 210 items registered
14:55:05 [INFO] __main__:   all services created
14:55:05 [INFO] __main__: Wiring event handlers …
14:55:05 [INFO] __main__:   event handlers registered
14:55:05 [INFO] gameserver.engine.empire_service: Empire registered: uid=100 name='TestImperium'
14:55:05 [INFO] gameserver.engine.empire_service: Empire 100: recalculated effects → {}
14:55:05 [INFO] gameserver.engine.empire_service: Empire registered: uid=2 name='Empire1'
14:55:05 [INFO] gameserver.engine.empire_service: Empire 2: recalculated effects → {'gold_offset': 0.15000000000000002, 'culture_offset': 0.15000000000000002}
14:55:05 [INFO] __main__: Restored 2 empires from saved state
14:55:05 [INFO] __main__: Starting network server …
14:55:05 [INFO] gameserver.network.handlers: Registered 29 message handlers: summary_request, item_request, military_request, new_item, new_structure, delete_structure, upgrade_structure, citizen_upgrade, change_citizen, increase_life, new_army, new_attack_request, change_army, new_wave, change_wave, end_siege, battle_register, battle_unregister, battle_next_wave_request, notification_request, user_message, timeline_request, userinfo_request, hall_of_fame_request, preferences_request, change_preferences, auth_request, signup, create_empire
14:55:05 [INFO] websockets.server: server listening on 0.0.0.0:8765
14:55:05 [INFO] gameserver.network.server: WebSocket server listening on ws://0.0.0.0:8765
14:55:05 [INFO] __main__:   WebSocket server listening on 0.0.0.0:8765
14:55:05 [INFO] gameserver.debug.dashboard: Debug dashboard running at http://0.0.0.0:9000/
14:55:05 [INFO] __main__: Starting game loop …
14:55:05 [INFO] __main__:   game loop running (1 s tick)
14:55:05 [INFO] websockets.server: connection open
14:55:05 [INFO] gameserver.network.server: Session registered: uid=-1
14:55:05 [INFO] gameserver.network.server: Client connected: uid=-1 remote=('192.168.178.2', 65322)
14:55:05 [INFO] gameserver.network.auth: Login success: eem (uid=2)
14:55:05 [INFO] gameserver.network.server: Session registered: uid=2
14:55:05 [INFO] gameserver.network.server: Session upgraded: guest=-1 → uid=2
14:55:07 [INFO] gameserver.network.server: Session removed: uid=2
14:55:07 [ERROR] websockets.server: opening handshake failed
Traceback (most recent call last):
  File "/home/pi/e3/.venv/lib/python3.9/site-packages/websockets/http11.py", line 138, in parse
    request_line = yield from parse_line(read_line)
  File "/home/pi/e3/.venv/lib/python3.9/site-packages/websockets/http11.py", line 309, in parse_line
    line = yield from read_line(MAX_LINE_LENGTH)
  File "/home/pi/e3/.venv/lib/python3.9/site-packages/websockets/streams.py", line 46, in read_line
    raise EOFError(f"stream ends after {p} bytes, before end of line")
EOFError: stream ends after 0 bytes, before end of line

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/pi/e3/.venv/lib/python3.9/site-packages/websockets/server.py", line 545, in parse
    request = yield from Request.parse(
  File "/home/pi/e3/.venv/lib/python3.9/site-packages/websockets/http11.py", line 140, in parse
    raise EOFError("connection closed while reading HTTP request line") from exc
EOFError: connection closed while reading HTTP request line

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/pi/e3/.venv/lib/python3.9/site-packages/websockets/asyncio/server.py", line 356, in conn_handler
    await connection.handshake(
  File "/home/pi/e3/.venv/lib/python3.9/site-packages/websockets/asyncio/server.py", line 207, in handshake
    raise self.protocol.handshake_exc
websockets.exceptions.InvalidMessage: did not receive a valid HTTP request
14:55:07 [INFO] websockets.server: connection open
14:55:07 [INFO] gameserver.network.server: Session registered: uid=-2
14:55:07 [INFO] gameserver.network.server: Client connected: uid=-2 remote=('192.168.178.2', 65346)
14:55:07 [INFO] gameserver.network.auth: Login success: eem (uid=2)
14:55:07 [INFO] gameserver.network.server: Session registered: uid=2
14:55:07 [INFO] gameserver.network.server: Session upgraded: guest=-2 → uid=2
14:55:08 [INFO] gameserver.network.handlers: change_citizen request from uid=2
14:55:08 [INFO] gameserver.network.handlers: change_citizen failed uid=2: Total citizens must remain 1 (got 0)
14:55:21 [INFO] gameserver.network.server: Session removed: uid=2
14:55:21 [INFO] websockets.server: connection open
14:55:21 [INFO] gameserver.network.server: Session registered: uid=-3
14:55:21 [INFO] gameserver.network.server: Client connected: uid=-3 remote=('192.168.178.2', 59164)
14:55:21 [INFO] gameserver.network.auth: Login success: eem (uid=2)
14:55:21 [INFO] gameserver.network.server: Session registered: uid=2
14:55:21 [INFO] gameserver.network.server: Session upgraded: guest=-3 → uid=2
14:55:24 [INFO] gameserver.network.handlers: change_citizen request from uid=2
14:55:24 [INFO] gameserver.network.handlers: change_citizen failed uid=2: Total citizens must remain 1 (got 0)
14:55:24 [INFO] gameserver.network.handlers: change_citizen request from uid=2
14:55:24 [INFO] gameserver.network.handlers: change_citizen failed uid=2: Total citizens must remain 1 (got 2)
15:00:38 [INFO] gameserver.network.server: Session removed: uid=2
15:00:38 [INFO] websockets.server: connection open
15:00:38 [INFO] gameserver.network.server: Session registered: uid=-4
15:00:38 [INFO] gameserver.network.server: Client connected: uid=-4 remote=('192.168.178.2', 65248)
15:00:38 [INFO] gameserver.network.auth: Login success: eem (uid=2)
15:00:38 [INFO] gameserver.network.server: Session registered: uid=2
15:00:38 [INFO] gameserver.network.server: Session upgraded: guest=-4 → uid=2
15:00:40 [INFO] gameserver.network.handlers: change_citizen request from uid=2
15:00:40 [INFO] gameserver.network.handlers: change_citizen failed uid=2: Total citizens must remain 1 (got 0)
15:02:37 [INFO] __main__: Shutdown signal received — stopping …
15:02:37 [INFO] __main__: Shutting down …
15:02:38 [INFO] gameserver.persistence.state_save: Game state saved to state.yaml (2 empires, 0 attacks, 0 battles)
15:02:38 [INFO] websockets.server: server closing
15:02:38 [INFO] gameserver.network.server: Session removed: uid=2
15:02:38 [INFO] websockets.server: server closed
15:02:38 [INFO] gameserver.network.server: WebSocket server stopped
15:02:38 [INFO] __main__:   WebSocket server stopped
15:02:38 [INFO] __main__:   debug dashboard stopped
15:02:38 [INFO] __main__:   database closed
15:02:38 [INFO] __main__:   goodbye
15:02:39 [INFO] __main__: === Game Server starting ===
15:02:39 [INFO] __main__: Loading configuration …
15:02:40 [INFO] __main__:   items:        210 loaded from config
15:02:40 [INFO] __main__:   map:          4 paths, 23 build tiles from config/maps/default.yaml
15:02:40 [INFO] __main__:   ai_templates: 2 entries from config/ai_templates.yaml
15:02:40 [INFO] gameserver.loaders.game_config_loader: Loaded game config from config/game.yaml (29 keys)
15:02:40 [INFO] __main__:   game_config:  loaded
15:02:40 [INFO] __main__: Initializing persistence …
15:02:40 [INFO] gameserver.persistence.database: Database connected: gameserver.db
15:02:40 [INFO] __main__:   database:     connected (gameserver.db)
15:02:40 [INFO] gameserver.persistence.state_load: Restoring state from state.yaml (saved at 2026-02-08T15:02:37, version 1)
15:02:40 [INFO] gameserver.persistence.state_load: Restored 2 empires, 0 attacks, 0 battles
15:02:40 [INFO] __main__:   state:        restored from disk (2 empires, 0 attacks)
15:02:40 [INFO] __main__: Creating services …
15:02:40 [INFO] __main__:   upgrade_provider: 210 items registered
15:02:40 [INFO] __main__:   all services created
15:02:40 [INFO] __main__: Wiring event handlers …
15:02:40 [INFO] __main__:   event handlers registered
15:02:40 [INFO] gameserver.engine.empire_service: Empire registered: uid=100 name='TestImperium'
15:02:40 [INFO] gameserver.engine.empire_service: Empire 100: recalculated effects → {}
15:02:40 [INFO] gameserver.engine.empire_service: Empire registered: uid=2 name='Empire1'
15:02:40 [INFO] gameserver.engine.empire_service: Empire 2: recalculated effects → {'gold_offset': 0.15000000000000002, 'culture_offset': 0.15000000000000002}
15:02:40 [INFO] __main__: Restored 2 empires from saved state
15:02:40 [INFO] __main__: Starting network server …
15:02:40 [INFO] gameserver.network.handlers: Registered 29 message handlers: summary_request, item_request, military_request, new_item, new_structure, delete_structure, upgrade_structure, citizen_upgrade, change_citizen, increase_life, new_army, new_attack_request, change_army, new_wave, change_wave, end_siege, battle_register, battle_unregister, battle_next_wave_request, notification_request, user_message, timeline_request, userinfo_request, hall_of_fame_request, preferences_request, change_preferences, auth_request, signup, create_empire
15:02:40 [INFO] websockets.server: server listening on 0.0.0.0:8765
15:02:40 [INFO] gameserver.network.server: WebSocket server listening on ws://0.0.0.0:8765
15:02:40 [INFO] __main__:   WebSocket server listening on 0.0.0.0:8765
15:02:40 [INFO] gameserver.debug.dashboard: Debug dashboard running at http://0.0.0.0:9000/
15:02:40 [INFO] __main__: Starting game loop …
15:02:40 [INFO] __main__:   game loop running (1 s tick)
15:02:41 [INFO] websockets.server: connection open
15:02:41 [INFO] gameserver.network.server: Session registered: uid=-1
15:02:41 [INFO] gameserver.network.server: Client connected: uid=-1 remote=('192.168.178.2', 50168)
15:02:41 [INFO] gameserver.network.auth: Login success: eem (uid=2)
15:02:41 [INFO] gameserver.network.server: Session registered: uid=2
15:02:41 [INFO] gameserver.network.server: Session upgraded: guest=-1 → uid=2
15:04:27 [INFO] __main__: Shutdown signal received — stopping …
15:04:27 [INFO] __main__: Shutting down …
15:04:27 [INFO] gameserver.persistence.state_save: Game state saved to state.yaml (2 empires, 0 attacks, 0 battles)
15:04:27 [INFO] websockets.server: server closing
15:04:27 [INFO] gameserver.network.server: Session removed: uid=2
15:04:27 [INFO] websockets.server: server closed
15:04:27 [INFO] gameserver.network.server: WebSocket server stopped
15:04:27 [INFO] __main__:   WebSocket server stopped
15:04:27 [INFO] __main__:   debug dashboard stopped
15:04:27 [INFO] __main__:   database closed
15:04:27 [INFO] __main__:   goodbye
15:04:29 [INFO] __main__: === Game Server starting ===
15:04:29 [INFO] __main__: Loading configuration …
15:04:29 [INFO] __main__:   items:        210 loaded from config
15:04:29 [INFO] __main__:   map:          4 paths, 23 build tiles from config/maps/default.yaml
15:04:29 [INFO] __main__:   ai_templates: 2 entries from config/ai_templates.yaml
15:04:29 [INFO] gameserver.loaders.game_config_loader: Loaded game config from config/game.yaml (29 keys)
15:04:29 [INFO] __main__:   game_config:  loaded
15:04:29 [INFO] __main__: Initializing persistence …
15:04:29 [INFO] gameserver.persistence.database: Database connected: gameserver.db
15:04:29 [INFO] __main__:   database:     connected (gameserver.db)
15:04:29 [INFO] gameserver.persistence.state_load: Restoring state from state.yaml (saved at 2026-02-08T15:04:27, version 1)
15:04:29 [INFO] gameserver.persistence.state_load: Restored 2 empires, 0 attacks, 0 battles
15:04:29 [INFO] __main__:   state:        restored from disk (2 empires, 0 attacks)
15:04:29 [INFO] __main__: Creating services …
15:04:29 [INFO] __main__:   upgrade_provider: 210 items registered
15:04:29 [INFO] __main__:   all services created
15:04:29 [INFO] __main__: Wiring event handlers …
15:04:29 [INFO] __main__:   event handlers registered
15:04:29 [INFO] gameserver.engine.empire_service: Empire registered: uid=100 name='TestImperium'
15:04:29 [INFO] gameserver.engine.empire_service: Empire 100: recalculated effects → {}
15:04:29 [INFO] gameserver.engine.empire_service: Empire registered: uid=2 name='Empire1'
15:04:29 [INFO] gameserver.engine.empire_service: Empire 2: recalculated effects → {'gold_offset': 0.15000000000000002, 'culture_offset': 0.15000000000000002}
15:04:29 [INFO] __main__: Restored 2 empires from saved state
15:04:29 [INFO] __main__: Starting network server …
15:04:29 [INFO] gameserver.network.handlers: Registered 29 message handlers: summary_request, item_request, military_request, new_item, new_structure, delete_structure, upgrade_structure, citizen_upgrade, change_citizen, increase_life, new_army, new_attack_request, change_army, new_wave, change_wave, end_siege, battle_register, battle_unregister, battle_next_wave_request, notification_request, user_message, timeline_request, userinfo_request, hall_of_fame_request, preferences_request, change_preferences, auth_request, signup, create_empire
15:04:29 [INFO] websockets.server: server listening on 0.0.0.0:8765
15:04:29 [INFO] gameserver.network.server: WebSocket server listening on ws://0.0.0.0:8765
15:04:29 [INFO] __main__:   WebSocket server listening on 0.0.0.0:8765
15:04:29 [INFO] gameserver.debug.dashboard: Debug dashboard running at http://0.0.0.0:9000/
15:04:29 [INFO] __main__: Starting game loop …
15:04:29 [INFO] __main__:   game loop running (1 s tick)
15:04:30 [INFO] websockets.server: connection open
15:04:30 [INFO] gameserver.network.server: Session registered: uid=-1
15:04:30 [INFO] gameserver.network.server: Client connected: uid=-1 remote=('192.168.178.2', 63032)
15:04:30 [INFO] gameserver.network.auth: Login success: eem (uid=2)
15:04:30 [INFO] gameserver.network.server: Session registered: uid=2
15:04:30 [INFO] gameserver.network.server: Session upgraded: guest=-1 → uid=2
15:04:34 [INFO] gameserver.network.server: Session removed: uid=2
15:04:34 [INFO] websockets.server: connection open
15:04:34 [INFO] gameserver.network.server: Session registered: uid=-2
15:04:34 [INFO] gameserver.network.server: Client connected: uid=-2 remote=('192.168.178.2', 63056)
15:04:34 [INFO] gameserver.network.auth: Login success: eem (uid=2)
15:04:34 [INFO] gameserver.network.server: Session registered: uid=2
15:04:34 [INFO] gameserver.network.server: Session upgraded: guest=-2 → uid=2
15:04:35 [INFO] gameserver.network.handlers: change_citizen request from uid=2
15:04:35 [INFO] gameserver.network.handlers: change_citizen success uid=2: {'merchant': 0, 'scientist': 0, 'artist': 0, 'free': 1}
15:04:40 [INFO] gameserver.network.handlers: change_citizen request from uid=2
15:04:40 [INFO] gameserver.network.handlers: change_citizen success uid=2: {'merchant': 0, 'scientist': 1, 'artist': 0, 'free': 0}
15:04:42 [INFO] gameserver.network.handlers: change_citizen request from uid=2
15:04:42 [INFO] gameserver.network.handlers: change_citizen success uid=2: {'merchant': 0, 'scientist': 0, 'artist': 0, 'free': 1}
15:04:42 [INFO] gameserver.network.handlers: change_citizen request from uid=2
15:04:42 [INFO] gameserver.network.handlers: change_citizen success uid=2: {'merchant': 1, 'scientist': 0, 'artist': 0, 'free': 0}
15:04:47 [INFO] gameserver.network.handlers: change_citizen request from uid=2
15:04:47 [INFO] gameserver.network.handlers: change_citizen success uid=2: {'merchant': 0, 'scientist': 0, 'artist': 0, 'free': 1}
15:04:48 [INFO] gameserver.network.handlers: change_citizen request from uid=2
15:04:48 [INFO] gameserver.network.handlers: change_citizen success uid=2: {'merchant': 0, 'scientist': 1, 'artist': 0, 'free': 0}
15:04:49 [INFO] gameserver.network.handlers: change_citizen request from uid=2
15:04:49 [INFO] gameserver.network.handlers: change_citizen success uid=2: {'merchant': 0, 'scientist': 0, 'artist': 0, 'free': 1}
15:04:50 [INFO] gameserver.network.server: Session removed: uid=2
15:04:50 [INFO] websockets.server: connection open
15:04:50 [INFO] gameserver.network.server: Session registered: uid=-3
15:04:50 [INFO] gameserver.network.server: Client connected: uid=-3 remote=('192.168.178.2', 63080)
15:04:50 [INFO] gameserver.network.auth: Login success: eem (uid=2)
15:04:50 [INFO] gameserver.network.server: Session registered: uid=2
15:04:50 [INFO] gameserver.network.server: Session upgraded: guest=-3 → uid=2
15:04:52 [INFO] gameserver.network.handlers: change_citizen request from uid=2
15:04:52 [INFO] gameserver.network.handlers: change_citizen success uid=2: {'merchant': 0, 'scientist': 0, 'artist': 1, 'free': 0}
15:04:52 [INFO] gameserver.network.server: Session removed: uid=2
15:04:52 [INFO] websockets.server: connection open
15:04:52 [INFO] gameserver.network.server: Session registered: uid=-4
15:04:52 [INFO] gameserver.network.server: Client connected: uid=-4 remote=('192.168.178.2', 63101)
15:04:52 [INFO] gameserver.network.auth: Login success: eem (uid=2)
15:04:52 [INFO] gameserver.network.server: Session registered: uid=2
15:04:52 [INFO] gameserver.network.server: Session upgraded: guest=-4 → uid=2
15:04:58 [INFO] gameserver.network.handlers: change_citizen request from uid=2
15:04:58 [INFO] gameserver.network.handlers: change_citizen failed uid=2: Too many citizens assigned (max 1, got 2)
15:05:00 [INFO] gameserver.network.handlers: change_citizen request from uid=2
15:05:00 [INFO] gameserver.network.handlers: change_citizen failed uid=2: Too many citizens assigned (max 1, got 2)
15:05:01 [INFO] gameserver.network.handlers: change_citizen request from uid=2
15:05:01 [INFO] gameserver.network.handlers: change_citizen success uid=2: {'merchant': 0, 'scientist': 0, 'artist': 0, 'free': 1}
15:05:04 [INFO] gameserver.network.handlers: change_citizen request from uid=2
15:05:04 [INFO] gameserver.network.handlers: change_citizen success uid=2: {'merchant': 0, 'scientist': 1, 'artist': 0, 'free': 0}
15:06:01 [INFO] gameserver.debug.dashboard: Signal sent (handled): type=summary_request sender=100
15:08:03 [INFO] gameserver.network.server: Session removed: uid=2
15:08:03 [INFO] websockets.server: connection open
15:08:03 [INFO] gameserver.network.server: Session registered: uid=-5
15:08:03 [INFO] gameserver.network.server: Client connected: uid=-5 remote=('192.168.178.2', 59208)
15:08:03 [INFO] gameserver.network.auth: Login success: eem (uid=2)
15:08:03 [INFO] gameserver.network.server: Session registered: uid=2
15:08:03 [INFO] gameserver.network.server: Session upgraded: guest=-5 → uid=2
15:08:08 [INFO] gameserver.engine.empire_service: Empire 2: started research HORSEBACK_RIDING (effort=5000.0)
15:08:08 [INFO] gameserver.network.handlers: new_item success uid=2 iid=HORSEBACK_RIDING
15:08:55 [INFO] gameserver.engine.empire_service: Empire 2: started research MUSIC (effort=4000.0)
15:08:55 [INFO] gameserver.network.handlers: new_item success uid=2 iid=MUSIC
15:09:01 [INFO] gameserver.engine.empire_service: Empire 2: started research HORSEBACK_RIDING (effort=5000.0)
15:09:01 [INFO] gameserver.network.handlers: new_item success uid=2 iid=HORSEBACK_RIDING
15:09:13 [INFO] gameserver.engine.empire_service: Empire 2: started building EXCHANGE_POST (effort=1500.0)
15:09:13 [INFO] gameserver.network.handlers: new_item success uid=2 iid=EXCHANGE_POST
15:09:19 [INFO] gameserver.engine.empire_service: Empire 2: started building EPIC_DRAWINGS (effort=1000.0)
15:09:19 [INFO] gameserver.network.handlers: new_item success uid=2 iid=EPIC_DRAWINGS
15:10:03 [INFO] __main__: Shutdown signal received — stopping …
15:10:04 [INFO] __main__: Shutting down …
15:10:04 [INFO] gameserver.persistence.state_save: Game state saved to state.yaml (2 empires, 0 attacks, 0 battles)
15:10:04 [INFO] websockets.server: server closing
15:10:04 [INFO] gameserver.network.server: Session removed: uid=2
15:10:04 [INFO] websockets.server: server closed
15:10:04 [INFO] gameserver.network.server: WebSocket server stopped
15:10:04 [INFO] __main__:   WebSocket server stopped
15:10:04 [INFO] __main__:   debug dashboard stopped
15:10:04 [INFO] __main__:   database closed
15:10:04 [INFO] __main__:   goodbye
15:10:05 [INFO] __main__: === Game Server starting ===
15:10:05 [INFO] __main__: Loading configuration …
15:10:06 [INFO] __main__:   items:        210 loaded from config
15:10:06 [INFO] __main__:   map:          4 paths, 23 build tiles from config/maps/default.yaml
15:10:06 [INFO] __main__:   ai_templates: 2 entries from config/ai_templates.yaml
15:10:06 [INFO] gameserver.loaders.game_config_loader: Loaded game config from config/game.yaml (29 keys)
15:10:06 [INFO] __main__:   game_config:  loaded
15:10:06 [INFO] __main__: Initializing persistence …
15:10:06 [INFO] gameserver.persistence.database: Database connected: gameserver.db
15:10:06 [INFO] __main__:   database:     connected (gameserver.db)
15:10:06 [INFO] gameserver.persistence.state_load: Restoring state from state.yaml (saved at 2026-02-08T15:10:04, version 1)
15:10:06 [INFO] gameserver.persistence.state_load: Restored 2 empires, 0 attacks, 0 battles
15:10:06 [INFO] __main__:   state:        restored from disk (2 empires, 0 attacks)
15:10:06 [INFO] __main__: Creating services …
15:10:06 [INFO] __main__:   upgrade_provider: 210 items registered
15:10:06 [INFO] __main__:   all services created
15:10:06 [INFO] __main__: Wiring event handlers …
15:10:06 [INFO] __main__:   event handlers registered
15:10:06 [INFO] gameserver.engine.empire_service: Empire registered: uid=100 name='TestImperium'
15:10:06 [INFO] gameserver.engine.empire_service: Empire 100: recalculated effects → {}
15:10:06 [INFO] gameserver.engine.empire_service: Empire registered: uid=2 name='Empire1'
15:10:06 [INFO] gameserver.engine.empire_service: Empire 2: recalculated effects → {'gold_offset': 0.15000000000000002, 'culture_offset': 0.15000000000000002}
15:10:06 [INFO] __main__: Restored 2 empires from saved state
15:10:06 [INFO] __main__: Starting network server …
15:10:06 [INFO] gameserver.network.handlers: Registered 29 message handlers: summary_request, item_request, military_request, new_item, new_structure, delete_structure, upgrade_structure, citizen_upgrade, change_citizen, increase_life, new_army, new_attack_request, change_army, new_wave, change_wave, end_siege, battle_register, battle_unregister, battle_next_wave_request, notification_request, user_message, timeline_request, userinfo_request, hall_of_fame_request, preferences_request, change_preferences, auth_request, signup, create_empire
15:10:06 [INFO] websockets.server: server listening on 0.0.0.0:8765
15:10:06 [INFO] gameserver.network.server: WebSocket server listening on ws://0.0.0.0:8765
15:10:06 [INFO] __main__:   WebSocket server listening on 0.0.0.0:8765
15:10:06 [INFO] gameserver.debug.dashboard: Debug dashboard running at http://0.0.0.0:9000/
15:10:06 [INFO] __main__: Starting game loop …
15:10:06 [INFO] __main__:   game loop running (1 s tick)
15:10:07 [INFO] websockets.server: connection open
15:10:07 [INFO] gameserver.network.server: Session registered: uid=-1
15:10:07 [INFO] gameserver.network.server: Client connected: uid=-1 remote=('192.168.178.2', 50718)
15:10:07 [INFO] gameserver.network.auth: Login success: eem (uid=2)
15:10:07 [INFO] gameserver.network.server: Session registered: uid=2
15:10:07 [INFO] gameserver.network.server: Session upgraded: guest=-1 → uid=2
15:10:10 [INFO] gameserver.network.server: Session removed: uid=2
15:10:10 [INFO] websockets.server: connection open
15:10:10 [INFO] gameserver.network.server: Session registered: uid=-2
15:10:10 [INFO] gameserver.network.server: Client connected: uid=-2 remote=('192.168.178.2', 50743)
15:10:10 [INFO] gameserver.network.auth: Login success: eem (uid=2)
15:10:10 [INFO] gameserver.network.server: Session registered: uid=2
15:10:10 [INFO] gameserver.network.server: Session upgraded: guest=-2 → uid=2
15:10:12 [INFO] gameserver.engine.empire_service: Empire 2: started building EXCHANGE_POST (effort=1500.0)
15:10:12 [INFO] gameserver.network.handlers: new_item success uid=2 iid=EXCHANGE_POST
15:10:17 [INFO] gameserver.engine.empire_service: Empire 2: started building EPIC_DRAWINGS (effort=1000.0)
15:10:17 [INFO] gameserver.network.handlers: new_item success uid=2 iid=EPIC_DRAWINGS
15:10:22 [INFO] gameserver.engine.empire_service: Empire 2: started building EXCHANGE_POST (effort=1500.0)
15:10:22 [INFO] gameserver.network.handlers: new_item success uid=2 iid=EXCHANGE_POST
15:10:26 [INFO] gameserver.engine.empire_service: Empire 2: started building EPIC_DRAWINGS (effort=1000.0)
15:10:26 [INFO] gameserver.network.handlers: new_item success uid=2 iid=EPIC_DRAWINGS
15:12:36 [INFO] gameserver.network.server: Session removed: uid=2
15:12:36 [INFO] websockets.server: connection open
15:12:36 [INFO] gameserver.network.server: Session registered: uid=-3
15:12:36 [INFO] gameserver.network.server: Client connected: uid=-3 remote=('192.168.178.2', 57597)
15:12:36 [INFO] gameserver.network.auth: Login success: eem (uid=2)
15:12:36 [INFO] gameserver.network.server: Session registered: uid=2
15:12:36 [INFO] gameserver.network.server: Session upgraded: guest=-3 → uid=2
15:12:40 [INFO] gameserver.engine.empire_service: Empire 2: started building EXCHANGE_POST (effort=1500.0)
15:12:40 [INFO] gameserver.network.handlers: new_item success uid=2 iid=EXCHANGE_POST
15:12:45 [INFO] gameserver.engine.empire_service: Empire 2: started building EPIC_DRAWINGS (effort=1000.0)
15:12:45 [INFO] gameserver.network.handlers: new_item success uid=2 iid=EPIC_DRAWINGS
15:12:50 [INFO] gameserver.network.server: Session removed: uid=2
15:12:50 [INFO] websockets.server: connection open
15:12:50 [INFO] gameserver.network.server: Session registered: uid=-4
15:12:50 [INFO] gameserver.network.server: Client connected: uid=-4 remote=('192.168.178.2', 58062)
15:12:50 [INFO] gameserver.network.auth: Login success: eem (uid=2)
15:12:50 [INFO] gameserver.network.server: Session registered: uid=2
15:12:50 [INFO] gameserver.network.server: Session upgraded: guest=-4 → uid=2
15:16:41 [INFO] gameserver.network.server: Session removed: uid=2
15:16:41 [INFO] websockets.server: connection open
15:16:41 [INFO] gameserver.network.server: Session registered: uid=-5
15:16:41 [INFO] gameserver.network.server: Client connected: uid=-5 remote=('192.168.178.2', 60455)
15:16:41 [INFO] gameserver.network.auth: Login success: eem (uid=2)
15:16:41 [INFO] gameserver.network.server: Session registered: uid=2
15:16:41 [INFO] gameserver.network.server: Session upgraded: guest=-5 → uid=2
15:16:42 [INFO] gameserver.network.handlers: change_citizen request from uid=2
15:16:42 [INFO] gameserver.network.handlers: change_citizen success uid=2: {'merchant': 0, 'scientist': 0, 'artist': 0, 'free': 1}
15:16:48 [INFO] gameserver.network.handlers: change_citizen request from uid=2
15:16:48 [INFO] gameserver.network.handlers: change_citizen success uid=2: {'merchant': 0, 'scientist': 0, 'artist': 1, 'free': 0}
15:16:49 [INFO] gameserver.network.handlers: change_citizen request from uid=2
15:16:49 [INFO] gameserver.network.handlers: change_citizen success uid=2: {'merchant': 0, 'scientist': 0, 'artist': 0, 'free': 1}
15:18:17 [INFO] gameserver.network.server: Session removed: uid=2
15:18:17 [INFO] websockets.server: connection open
15:18:17 [INFO] gameserver.network.server: Session registered: uid=-6
15:18:17 [INFO] gameserver.network.server: Client connected: uid=-6 remote=('192.168.178.2', 56357)
15:18:17 [INFO] gameserver.network.auth: Login success: eem (uid=2)
15:18:17 [INFO] gameserver.network.server: Session registered: uid=2
15:18:17 [INFO] gameserver.network.server: Session upgraded: guest=-6 → uid=2
15:18:22 [ERROR] gameserver.network.server: Handler error: type=change_citizen uid=2
Traceback (most recent call last):
  File "/home/pi/e3/python_server/src/gameserver/network/server.py", line 196, in _handle_message
    response = await self._router.route(data, uid)
  File "/home/pi/e3/python_server/src/gameserver/network/router.py", line 60, in route
    message = parse_message(raw)
  File "/home/pi/e3/python_server/src/gameserver/models/messages.py", line 363, in parse_message
    return model_cls.model_validate(data)
  File "/home/pi/e3/.venv/lib/python3.9/site-packages/pydantic/main.py", line 716, in model_validate
    return cls.__pydantic_validator__.validate_python(
pydantic_core._pydantic_core.ValidationError: 1 validation error for ChangeCitizenRequest
citizens.free
  Input should be a valid integer [type=int_type, input_value=None, input_type=NoneType]
    For further information visit https://errors.pydantic.dev/2.12/v/int_type
15:18:25 [INFO] gameserver.network.server: Session removed: uid=2
15:18:25 [INFO] websockets.server: connection open
15:18:25 [INFO] gameserver.network.server: Session registered: uid=-7
15:18:25 [INFO] gameserver.network.server: Client connected: uid=-7 remote=('192.168.178.2', 52863)
15:18:25 [INFO] gameserver.network.auth: Login success: eem (uid=2)
15:18:25 [INFO] gameserver.network.server: Session registered: uid=2
15:18:25 [INFO] gameserver.network.server: Session upgraded: guest=-7 → uid=2
15:18:25 [INFO] gameserver.network.server: Session removed: uid=2
15:18:25 [INFO] websockets.server: connection open
15:18:25 [INFO] gameserver.network.server: Session registered: uid=-8
15:18:25 [INFO] gameserver.network.server: Client connected: uid=-8 remote=('192.168.178.2', 52887)
15:18:25 [INFO] gameserver.network.auth: Login success: eem (uid=2)
15:18:25 [INFO] gameserver.network.server: Session registered: uid=2
15:18:25 [INFO] gameserver.network.server: Session upgraded: guest=-8 → uid=2
15:18:27 [ERROR] gameserver.network.server: Handler error: type=change_citizen uid=2
Traceback (most recent call last):
  File "/home/pi/e3/python_server/src/gameserver/network/server.py", line 196, in _handle_message
    response = await self._router.route(data, uid)
  File "/home/pi/e3/python_server/src/gameserver/network/router.py", line 60, in route
    message = parse_message(raw)
  File "/home/pi/e3/python_server/src/gameserver/models/messages.py", line 363, in parse_message
    return model_cls.model_validate(data)
  File "/home/pi/e3/.venv/lib/python3.9/site-packages/pydantic/main.py", line 716, in model_validate
    return cls.__pydantic_validator__.validate_python(
pydantic_core._pydantic_core.ValidationError: 1 validation error for ChangeCitizenRequest
citizens.free
  Input should be a valid integer [type=int_type, input_value=None, input_type=NoneType]
    For further information visit https://errors.pydantic.dev/2.12/v/int_type
15:18:27 [INFO] gameserver.network.handlers: change_citizen request from uid=2
15:18:27 [INFO] gameserver.network.handlers: change_citizen success uid=2: {'merchant': 0, 'scientist': 0, 'artist': 1, 'free': 0}
15:18:29 [ERROR] gameserver.network.server: Handler error: type=change_citizen uid=2
Traceback (most recent call last):
  File "/home/pi/e3/python_server/src/gameserver/network/server.py", line 196, in _handle_message
    response = await self._router.route(data, uid)
  File "/home/pi/e3/python_server/src/gameserver/network/router.py", line 60, in route
    message = parse_message(raw)
  File "/home/pi/e3/python_server/src/gameserver/models/messages.py", line 363, in parse_message
    return model_cls.model_validate(data)
  File "/home/pi/e3/.venv/lib/python3.9/site-packages/pydantic/main.py", line 716, in model_validate
    return cls.__pydantic_validator__.validate_python(
pydantic_core._pydantic_core.ValidationError: 1 validation error for ChangeCitizenRequest
citizens.free
  Input should be a valid integer [type=int_type, input_value=None, input_type=NoneType]
    For further information visit https://errors.pydantic.dev/2.12/v/int_type
15:18:31 [INFO] gameserver.network.handlers: change_citizen request from uid=2
15:18:31 [INFO] gameserver.network.handlers: change_citizen success uid=2: {'merchant': 0, 'scientist': 0, 'artist': 0, 'free': 1}
15:18:35 [INFO] gameserver.network.handlers: change_citizen request from uid=2
15:18:35 [INFO] gameserver.network.handlers: change_citizen success uid=2: {'merchant': 0, 'scientist': 0, 'artist': 1, 'free': 0}
15:18:37 [INFO] gameserver.network.handlers: citizen_upgrade request from uid=2
15:18:37 [INFO] gameserver.network.handlers: citizen_upgrade success uid=2
15:18:39 [INFO] gameserver.network.handlers: change_citizen request from uid=2
15:18:39 [INFO] gameserver.network.handlers: change_citizen success uid=2: {'merchant': 0, 'scientist': 0, 'artist': 0, 'free': 2}
15:18:43 [INFO] gameserver.network.handlers: citizen_upgrade request from uid=2
15:18:43 [INFO] gameserver.network.handlers: citizen_upgrade success uid=2
15:18:44 [INFO] gameserver.network.handlers: citizen_upgrade request from uid=2
15:18:44 [INFO] gameserver.network.handlers: citizen_upgrade success uid=2
15:18:45 [INFO] gameserver.network.handlers: citizen_upgrade request from uid=2
15:18:45 [INFO] gameserver.network.handlers: citizen_upgrade failed uid=2: Not enough culture (need 361.4, have 326.2)
15:18:45 [INFO] gameserver.network.handlers: citizen_upgrade request from uid=2
15:18:45 [INFO] gameserver.network.handlers: citizen_upgrade failed uid=2: Not enough culture (need 361.4, have 326.3)
15:18:45 [INFO] gameserver.network.handlers: citizen_upgrade request from uid=2
15:18:45 [INFO] gameserver.network.handlers: citizen_upgrade failed uid=2: Not enough culture (need 361.4, have 326.3)
15:18:45 [INFO] gameserver.network.handlers: citizen_upgrade request from uid=2
15:18:45 [INFO] gameserver.network.handlers: citizen_upgrade failed uid=2: Not enough culture (need 361.4, have 326.3)
15:18:46 [INFO] gameserver.network.handlers: citizen_upgrade request from uid=2
15:18:46 [INFO] gameserver.network.handlers: citizen_upgrade failed uid=2: Not enough culture (need 361.4, have 326.3)
15:18:46 [INFO] gameserver.network.handlers: citizen_upgrade request from uid=2
15:18:46 [INFO] gameserver.network.handlers: citizen_upgrade failed uid=2: Not enough culture (need 361.4, have 326.3)
15:18:46 [INFO] gameserver.network.handlers: citizen_upgrade request from uid=2
15:18:46 [INFO] gameserver.network.handlers: citizen_upgrade failed uid=2: Not enough culture (need 361.4, have 326.3)
15:18:46 [INFO] gameserver.network.handlers: citizen_upgrade request from uid=2
15:18:46 [INFO] gameserver.network.handlers: citizen_upgrade failed uid=2: Not enough culture (need 361.4, have 326.5)
15:18:57 [INFO] gameserver.network.handlers: change_citizen request from uid=2
15:18:57 [INFO] gameserver.network.handlers: change_citizen success uid=2: {'merchant': 1, 'scientist': 0, 'artist': 0, 'free': 3}
15:18:57 [INFO] gameserver.network.handlers: change_citizen request from uid=2
15:18:57 [INFO] gameserver.network.handlers: change_citizen success uid=2: {'merchant': 2, 'scientist': 0, 'artist': 0, 'free': 2}
15:18:57 [INFO] gameserver.network.handlers: change_citizen request from uid=2
15:18:57 [INFO] gameserver.network.handlers: change_citizen success uid=2: {'merchant': 3, 'scientist': 0, 'artist': 0, 'free': 1}
15:18:57 [INFO] gameserver.network.handlers: change_citizen request from uid=2
15:18:57 [INFO] gameserver.network.handlers: change_citizen success uid=2: {'merchant': 4, 'scientist': 0, 'artist': 0, 'free': 0}
15:18:57 [INFO] gameserver.network.handlers: change_citizen request from uid=2
15:18:57 [INFO] gameserver.network.handlers: change_citizen failed uid=2: Too many citizens assigned (max 4, got 5)
15:18:57 [INFO] gameserver.network.handlers: change_citizen request from uid=2
15:18:57 [INFO] gameserver.network.handlers: change_citizen failed uid=2: Too many citizens assigned (max 4, got 5)
15:18:57 [INFO] gameserver.network.handlers: change_citizen request from uid=2
15:18:57 [INFO] gameserver.network.handlers: change_citizen failed uid=2: Too many citizens assigned (max 4, got 5)
15:20:13 [INFO] gameserver.network.server: Session removed: uid=2
15:20:14 [INFO] websockets.server: connection open
15:20:14 [INFO] gameserver.network.server: Session registered: uid=-9
15:20:14 [INFO] gameserver.network.server: Client connected: uid=-9 remote=('192.168.178.2', 62783)
15:20:14 [INFO] gameserver.network.auth: Login success: eem (uid=2)
15:20:14 [INFO] gameserver.network.server: Session registered: uid=2
15:20:14 [INFO] gameserver.network.server: Session upgraded: guest=-9 → uid=2
15:20:22 [INFO] gameserver.network.handlers: change_citizen request from uid=2
15:20:22 [INFO] gameserver.network.handlers: change_citizen success uid=2: {'merchant': 3, 'scientist': 0, 'artist': 0, 'free': 1}
15:20:23 [INFO] gameserver.network.handlers: change_citizen request from uid=2
15:20:23 [INFO] gameserver.network.handlers: change_citizen success uid=2: {'merchant': 2, 'scientist': 0, 'artist': 0, 'free': 2}
15:20:24 [INFO] gameserver.network.handlers: change_citizen request from uid=2
15:20:24 [INFO] gameserver.network.handlers: change_citizen success uid=2: {'merchant': 1, 'scientist': 0, 'artist': 0, 'free': 3}
15:20:25 [INFO] gameserver.network.handlers: change_citizen request from uid=2
15:20:25 [INFO] gameserver.network.handlers: change_citizen success uid=2: {'merchant': 0, 'scientist': 0, 'artist': 0, 'free': 4}
15:20:27 [INFO] gameserver.network.server: Session removed: uid=2
15:20:27 [INFO] websockets.server: connection open
15:20:27 [INFO] gameserver.network.server: Session registered: uid=-10
15:20:27 [INFO] gameserver.network.server: Client connected: uid=-10 remote=('192.168.178.2', 57482)
15:20:27 [INFO] gameserver.network.auth: Login success: eem (uid=2)
15:20:27 [INFO] gameserver.network.server: Session registered: uid=2
15:20:27 [INFO] gameserver.network.server: Session upgraded: guest=-10 → uid=2
15:20:28 [INFO] gameserver.network.handlers: change_citizen request from uid=2
15:20:28 [INFO] gameserver.network.handlers: change_citizen success uid=2: {'merchant': 1, 'scientist': 0, 'artist': 0, 'free': 3}
15:20:29 [INFO] gameserver.network.handlers: change_citizen request from uid=2
15:20:29 [INFO] gameserver.network.handlers: change_citizen success uid=2: {'merchant': 2, 'scientist': 0, 'artist': 0, 'free': 2}
15:20:29 [INFO] gameserver.network.handlers: change_citizen request from uid=2
15:20:29 [INFO] gameserver.network.handlers: change_citizen success uid=2: {'merchant': 3, 'scientist': 0, 'artist': 0, 'free': 1}
15:20:29 [INFO] gameserver.network.handlers: change_citizen request from uid=2
15:20:29 [INFO] gameserver.network.handlers: change_citizen success uid=2: {'merchant': 4, 'scientist': 0, 'artist': 0, 'free': 0}
15:20:29 [INFO] gameserver.network.handlers: change_citizen request from uid=2
15:20:29 [INFO] gameserver.network.handlers: change_citizen failed uid=2: Too many citizens assigned (max 4, got 5)
15:20:29 [INFO] gameserver.network.handlers: change_citizen request from uid=2
15:20:29 [INFO] gameserver.network.handlers: change_citizen failed uid=2: Too many citizens assigned (max 4, got 5)
15:20:29 [INFO] gameserver.network.handlers: change_citizen request from uid=2
15:20:29 [INFO] gameserver.network.handlers: change_citizen failed uid=2: Too many citizens assigned (max 4, got 5)
15:20:30 [INFO] gameserver.network.server: Session removed: uid=2
15:20:30 [INFO] websockets.server: connection open
15:20:30 [INFO] gameserver.network.server: Session registered: uid=-11
15:20:30 [INFO] gameserver.network.server: Client connected: uid=-11 remote=('192.168.178.2', 57506)
15:20:30 [INFO] gameserver.network.auth: Login success: eem (uid=2)
15:20:30 [INFO] gameserver.network.server: Session registered: uid=2
15:20:30 [INFO] gameserver.network.server: Session upgraded: guest=-11 → uid=2
15:22:06 [INFO] gameserver.network.server: Session removed: uid=2
15:22:06 [INFO] websockets.server: connection open
15:22:06 [INFO] gameserver.network.server: Session registered: uid=-12
15:22:06 [INFO] gameserver.network.server: Client connected: uid=-12 remote=('192.168.178.2', 54939)
15:22:06 [INFO] gameserver.network.auth: Login success: eem (uid=2)
15:22:06 [INFO] gameserver.network.server: Session registered: uid=2
15:22:06 [INFO] gameserver.network.server: Session upgraded: guest=-12 → uid=2
15:24:32 [INFO] gameserver.network.server: Session removed: uid=2
15:24:32 [INFO] websockets.server: connection open
15:24:32 [INFO] gameserver.network.server: Session registered: uid=-13
15:24:32 [INFO] gameserver.network.server: Client connected: uid=-13 remote=('192.168.178.2', 57020)
15:24:32 [INFO] gameserver.network.auth: Login success: eem (uid=2)
15:24:32 [INFO] gameserver.network.server: Session registered: uid=2
15:24:32 [INFO] gameserver.network.server: Session upgraded: guest=-13 → uid=2
15:24:34 [INFO] gameserver.network.server: Session removed: uid=2
15:24:35 [INFO] websockets.server: connection open
15:24:35 [INFO] gameserver.network.server: Session registered: uid=-14
15:24:35 [INFO] gameserver.network.server: Client connected: uid=-14 remote=('192.168.178.2', 64928)
15:24:35 [INFO] gameserver.network.auth: Login success: eem (uid=2)
15:24:35 [INFO] gameserver.network.server: Session registered: uid=2
15:24:35 [INFO] gameserver.network.server: Session upgraded: guest=-14 → uid=2
15:24:35 [INFO] gameserver.network.server: Session removed: uid=2
15:24:35 [INFO] websockets.server: connection open
15:24:35 [INFO] gameserver.network.server: Session registered: uid=-15
15:24:35 [INFO] gameserver.network.server: Client connected: uid=-15 remote=('192.168.178.2', 64949)
15:24:35 [INFO] gameserver.network.auth: Login success: eem (uid=2)
15:24:35 [INFO] gameserver.network.server: Session registered: uid=2
15:24:35 [INFO] gameserver.network.server: Session upgraded: guest=-15 → uid=2
15:24:35 [INFO] gameserver.network.server: Session removed: uid=2
15:24:35 [INFO] websockets.server: connection open
15:24:35 [INFO] gameserver.network.server: Session registered: uid=-16
15:24:35 [INFO] gameserver.network.server: Client connected: uid=-16 remote=('192.168.178.2', 64970)
15:24:35 [INFO] gameserver.network.auth: Login success: eem (uid=2)
15:24:35 [INFO] gameserver.network.server: Session registered: uid=2
15:24:35 [INFO] gameserver.network.server: Session upgraded: guest=-16 → uid=2
15:24:48 [INFO] gameserver.network.server: Session removed: uid=2
15:24:48 [INFO] websockets.server: connection open
15:24:48 [INFO] gameserver.network.server: Session registered: uid=-17
15:24:48 [INFO] gameserver.network.server: Client connected: uid=-17 remote=('192.168.178.2', 49776)
15:24:48 [INFO] gameserver.network.auth: Login success: eem (uid=2)
15:24:48 [INFO] gameserver.network.server: Session registered: uid=2
15:24:48 [INFO] gameserver.network.server: Session upgraded: guest=-17 → uid=2
15:24:50 [INFO] gameserver.network.server: Session removed: uid=2
15:24:50 [INFO] websockets.server: connection open
15:24:50 [INFO] gameserver.network.server: Session registered: uid=-18
15:24:50 [INFO] gameserver.network.server: Client connected: uid=-18 remote=('192.168.178.2', 49798)
15:24:50 [INFO] gameserver.network.auth: Login success: eem (uid=2)
15:24:50 [INFO] gameserver.network.server: Session registered: uid=2
15:24:50 [INFO] gameserver.network.server: Session upgraded: guest=-18 → uid=2
15:24:50 [INFO] gameserver.network.server: Session removed: uid=2
15:24:50 [INFO] websockets.server: connection open
15:24:50 [INFO] gameserver.network.server: Session registered: uid=-19
15:24:50 [INFO] gameserver.network.server: Client connected: uid=-19 remote=('192.168.178.2', 49819)
15:24:50 [INFO] gameserver.network.auth: Login success: eem (uid=2)
15:24:50 [INFO] gameserver.network.server: Session registered: uid=2
15:24:50 [INFO] gameserver.network.server: Session upgraded: guest=-19 → uid=2
15:24:51 [INFO] gameserver.network.server: Session removed: uid=2
15:24:51 [INFO] websockets.server: connection open
15:24:51 [INFO] gameserver.network.server: Session registered: uid=-20
15:24:51 [INFO] gameserver.network.server: Client connected: uid=-20 remote=('192.168.178.2', 49840)
15:24:51 [INFO] gameserver.network.auth: Login success: eem (uid=2)
15:24:51 [INFO] gameserver.network.server: Session registered: uid=2
15:24:51 [INFO] gameserver.network.server: Session upgraded: guest=-20 → uid=2
15:24:51 [INFO] gameserver.network.server: Session removed: uid=2
15:24:51 [INFO] websockets.server: connection open
15:24:51 [INFO] gameserver.network.server: Session registered: uid=-21
15:24:51 [INFO] gameserver.network.server: Client connected: uid=-21 remote=('192.168.178.2', 49861)
15:24:51 [INFO] gameserver.network.auth: Login success: eem (uid=2)
15:24:51 [INFO] gameserver.network.server: Session registered: uid=2
15:24:51 [INFO] gameserver.network.server: Session upgraded: guest=-21 → uid=2
15:24:51 [INFO] gameserver.network.server: Session removed: uid=2
15:24:51 [INFO] websockets.server: connection open
15:24:51 [INFO] gameserver.network.server: Session registered: uid=-22
15:24:51 [INFO] gameserver.network.server: Client connected: uid=-22 remote=('192.168.178.2', 49882)
15:24:51 [INFO] gameserver.network.auth: Login success: eem (uid=2)
15:24:51 [INFO] gameserver.network.server: Session registered: uid=2
15:24:51 [INFO] gameserver.network.server: Session upgraded: guest=-22 → uid=2
15:24:51 [INFO] gameserver.network.server: Session removed: uid=2
15:24:51 [INFO] websockets.server: connection open
15:24:51 [INFO] gameserver.network.server: Session registered: uid=-23
15:24:51 [INFO] gameserver.network.server: Client connected: uid=-23 remote=('192.168.178.2', 49903)
15:24:51 [INFO] gameserver.network.auth: Login success: eem (uid=2)
15:24:51 [INFO] gameserver.network.server: Session registered: uid=2
15:24:51 [INFO] gameserver.network.server: Session upgraded: guest=-23 → uid=2
15:25:10 [INFO] gameserver.network.server: Session removed: uid=2
15:25:10 [INFO] websockets.server: connection open
15:25:10 [INFO] gameserver.network.server: Session registered: uid=-24
15:25:10 [INFO] gameserver.network.server: Client connected: uid=-24 remote=('192.168.178.2', 51327)
15:25:10 [INFO] gameserver.network.auth: Login success: eem (uid=2)
15:25:10 [INFO] gameserver.network.server: Session registered: uid=2
15:25:10 [INFO] gameserver.network.server: Session upgraded: guest=-24 → uid=2
15:26:16 [INFO] gameserver.engine.empire_service: Empire 2: applied effects for EPIC_DRAWINGS: {'culture_modifier': 0.1}
15:26:16 [INFO] gameserver.engine.empire_service: Empire 2: building EPIC_DRAWINGS completed
15:27:09 [INFO] gameserver.network.server: Session removed: uid=2
15:27:10 [INFO] websockets.server: connection open
15:27:10 [INFO] gameserver.network.server: Session registered: uid=-25
15:27:10 [INFO] gameserver.network.server: Client connected: uid=-25 remote=('192.168.178.2', 49775)
15:27:10 [INFO] gameserver.network.auth: Login success: eem (uid=2)
15:27:10 [INFO] gameserver.network.server: Session registered: uid=2
15:27:10 [INFO] gameserver.network.server: Session upgraded: guest=-25 → uid=2
15:28:49 [INFO] gameserver.network.server: Session removed: uid=2
15:28:49 [INFO] websockets.server: connection open
15:28:49 [INFO] gameserver.network.server: Session registered: uid=-26
15:28:49 [INFO] gameserver.network.server: Client connected: uid=-26 remote=('192.168.178.2', 61449)
15:28:49 [INFO] gameserver.network.auth: Login success: eem (uid=2)
15:28:49 [INFO] gameserver.network.server: Session registered: uid=2
15:28:49 [INFO] gameserver.network.server: Session upgraded: guest=-26 → uid=2
15:29:01 [INFO] gameserver.network.server: Session removed: uid=2
15:29:01 [INFO] websockets.server: connection open
15:29:01 [INFO] gameserver.network.server: Session registered: uid=-27
15:29:01 [INFO] gameserver.network.server: Client connected: uid=-27 remote=('192.168.178.2', 61478)
15:29:01 [INFO] gameserver.network.auth: Login success: eem (uid=2)
15:29:01 [INFO] gameserver.network.server: Session registered: uid=2
15:29:01 [INFO] gameserver.network.server: Session upgraded: guest=-27 → uid=2
15:29:56 [INFO] gameserver.network.server: Session removed: uid=2
15:29:56 [INFO] websockets.server: connection open
15:29:56 [INFO] gameserver.network.server: Session registered: uid=-28
15:29:56 [INFO] gameserver.network.server: Client connected: uid=-28 remote=('192.168.178.2', 52392)
15:29:56 [INFO] gameserver.network.auth: Login success: eem (uid=2)
15:29:56 [INFO] gameserver.network.server: Session registered: uid=2
15:29:56 [INFO] gameserver.network.server: Session upgraded: guest=-28 → uid=2
15:30:04 [INFO] gameserver.network.server: Session removed: uid=2
15:30:04 [INFO] websockets.server: connection open
15:30:04 [INFO] gameserver.network.server: Session registered: uid=-29
15:30:04 [INFO] gameserver.network.server: Client connected: uid=-29 remote=('192.168.178.2', 50359)
15:30:04 [INFO] gameserver.network.auth: Login success: eem (uid=2)
15:30:04 [INFO] gameserver.network.server: Session registered: uid=2
15:30:04 [INFO] gameserver.network.server: Session upgraded: guest=-29 → uid=2
15:30:04 [INFO] gameserver.network.server: Session removed: uid=2
15:30:04 [INFO] websockets.server: connection open
15:30:04 [INFO] gameserver.network.server: Session registered: uid=-30
15:30:04 [INFO] gameserver.network.server: Client connected: uid=-30 remote=('192.168.178.2', 50380)
15:30:04 [INFO] gameserver.network.auth: Login success: eem (uid=2)
15:30:04 [INFO] gameserver.network.server: Session registered: uid=2
15:30:04 [INFO] gameserver.network.server: Session upgraded: guest=-30 → uid=2
15:30:07 [INFO] gameserver.engine.empire_service: Empire 2: started building TOOL_SHOP (effort=500.0)
15:30:07 [INFO] gameserver.network.handlers: new_item success uid=2 iid=TOOL_SHOP
15:31:22 [INFO] gameserver.network.server: Session removed: uid=2
15:31:22 [INFO] websockets.server: connection open
15:31:22 [INFO] gameserver.network.server: Session registered: uid=-31
15:31:22 [INFO] gameserver.network.server: Client connected: uid=-31 remote=('192.168.178.2', 59974)
15:31:22 [INFO] gameserver.network.auth: Login success: eem (uid=2)
15:31:22 [INFO] gameserver.network.server: Session registered: uid=2
15:31:22 [INFO] gameserver.network.server: Session upgraded: guest=-31 → uid=2
15:31:33 [INFO] gameserver.network.handlers: citizen_upgrade request from uid=2
15:31:33 [INFO] gameserver.network.handlers: citizen_upgrade success uid=2
15:31:34 [INFO] gameserver.network.handlers: citizen_upgrade request from uid=2
15:31:34 [INFO] gameserver.network.handlers: citizen_upgrade failed uid=2: Not enough culture (need 570.4, have 441.5)
15:31:38 [INFO] gameserver.network.handlers: change_citizen request from uid=2
15:31:38 [INFO] gameserver.network.handlers: change_citizen success uid=2: {'merchant': 4, 'scientist': 0, 'artist': 1, 'free': 0}
15:33:37 [INFO] gameserver.network.server: Session removed: uid=2
15:33:37 [INFO] websockets.server: connection open
15:33:37 [INFO] gameserver.network.server: Session registered: uid=-32
15:33:37 [INFO] gameserver.network.server: Client connected: uid=-32 remote=('192.168.178.2', 62187)
15:33:37 [INFO] gameserver.network.auth: Login success: eem (uid=2)
15:33:37 [INFO] gameserver.network.server: Session registered: uid=2
15:33:37 [INFO] gameserver.network.server: Session upgraded: guest=-32 → uid=2
15:33:50 [INFO] gameserver.network.server: Session removed: uid=2
15:33:50 [INFO] websockets.server: connection open
15:33:50 [INFO] gameserver.network.server: Session registered: uid=-33
15:33:50 [INFO] gameserver.network.server: Client connected: uid=-33 remote=('192.168.178.2', 50074)
15:33:50 [INFO] gameserver.network.auth: Login success: eem (uid=2)
15:33:50 [INFO] gameserver.network.server: Session registered: uid=2
15:33:50 [INFO] gameserver.network.server: Session upgraded: guest=-33 → uid=2
15:33:58 [INFO] gameserver.network.server: Session removed: uid=2
15:33:58 [INFO] websockets.server: connection open
15:33:58 [INFO] gameserver.network.server: Session registered: uid=-34
15:33:58 [INFO] gameserver.network.server: Client connected: uid=-34 remote=('192.168.178.2', 51220)
15:33:58 [INFO] gameserver.network.auth: Login success: eem (uid=2)
15:33:58 [INFO] gameserver.network.server: Session registered: uid=2
15:33:58 [INFO] gameserver.network.server: Session upgraded: guest=-34 → uid=2
15:34:06 [INFO] gameserver.network.server: Session removed: uid=2
15:34:07 [INFO] websockets.server: connection open
15:34:07 [INFO] gameserver.network.server: Session registered: uid=-35
15:34:07 [INFO] gameserver.network.server: Client connected: uid=-35 remote=('192.168.178.2', 51243)
15:34:07 [INFO] gameserver.network.auth: Login success: eem (uid=2)
15:34:07 [INFO] gameserver.network.server: Session registered: uid=2
15:34:07 [INFO] gameserver.network.server: Session upgraded: guest=-35 → uid=2
15:34:09 [INFO] gameserver.network.server: Session removed: uid=2
15:34:09 [INFO] websockets.server: connection open
15:34:09 [INFO] gameserver.network.server: Session registered: uid=-36
15:34:09 [INFO] gameserver.network.server: Client connected: uid=-36 remote=('192.168.178.2', 51247)
15:34:09 [INFO] gameserver.network.auth: Login success: eem (uid=2)
15:34:09 [INFO] gameserver.network.server: Session registered: uid=2
15:34:09 [INFO] gameserver.network.server: Session upgraded: guest=-36 → uid=2
15:34:09 [INFO] gameserver.network.server: Session removed: uid=2
15:34:09 [INFO] websockets.server: connection open
15:34:09 [INFO] gameserver.network.server: Session registered: uid=-37
15:34:09 [INFO] gameserver.network.server: Client connected: uid=-37 remote=('192.168.178.2', 51250)
15:34:09 [INFO] gameserver.network.auth: Login success: eem (uid=2)
15:34:09 [INFO] gameserver.network.server: Session registered: uid=2
15:34:09 [INFO] gameserver.network.server: Session upgraded: guest=-37 → uid=2
15:34:10 [INFO] gameserver.network.server: Session removed: uid=2
15:34:10 [INFO] websockets.server: connection open
15:34:10 [INFO] gameserver.network.server: Session registered: uid=-38
15:34:10 [INFO] gameserver.network.server: Client connected: uid=-38 remote=('192.168.178.2', 51253)
15:34:10 [INFO] gameserver.network.auth: Login success: eem (uid=2)
15:34:10 [INFO] gameserver.network.server: Session registered: uid=2
15:34:10 [INFO] gameserver.network.server: Session upgraded: guest=-38 → uid=2
15:34:10 [INFO] gameserver.network.server: Session removed: uid=2
15:34:10 [INFO] websockets.server: connection open
15:34:10 [INFO] gameserver.network.server: Session registered: uid=-39
15:34:10 [INFO] gameserver.network.server: Client connected: uid=-39 remote=('192.168.178.2', 51256)
15:34:10 [INFO] gameserver.network.auth: Login success: eem (uid=2)
15:34:10 [INFO] gameserver.network.server: Session registered: uid=2
15:34:10 [INFO] gameserver.network.server: Session upgraded: guest=-39 → uid=2
15:34:10 [INFO] gameserver.network.server: Session removed: uid=2
15:34:10 [INFO] websockets.server: connection open
15:34:10 [INFO] gameserver.network.server: Session registered: uid=-40
15:34:10 [INFO] gameserver.network.server: Client connected: uid=-40 remote=('192.168.178.2', 51259)
15:34:10 [INFO] gameserver.network.auth: Login success: eem (uid=2)
15:34:10 [INFO] gameserver.network.server: Session registered: uid=2
15:34:10 [INFO] gameserver.network.server: Session upgraded: guest=-40 → uid=2
15:34:23 [INFO] gameserver.network.handlers: change_citizen request from uid=2
15:34:23 [INFO] gameserver.network.handlers: change_citizen success uid=2: {'merchant': 4, 'scientist': 0, 'artist': 0, 'free': 1}
15:34:24 [INFO] gameserver.network.handlers: change_citizen request from uid=2
15:34:24 [INFO] gameserver.network.handlers: change_citizen success uid=2: {'merchant': 5, 'scientist': 0, 'artist': 0, 'free': 0}
15:34:29 [INFO] gameserver.network.handlers: change_citizen request from uid=2
15:34:29 [INFO] gameserver.network.handlers: change_citizen success uid=2: {'merchant': 4, 'scientist': 0, 'artist': 0, 'free': 1}
15:34:29 [INFO] gameserver.network.handlers: change_citizen request from uid=2
15:34:29 [INFO] gameserver.network.handlers: change_citizen success uid=2: {'merchant': 4, 'scientist': 0, 'artist': 1, 'free': 0}
15:34:30 [INFO] gameserver.network.handlers: change_citizen request from uid=2
15:34:30 [INFO] gameserver.network.handlers: change_citizen success uid=2: {'merchant': 4, 'scientist': 0, 'artist': 0, 'free': 1}
15:34:32 [INFO] gameserver.network.handlers: change_citizen request from uid=2
15:34:32 [INFO] gameserver.network.handlers: change_citizen success uid=2: {'merchant': 5, 'scientist': 0, 'artist': 0, 'free': 0}
15:34:34 [INFO] gameserver.network.handlers: change_citizen request from uid=2
15:34:34 [INFO] gameserver.network.handlers: change_citizen success uid=2: {'merchant': 4, 'scientist': 0, 'artist': 0, 'free': 1}
15:34:34 [INFO] gameserver.network.handlers: change_citizen request from uid=2
15:34:34 [INFO] gameserver.network.handlers: change_citizen success uid=2: {'merchant': 3, 'scientist': 0, 'artist': 0, 'free': 2}
15:34:34 [INFO] gameserver.network.handlers: change_citizen request from uid=2
15:34:34 [INFO] gameserver.network.handlers: change_citizen success uid=2: {'merchant': 2, 'scientist': 0, 'artist': 0, 'free': 3}
15:34:34 [INFO] gameserver.network.handlers: change_citizen request from uid=2
15:34:34 [INFO] gameserver.network.handlers: change_citizen success uid=2: {'merchant': 1, 'scientist': 0, 'artist': 0, 'free': 4}
15:34:35 [INFO] gameserver.network.handlers: change_citizen request from uid=2
15:34:35 [INFO] gameserver.network.handlers: change_citizen success uid=2: {'merchant': 0, 'scientist': 0, 'artist': 0, 'free': 5}
15:34:36 [INFO] gameserver.network.handlers: change_citizen request from uid=2
15:34:36 [INFO] gameserver.network.handlers: change_citizen success uid=2: {'merchant': 0, 'scientist': 0, 'artist': 1, 'free': 4}
15:34:36 [INFO] gameserver.network.handlers: change_citizen request from uid=2
15:34:36 [INFO] gameserver.network.handlers: change_citizen success uid=2: {'merchant': 0, 'scientist': 0, 'artist': 2, 'free': 3}
15:34:36 [INFO] gameserver.network.handlers: change_citizen request from uid=2
15:34:36 [INFO] gameserver.network.handlers: change_citizen success uid=2: {'merchant': 0, 'scientist': 0, 'artist': 3, 'free': 2}
15:34:36 [INFO] gameserver.network.handlers: change_citizen request from uid=2
15:34:36 [INFO] gameserver.network.handlers: change_citizen success uid=2: {'merchant': 0, 'scientist': 0, 'artist': 4, 'free': 1}
15:34:36 [INFO] gameserver.network.handlers: change_citizen request from uid=2
15:34:36 [INFO] gameserver.network.handlers: change_citizen success uid=2: {'merchant': 0, 'scientist': 0, 'artist': 5, 'free': 0}
15:34:37 [INFO] gameserver.network.handlers: change_citizen request from uid=2
15:34:37 [INFO] gameserver.network.handlers: change_citizen failed uid=2: Too many citizens assigned (max 5, got 6)
15:34:37 [INFO] gameserver.network.handlers: change_citizen request from uid=2
15:34:37 [INFO] gameserver.network.handlers: change_citizen failed uid=2: Too many citizens assigned (max 5, got 6)
15:34:37 [INFO] gameserver.network.handlers: change_citizen request from uid=2
15:34:37 [INFO] gameserver.network.handlers: change_citizen failed uid=2: Too many citizens assigned (max 5, got 6)
15:35:18 [INFO] gameserver.network.server: Session removed: uid=2
15:35:18 [INFO] websockets.server: connection open
15:35:18 [INFO] gameserver.network.server: Session registered: uid=-41
15:35:18 [INFO] gameserver.network.server: Client connected: uid=-41 remote=('192.168.178.2', 57310)
15:35:18 [INFO] gameserver.network.auth: Login success: eem (uid=2)
15:35:18 [INFO] gameserver.network.server: Session registered: uid=2
15:35:18 [INFO] gameserver.network.server: Session upgraded: guest=-41 → uid=2
15:35:24 [INFO] gameserver.network.handlers: change_citizen request from uid=2
15:35:24 [INFO] gameserver.network.handlers: change_citizen success uid=2: {'merchant': 0, 'scientist': 0, 'artist': 4, 'free': 1}
15:35:24 [INFO] gameserver.network.handlers: change_citizen request from uid=2
15:35:24 [INFO] gameserver.network.handlers: change_citizen success uid=2: {'merchant': 0, 'scientist': 0, 'artist': 3, 'free': 2}
15:35:25 [INFO] gameserver.network.handlers: change_citizen request from uid=2
15:35:25 [INFO] gameserver.network.handlers: change_citizen success uid=2: {'merchant': 1, 'scientist': 0, 'artist': 3, 'free': 1}
15:35:25 [INFO] gameserver.network.handlers: change_citizen request from uid=2
15:35:25 [INFO] gameserver.network.handlers: change_citizen success uid=2: {'merchant': 2, 'scientist': 0, 'artist': 3, 'free': 0}
15:37:04 [INFO] __main__: Shutdown signal received — stopping …
15:37:05 [INFO] __main__: Shutting down …
15:37:05 [INFO] gameserver.persistence.state_save: Game state saved to state.yaml (2 empires, 0 attacks, 0 battles)
15:37:05 [INFO] websockets.server: server closing
15:37:05 [INFO] gameserver.network.server: Session removed: uid=2
15:37:05 [INFO] websockets.server: server closed
15:37:05 [INFO] gameserver.network.server: WebSocket server stopped
15:37:05 [INFO] __main__:   WebSocket server stopped
15:37:05 [INFO] __main__:   debug dashboard stopped
15:37:05 [INFO] __main__:   database closed
15:37:05 [INFO] __main__:   goodbye
15:37:06 [INFO] __main__: === Game Server starting ===
15:37:06 [INFO] __main__: Loading configuration …
15:37:07 [INFO] __main__:   items:        210 loaded from config
15:37:07 [INFO] __main__:   map:          4 paths, 23 build tiles from config/maps/default.yaml
15:37:07 [INFO] __main__:   ai_templates: 2 entries from config/ai_templates.yaml
15:37:07 [INFO] gameserver.loaders.game_config_loader: Loaded game config from config/game.yaml (29 keys)
15:37:07 [INFO] __main__:   game_config:  loaded
15:37:07 [INFO] __main__: Initializing persistence …
15:37:07 [INFO] gameserver.persistence.database: Database connected: gameserver.db
15:37:07 [INFO] __main__:   database:     connected (gameserver.db)
15:37:07 [INFO] gameserver.persistence.state_load: Restoring state from state.yaml (saved at 2026-02-08T15:37:05, version 1)
15:37:07 [INFO] gameserver.persistence.state_load: Restored 2 empires, 0 attacks, 0 battles
15:37:07 [INFO] __main__:   state:        restored from disk (2 empires, 0 attacks)
15:37:07 [INFO] __main__: Creating services …
15:37:07 [INFO] __main__:   upgrade_provider: 210 items registered
15:37:07 [INFO] __main__:   all services created
15:37:07 [INFO] __main__: Wiring event handlers …
15:37:07 [INFO] __main__:   event handlers registered
15:37:07 [INFO] gameserver.engine.empire_service: Empire registered: uid=100 name='TestImperium'
15:37:07 [INFO] gameserver.engine.empire_service: Empire 100: recalculated effects → {}
15:37:07 [INFO] gameserver.engine.empire_service: Empire registered: uid=2 name='Empire1'
15:37:07 [INFO] gameserver.engine.empire_service: Empire 2: recalculated effects → {'gold_offset': 0.15000000000000002, 'culture_offset': 0.15000000000000002, 'culture_modifier': 0.1}
15:37:07 [INFO] __main__: Restored 2 empires from saved state
15:37:07 [INFO] __main__: Starting network server …
15:37:07 [INFO] gameserver.network.handlers: Registered 29 message handlers: summary_request, item_request, military_request, new_item, new_structure, delete_structure, upgrade_structure, citizen_upgrade, change_citizen, increase_life, new_army, new_attack_request, change_army, new_wave, change_wave, end_siege, battle_register, battle_unregister, battle_next_wave_request, notification_request, user_message, timeline_request, userinfo_request, hall_of_fame_request, preferences_request, change_preferences, auth_request, signup, create_empire
15:37:07 [INFO] websockets.server: server listening on 0.0.0.0:8765
15:37:07 [INFO] gameserver.network.server: WebSocket server listening on ws://0.0.0.0:8765
15:37:07 [INFO] __main__:   WebSocket server listening on 0.0.0.0:8765
15:37:07 [INFO] gameserver.debug.dashboard: Debug dashboard running at http://0.0.0.0:9000/
15:37:07 [INFO] __main__: Starting game loop …
15:37:07 [INFO] __main__:   game loop running (1 s tick)
15:37:08 [INFO] websockets.server: connection open
15:37:08 [INFO] gameserver.network.server: Session registered: uid=-1
15:37:08 [INFO] gameserver.network.server: Client connected: uid=-1 remote=('192.168.178.2', 55603)
15:37:08 [INFO] gameserver.network.auth: Login success: eem (uid=2)
15:37:08 [INFO] gameserver.network.server: Session registered: uid=2
15:37:08 [INFO] gameserver.network.server: Session upgraded: guest=-1 → uid=2
15:37:11 [INFO] gameserver.network.server: Session removed: uid=2
15:37:12 [INFO] websockets.server: connection open
15:37:12 [INFO] gameserver.network.server: Session registered: uid=-2
15:37:12 [INFO] gameserver.network.server: Client connected: uid=-2 remote=('192.168.178.2', 55627)
15:37:12 [INFO] gameserver.network.auth: Login success: eem (uid=2)
15:37:12 [INFO] gameserver.network.server: Session registered: uid=2
15:37:12 [INFO] gameserver.network.server: Session upgraded: guest=-2 → uid=2
15:37:15 [INFO] gameserver.network.server: Session removed: uid=2
15:37:15 [INFO] websockets.server: connection open
15:37:15 [INFO] gameserver.network.server: Session registered: uid=-3
15:37:15 [INFO] gameserver.network.server: Client connected: uid=-3 remote=('192.168.178.2', 55649)
15:37:15 [INFO] gameserver.network.auth: Login success: eem (uid=2)
15:37:15 [INFO] gameserver.network.server: Session registered: uid=2
15:37:15 [INFO] gameserver.network.server: Session upgraded: guest=-3 → uid=2
15:38:30 [INFO] gameserver.engine.empire_service: Empire 2: applied effects for TOOL_SHOP: {'build_speed_modifier': 0.1}
15:38:30 [INFO] gameserver.engine.empire_service: Empire 2: building TOOL_SHOP completed
15:39:14 [INFO] gameserver.network.server: Session removed: uid=2
15:39:14 [INFO] websockets.server: connection open
15:39:14 [INFO] gameserver.network.server: Session registered: uid=-4
15:39:14 [INFO] gameserver.network.server: Client connected: uid=-4 remote=('192.168.178.2', 60837)
15:39:14 [INFO] gameserver.network.auth: Login success: eem (uid=2)
15:39:14 [INFO] gameserver.network.server: Session registered: uid=2
15:39:14 [INFO] gameserver.network.server: Session upgraded: guest=-4 → uid=2
15:41:34 [INFO] gameserver.network.server: Session removed: uid=2
15:41:34 [INFO] websockets.server: connection open
15:41:34 [INFO] gameserver.network.server: Session registered: uid=-5
15:41:34 [INFO] gameserver.network.server: Client connected: uid=-5 remote=('192.168.178.2', 58533)
15:41:34 [INFO] gameserver.network.auth: Login success: eem (uid=2)
15:41:34 [INFO] gameserver.network.server: Session registered: uid=2
15:41:34 [INFO] gameserver.network.server: Session upgraded: guest=-5 → uid=2
15:42:03 [INFO] gameserver.network.server: Session removed: uid=2
15:42:03 [INFO] websockets.server: connection open
15:42:03 [INFO] gameserver.network.server: Session registered: uid=-6
15:42:03 [INFO] gameserver.network.server: Client connected: uid=-6 remote=('192.168.178.2', 53040)
15:42:03 [INFO] gameserver.network.auth: Login success: eem (uid=2)
15:42:03 [INFO] gameserver.network.server: Session registered: uid=2
15:42:03 [INFO] gameserver.network.server: Session upgraded: guest=-6 → uid=2
15:47:37 [INFO] __main__: Shutdown signal received — stopping …
15:47:37 [INFO] __main__: Shutting down …
15:47:37 [INFO] gameserver.persistence.state_save: Game state saved to state.yaml (2 empires, 0 attacks, 0 battles)
15:47:37 [INFO] websockets.server: server closing
15:47:37 [INFO] gameserver.network.server: Session removed: uid=2
15:47:37 [INFO] websockets.server: server closed
15:47:37 [INFO] gameserver.network.server: WebSocket server stopped
15:47:37 [INFO] __main__:   WebSocket server stopped
15:47:37 [INFO] __main__:   debug dashboard stopped
15:47:37 [INFO] __main__:   database closed
15:47:37 [INFO] __main__:   goodbye
15:47:39 [INFO] __main__: === Game Server starting ===
15:47:39 [INFO] __main__: Loading configuration …
15:47:39 [INFO] __main__:   items:        210 loaded from config
15:47:39 [INFO] __main__:   map:          4 paths, 23 build tiles from config/maps/default.yaml
15:47:39 [INFO] __main__:   ai_templates: 2 entries from config/ai_templates.yaml
15:47:39 [INFO] gameserver.loaders.game_config_loader: Loaded game config from config/game.yaml (29 keys)
15:47:39 [INFO] __main__:   game_config:  loaded
15:47:39 [INFO] __main__: Initializing persistence …
15:47:39 [INFO] gameserver.persistence.database: Database connected: gameserver.db
15:47:39 [INFO] __main__:   database:     connected (gameserver.db)
15:47:39 [INFO] gameserver.persistence.state_load: Restoring state from state.yaml (saved at 2026-02-08T15:47:37, version 1)
15:47:39 [INFO] gameserver.persistence.state_load: Restored 2 empires, 0 attacks, 0 battles
15:47:39 [INFO] __main__:   state:        restored from disk (2 empires, 0 attacks)
15:47:39 [INFO] __main__: Creating services …
15:47:39 [INFO] __main__:   upgrade_provider: 210 items registered
15:47:39 [INFO] __main__:   all services created
15:47:39 [INFO] __main__: Wiring event handlers …
15:47:39 [INFO] __main__:   event handlers registered
15:47:39 [INFO] gameserver.engine.empire_service: Empire registered: uid=100 name='TestImperium'
15:47:39 [INFO] gameserver.engine.empire_service: Empire 100: recalculated effects → {}
15:47:39 [INFO] gameserver.engine.empire_service: Empire registered: uid=2 name='Empire1'
15:47:39 [INFO] gameserver.engine.empire_service: Empire 2: recalculated effects → {'gold_offset': 0.15000000000000002, 'culture_offset': 0.15000000000000002, 'culture_modifier': 0.1, 'build_speed_modifier': 0.1}
15:47:39 [INFO] __main__: Restored 2 empires from saved state
15:47:39 [INFO] __main__: Starting network server …
15:47:39 [INFO] gameserver.network.handlers: Registered 29 message handlers: summary_request, item_request, military_request, new_item, new_structure, delete_structure, upgrade_structure, citizen_upgrade, change_citizen, increase_life, new_army, new_attack_request, change_army, new_wave, change_wave, end_siege, battle_register, battle_unregister, battle_next_wave_request, notification_request, user_message, timeline_request, userinfo_request, hall_of_fame_request, preferences_request, change_preferences, auth_request, signup, create_empire
15:47:39 [INFO] websockets.server: server listening on 0.0.0.0:8765
15:47:39 [INFO] gameserver.network.server: WebSocket server listening on ws://0.0.0.0:8765
15:47:39 [INFO] __main__:   WebSocket server listening on 0.0.0.0:8765
15:47:39 [INFO] gameserver.debug.dashboard: Debug dashboard running at http://0.0.0.0:9000/
15:47:39 [INFO] __main__: Starting game loop …
15:47:39 [INFO] __main__:   game loop running (1 s tick)
15:47:40 [INFO] websockets.server: connection open
15:47:40 [INFO] gameserver.network.server: Session registered: uid=-1
15:47:40 [INFO] gameserver.network.server: Client connected: uid=-1 remote=('192.168.178.2', 52778)
15:47:40 [INFO] gameserver.network.auth: Login success: eem (uid=2)
15:47:40 [INFO] gameserver.network.server: Session registered: uid=2
15:47:40 [INFO] gameserver.network.server: Session upgraded: guest=-1 → uid=2
15:52:01 [INFO] __main__: Shutdown signal received — stopping …
15:52:02 [INFO] __main__: Shutting down …
15:52:02 [INFO] gameserver.persistence.state_save: Game state saved to state.yaml (2 empires, 0 attacks, 0 battles)
15:52:02 [INFO] websockets.server: server closing
15:52:02 [INFO] gameserver.network.server: Session removed: uid=2
15:52:02 [INFO] websockets.server: server closed
15:52:02 [INFO] gameserver.network.server: WebSocket server stopped
15:52:02 [INFO] __main__:   WebSocket server stopped
15:52:02 [INFO] __main__:   debug dashboard stopped
15:52:02 [INFO] __main__:   database closed
15:52:02 [INFO] __main__:   goodbye
15:52:03 [INFO] __main__: === Game Server starting ===
15:52:03 [INFO] __main__: Loading configuration …
15:52:04 [INFO] __main__:   items:        210 loaded from config
15:52:04 [INFO] __main__:   map:          4 paths, 23 build tiles from config/maps/default.yaml
15:52:04 [INFO] __main__:   ai_templates: 2 entries from config/ai_templates.yaml
15:52:04 [INFO] gameserver.loaders.game_config_loader: Loaded game config from config/game.yaml (29 keys)
15:52:04 [INFO] __main__:   game_config:  loaded
15:52:04 [INFO] __main__: Initializing persistence …
15:52:04 [INFO] gameserver.persistence.database: Database connected: gameserver.db
15:52:04 [INFO] __main__:   database:     connected (gameserver.db)
15:52:04 [INFO] gameserver.persistence.state_load: Restoring state from state.yaml (saved at 2026-02-08T15:52:02, version 1)
15:52:04 [INFO] gameserver.persistence.state_load: Restored 2 empires, 0 attacks, 0 battles
15:52:04 [INFO] __main__:   state:        restored from disk (2 empires, 0 attacks)
15:52:04 [INFO] __main__: Creating services …
15:52:04 [INFO] __main__:   upgrade_provider: 210 items registered
15:52:04 [INFO] __main__:   all services created
15:52:04 [INFO] __main__: Wiring event handlers …
15:52:04 [INFO] __main__:   event handlers registered
15:52:04 [INFO] gameserver.engine.empire_service: Empire registered: uid=100 name='TestImperium'
15:52:04 [INFO] gameserver.engine.empire_service: Empire 100: recalculated effects → {}
15:52:04 [INFO] gameserver.engine.empire_service: Empire registered: uid=2 name='Empire1'
15:52:04 [INFO] gameserver.engine.empire_service: Empire 2: recalculated effects → {'gold_offset': 0.15000000000000002, 'culture_offset': 0.15000000000000002, 'culture_modifier': 0.1, 'build_speed_modifier': 0.1}
15:52:04 [INFO] __main__: Restored 2 empires from saved state
15:52:04 [INFO] __main__: Starting network server …
15:52:04 [INFO] gameserver.network.handlers: Registered 29 message handlers: summary_request, item_request, military_request, new_item, new_structure, delete_structure, upgrade_structure, citizen_upgrade, change_citizen, increase_life, new_army, new_attack_request, change_army, new_wave, change_wave, end_siege, battle_register, battle_unregister, battle_next_wave_request, notification_request, user_message, timeline_request, userinfo_request, hall_of_fame_request, preferences_request, change_preferences, auth_request, signup, create_empire
15:52:04 [INFO] websockets.server: server listening on 0.0.0.0:8765
15:52:04 [INFO] gameserver.network.server: WebSocket server listening on ws://0.0.0.0:8765
15:52:04 [INFO] __main__:   WebSocket server listening on 0.0.0.0:8765
15:52:04 [INFO] gameserver.debug.dashboard: Debug dashboard running at http://0.0.0.0:9000/
15:52:04 [INFO] __main__: Starting game loop …
15:52:04 [INFO] __main__:   game loop running (1 s tick)
15:52:05 [INFO] websockets.server: connection open
15:52:05 [INFO] gameserver.network.server: Session registered: uid=-1
15:52:05 [INFO] gameserver.network.server: Client connected: uid=-1 remote=('192.168.178.2', 53549)
15:52:05 [INFO] gameserver.network.auth: Login success: eem (uid=2)
15:52:05 [INFO] gameserver.network.server: Session registered: uid=2
15:52:05 [INFO] gameserver.network.server: Session upgraded: guest=-1 → uid=2
15:52:07 [INFO] gameserver.network.server: Session removed: uid=2
15:52:07 [INFO] websockets.server: connection open
15:52:07 [INFO] gameserver.network.server: Session registered: uid=-2
15:52:07 [INFO] gameserver.network.server: Client connected: uid=-2 remote=('192.168.178.2', 53563)
15:52:07 [INFO] gameserver.network.auth: Login success: eem (uid=2)
15:52:07 [INFO] gameserver.network.server: Session registered: uid=2
15:52:07 [INFO] gameserver.network.server: Session upgraded: guest=-2 → uid=2
15:52:12 [INFO] gameserver.network.server: Session removed: uid=2
15:52:12 [INFO] websockets.server: connection open
15:52:12 [INFO] gameserver.network.server: Session registered: uid=-3
15:52:12 [INFO] gameserver.network.server: Client connected: uid=-3 remote=('192.168.178.2', 53567)
15:52:12 [INFO] gameserver.network.auth: Login success: eem (uid=2)
15:52:12 [INFO] gameserver.network.server: Session registered: uid=2
15:52:12 [INFO] gameserver.network.server: Session upgraded: guest=-3 → uid=2
15:52:16 [INFO] gameserver.network.handlers: citizen_upgrade request from uid=2
15:52:16 [INFO] gameserver.network.handlers: citizen_upgrade success uid=2
15:52:19 [INFO] gameserver.network.handlers: citizen_upgrade request from uid=2
15:52:19 [INFO] gameserver.network.handlers: citizen_upgrade failed uid=2: Not enough culture (need 925.0, have 634.6)
15:52:25 [INFO] gameserver.network.handlers: change_citizen request from uid=2
15:52:25 [INFO] gameserver.network.handlers: change_citizen success uid=2: {'merchant': 2, 'scientist': 1, 'artist': 3, 'free': 0}
15:52:55 [INFO] gameserver.engine.empire_service: Empire 2: started building EXCHANGE_POST (effort=1500.0)
15:52:55 [INFO] gameserver.network.handlers: new_item success uid=2 iid=EXCHANGE_POST
15:57:21 [INFO] gameserver.network.server: Session removed: uid=2
15:57:21 [INFO] websockets.server: connection open
15:57:21 [INFO] gameserver.network.server: Session registered: uid=-4
15:57:21 [INFO] gameserver.network.server: Client connected: uid=-4 remote=('192.168.178.2', 58206)
15:57:21 [INFO] gameserver.network.auth: Login success: eem (uid=2)
15:57:21 [INFO] gameserver.network.server: Session registered: uid=2
15:57:21 [INFO] gameserver.network.server: Session upgraded: guest=-4 → uid=2
16:00:03 [INFO] gameserver.network.handlers: citizen_upgrade request from uid=2
16:00:03 [INFO] gameserver.network.handlers: citizen_upgrade failed uid=2: Not enough culture (need 925.0, have 717.6)
16:00:08 [INFO] gameserver.network.handlers: change_citizen request from uid=2
16:00:08 [INFO] gameserver.network.handlers: change_citizen success uid=2: {'merchant': 2, 'scientist': 0, 'artist': 3, 'free': 1}
16:00:08 [INFO] gameserver.network.handlers: change_citizen request from uid=2
16:00:08 [INFO] gameserver.network.handlers: change_citizen success uid=2: {'merchant': 1, 'scientist': 0, 'artist': 3, 'free': 2}
16:00:09 [INFO] gameserver.network.handlers: change_citizen request from uid=2
16:00:09 [INFO] gameserver.network.handlers: change_citizen success uid=2: {'merchant': 0, 'scientist': 0, 'artist': 3, 'free': 3}
16:00:09 [INFO] gameserver.network.handlers: change_citizen request from uid=2
16:00:09 [INFO] gameserver.network.handlers: change_citizen success uid=2: {'merchant': 0, 'scientist': 0, 'artist': 4, 'free': 2}
16:00:09 [INFO] gameserver.network.handlers: change_citizen request from uid=2
16:00:09 [INFO] gameserver.network.handlers: change_citizen success uid=2: {'merchant': 0, 'scientist': 0, 'artist': 5, 'free': 1}
16:00:09 [INFO] gameserver.network.handlers: change_citizen request from uid=2
16:00:09 [INFO] gameserver.network.handlers: change_citizen success uid=2: {'merchant': 0, 'scientist': 0, 'artist': 6, 'free': 0}
16:00:09 [INFO] gameserver.network.handlers: change_citizen request from uid=2
16:00:09 [INFO] gameserver.network.handlers: change_citizen failed uid=2: Too many citizens assigned (max 6, got 7)
16:00:13 [INFO] gameserver.network.handlers: change_citizen request from uid=2
16:00:13 [INFO] gameserver.network.handlers: change_citizen success uid=2: {'merchant': 0, 'scientist': 0, 'artist': 5, 'free': 1}
16:00:13 [INFO] gameserver.network.handlers: change_citizen request from uid=2
16:00:13 [INFO] gameserver.network.handlers: change_citizen success uid=2: {'merchant': 0, 'scientist': 0, 'artist': 4, 'free': 2}
16:00:13 [INFO] gameserver.network.handlers: change_citizen request from uid=2
16:00:13 [INFO] gameserver.network.handlers: change_citizen success uid=2: {'merchant': 0, 'scientist': 0, 'artist': 3, 'free': 3}
16:00:14 [INFO] gameserver.network.handlers: change_citizen request from uid=2
16:00:14 [INFO] gameserver.network.handlers: change_citizen success uid=2: {'merchant': 0, 'scientist': 0, 'artist': 4, 'free': 2}
16:00:14 [INFO] gameserver.network.handlers: change_citizen request from uid=2
16:00:14 [INFO] gameserver.network.handlers: change_citizen success uid=2: {'merchant': 0, 'scientist': 0, 'artist': 5, 'free': 1}
16:00:15 [INFO] gameserver.network.handlers: change_citizen request from uid=2
16:00:15 [INFO] gameserver.network.handlers: change_citizen success uid=2: {'merchant': 0, 'scientist': 0, 'artist': 6, 'free': 0}
16:00:15 [INFO] gameserver.network.handlers: change_citizen request from uid=2
16:00:15 [INFO] gameserver.network.handlers: change_citizen failed uid=2: Too many citizens assigned (max 6, got 7)
16:00:15 [INFO] gameserver.network.handlers: change_citizen request from uid=2
16:00:15 [INFO] gameserver.network.handlers: change_citizen failed uid=2: Too many citizens assigned (max 6, got 7)
16:00:15 [INFO] gameserver.network.handlers: change_citizen request from uid=2
16:00:15 [INFO] gameserver.network.handlers: change_citizen failed uid=2: Too many citizens assigned (max 6, got 7)
16:00:15 [INFO] gameserver.network.handlers: change_citizen request from uid=2
16:00:15 [INFO] gameserver.network.handlers: change_citizen failed uid=2: Too many citizens assigned (max 6, got 7)
16:00:23 [INFO] gameserver.network.handlers: change_citizen request from uid=2
16:00:23 [INFO] gameserver.network.handlers: change_citizen success uid=2: {'merchant': 0, 'scientist': 0, 'artist': 5, 'free': 1}
16:00:23 [INFO] gameserver.network.handlers: change_citizen request from uid=2
16:00:23 [INFO] gameserver.network.handlers: change_citizen success uid=2: {'merchant': 0, 'scientist': 0, 'artist': 4, 'free': 2}
16:00:23 [INFO] gameserver.network.handlers: change_citizen request from uid=2
16:00:23 [INFO] gameserver.network.handlers: change_citizen success uid=2: {'merchant': 0, 'scientist': 0, 'artist': 3, 'free': 3}
16:00:23 [INFO] gameserver.network.handlers: change_citizen request from uid=2
16:00:23 [INFO] gameserver.network.handlers: change_citizen success uid=2: {'merchant': 0, 'scientist': 0, 'artist': 2, 'free': 4}
16:00:23 [INFO] gameserver.network.handlers: change_citizen request from uid=2
16:00:23 [INFO] gameserver.network.handlers: change_citizen success uid=2: {'merchant': 0, 'scientist': 0, 'artist': 1, 'free': 5}
16:00:23 [INFO] gameserver.network.handlers: change_citizen request from uid=2
16:00:23 [INFO] gameserver.network.handlers: change_citizen success uid=2: {'merchant': 0, 'scientist': 0, 'artist': 0, 'free': 6}
16:00:26 [INFO] gameserver.network.handlers: change_citizen request from uid=2
16:00:26 [INFO] gameserver.network.handlers: change_citizen success uid=2: {'merchant': 0, 'scientist': 0, 'artist': 1, 'free': 5}
16:00:26 [INFO] gameserver.network.handlers: change_citizen request from uid=2
16:00:26 [INFO] gameserver.network.handlers: change_citizen success uid=2: {'merchant': 0, 'scientist': 0, 'artist': 2, 'free': 4}
16:00:26 [INFO] gameserver.network.handlers: change_citizen request from uid=2
16:00:26 [INFO] gameserver.network.handlers: change_citizen success uid=2: {'merchant': 0, 'scientist': 0, 'artist': 3, 'free': 3}
16:00:26 [INFO] gameserver.network.handlers: change_citizen request from uid=2
16:00:26 [INFO] gameserver.network.handlers: change_citizen success uid=2: {'merchant': 0, 'scientist': 0, 'artist': 4, 'free': 2}
16:00:27 [INFO] gameserver.network.handlers: change_citizen request from uid=2
16:00:27 [INFO] gameserver.network.handlers: change_citizen success uid=2: {'merchant': 0, 'scientist': 0, 'artist': 5, 'free': 1}
16:00:27 [INFO] gameserver.network.handlers: change_citizen request from uid=2
16:00:27 [INFO] gameserver.network.handlers: change_citizen success uid=2: {'merchant': 0, 'scientist': 0, 'artist': 6, 'free': 0}
16:00:27 [INFO] gameserver.network.handlers: change_citizen request from uid=2
16:00:27 [INFO] gameserver.network.handlers: change_citizen failed uid=2: Too many citizens assigned (max 6, got 7)
16:00:27 [INFO] gameserver.network.handlers: change_citizen request from uid=2
16:00:27 [INFO] gameserver.network.handlers: change_citizen failed uid=2: Too many citizens assigned (max 6, got 7)
16:00:27 [INFO] gameserver.network.handlers: change_citizen request from uid=2
16:00:27 [INFO] gameserver.network.handlers: change_citizen failed uid=2: Too many citizens assigned (max 6, got 7)
16:00:27 [INFO] gameserver.network.handlers: change_citizen request from uid=2
16:00:27 [INFO] gameserver.network.handlers: change_citizen failed uid=2: Too many citizens assigned (max 6, got 7)
16:05:13 [INFO] __main__: Shutdown signal received — stopping …
16:05:13 [INFO] __main__: Shutting down …
16:05:13 [INFO] gameserver.persistence.state_save: Game state saved to state.yaml (2 empires, 0 attacks, 0 battles)
16:05:13 [INFO] websockets.server: server closing
16:05:13 [INFO] gameserver.network.server: Session removed: uid=2
16:05:13 [INFO] websockets.server: server closed
16:05:13 [INFO] gameserver.network.server: WebSocket server stopped
16:05:13 [INFO] __main__:   WebSocket server stopped
16:05:13 [INFO] __main__:   debug dashboard stopped
16:05:13 [INFO] __main__:   database closed
16:05:13 [INFO] __main__:   goodbye
16:05:14 [INFO] __main__: === Game Server starting ===
16:05:14 [INFO] __main__: Loading configuration …
16:05:15 [INFO] __main__:   items:        210 loaded from config
16:05:15 [INFO] __main__:   map:          4 paths, 23 build tiles from config/maps/default.yaml
16:05:15 [INFO] __main__:   ai_templates: 2 entries from config/ai_templates.yaml
16:05:15 [INFO] gameserver.loaders.game_config_loader: Loaded game config from config/game.yaml (29 keys)
16:05:15 [INFO] __main__:   game_config:  loaded
16:05:15 [INFO] __main__: Initializing persistence …
16:05:15 [INFO] gameserver.persistence.database: Database connected: gameserver.db
16:05:15 [INFO] __main__:   database:     connected (gameserver.db)
16:05:15 [INFO] gameserver.persistence.state_load: Restoring state from state.yaml (saved at 2026-02-08T16:05:13, version 1)
16:05:15 [INFO] gameserver.persistence.state_load: Restored 2 empires, 0 attacks, 0 battles
16:05:15 [INFO] __main__:   state:        restored from disk (2 empires, 0 attacks)
16:05:15 [INFO] __main__: Creating services …
16:05:15 [INFO] __main__:   upgrade_provider: 210 items registered
16:05:15 [INFO] __main__:   all services created
16:05:15 [INFO] __main__: Wiring event handlers …
16:05:15 [INFO] __main__:   event handlers registered
16:05:15 [INFO] gameserver.engine.empire_service: Empire registered: uid=100 name='TestImperium'
16:05:15 [INFO] gameserver.engine.empire_service: Empire 100: recalculated effects → {}
16:05:15 [INFO] gameserver.engine.empire_service: Empire registered: uid=2 name='Empire1'
16:05:15 [INFO] gameserver.engine.empire_service: Empire 2: recalculated effects → {'gold_offset': 0.15000000000000002, 'culture_offset': 0.15000000000000002, 'culture_modifier': 0.1, 'build_speed_modifier': 0.1}
16:05:15 [INFO] __main__: Restored 2 empires from saved state
16:05:15 [INFO] __main__: Starting network server …
16:05:15 [INFO] gameserver.network.handlers: Registered 29 message handlers: summary_request, item_request, military_request, new_item, new_structure, delete_structure, upgrade_structure, citizen_upgrade, change_citizen, increase_life, new_army, new_attack_request, change_army, new_wave, change_wave, end_siege, battle_register, battle_unregister, battle_next_wave_request, notification_request, user_message, timeline_request, userinfo_request, hall_of_fame_request, preferences_request, change_preferences, auth_request, signup, create_empire
16:05:15 [INFO] websockets.server: server listening on 0.0.0.0:8765
16:05:15 [INFO] gameserver.network.server: WebSocket server listening on ws://0.0.0.0:8765
16:05:15 [INFO] __main__:   WebSocket server listening on 0.0.0.0:8765
16:05:15 [INFO] gameserver.debug.dashboard: Debug dashboard running at http://0.0.0.0:9000/
16:05:15 [INFO] __main__: Starting game loop …
16:05:15 [INFO] __main__:   game loop running (1 s tick)
16:05:16 [INFO] websockets.server: connection open
16:05:16 [INFO] gameserver.network.server: Session registered: uid=-1
16:05:16 [INFO] gameserver.network.server: Client connected: uid=-1 remote=('192.168.178.2', 65344)
16:05:16 [INFO] gameserver.network.auth: Login success: eem (uid=2)
16:05:16 [INFO] gameserver.network.server: Session registered: uid=2
16:05:16 [INFO] gameserver.network.server: Session upgraded: guest=-1 → uid=2
16:05:17 [INFO] gameserver.network.server: Session removed: uid=2
16:05:17 [INFO] websockets.server: connection open
16:05:17 [INFO] gameserver.network.server: Session registered: uid=-2
16:05:17 [INFO] gameserver.network.server: Client connected: uid=-2 remote=('192.168.178.2', 65357)
16:05:17 [INFO] gameserver.network.auth: Login success: eem (uid=2)
16:05:17 [INFO] gameserver.network.server: Session registered: uid=2
16:05:17 [INFO] gameserver.network.server: Session upgraded: guest=-2 → uid=2
16:08:42 [INFO] gameserver.network.server: Session removed: uid=2
16:08:43 [INFO] websockets.server: connection open
16:08:43 [INFO] gameserver.network.server: Session registered: uid=-3
16:08:43 [INFO] gameserver.network.server: Client connected: uid=-3 remote=('192.168.178.2', 56507)
16:08:43 [INFO] gameserver.network.auth: Login success: eem (uid=2)
16:08:43 [INFO] gameserver.network.server: Session registered: uid=2
16:08:43 [INFO] gameserver.network.server: Session upgraded: guest=-3 → uid=2
16:08:58 [INFO] gameserver.engine.empire_service: Empire 2: started building BOW_MAKER (effort=2500.0)
16:08:58 [INFO] gameserver.network.handlers: new_item success uid=2 iid=BOW_MAKER
16:14:22 [INFO] gameserver.network.handlers: change_citizen request from uid=2
16:14:22 [INFO] gameserver.network.handlers: change_citizen success uid=2: {'merchant': 0, 'scientist': 0, 'artist': 5, 'free': 1}
16:14:22 [INFO] gameserver.network.handlers: change_citizen request from uid=2
16:14:22 [INFO] gameserver.network.handlers: change_citizen success uid=2: {'merchant': 0, 'scientist': 0, 'artist': 4, 'free': 2}
16:14:22 [INFO] gameserver.network.handlers: change_citizen request from uid=2
16:14:22 [INFO] gameserver.network.handlers: change_citizen success uid=2: {'merchant': 0, 'scientist': 0, 'artist': 3, 'free': 3}
16:14:22 [INFO] gameserver.network.handlers: change_citizen request from uid=2
16:14:22 [INFO] gameserver.network.handlers: change_citizen success uid=2: {'merchant': 0, 'scientist': 0, 'artist': 2, 'free': 4}
16:14:23 [INFO] gameserver.network.handlers: change_citizen request from uid=2
16:14:23 [INFO] gameserver.network.handlers: change_citizen success uid=2: {'merchant': 0, 'scientist': 0, 'artist': 1, 'free': 5}
16:14:23 [INFO] gameserver.network.handlers: change_citizen request from uid=2
16:14:23 [INFO] gameserver.network.handlers: change_citizen success uid=2: {'merchant': 0, 'scientist': 0, 'artist': 0, 'free': 6}
16:17:24 [INFO] __main__: Shutdown signal received — stopping …
16:17:25 [INFO] __main__: Shutting down …
16:17:25 [INFO] gameserver.persistence.state_save: Game state saved to state.yaml (2 empires, 0 attacks, 0 battles)
16:17:25 [INFO] websockets.server: server closing
16:17:25 [INFO] gameserver.network.server: Session removed: uid=2
16:17:25 [INFO] websockets.server: server closed
16:17:25 [INFO] gameserver.network.server: WebSocket server stopped
16:17:25 [INFO] __main__:   WebSocket server stopped
16:17:25 [INFO] __main__:   debug dashboard stopped
16:17:25 [INFO] __main__:   database closed
16:17:25 [INFO] __main__:   goodbye
16:17:39 [INFO] __main__: === Game Server starting ===
16:17:39 [INFO] __main__: Loading configuration …
16:17:40 [INFO] __main__:   items:        210 loaded from config
16:17:40 [INFO] __main__:   map:          4 paths, 23 build tiles from config/maps/default.yaml
16:17:40 [INFO] __main__:   ai_templates: 2 entries from config/ai_templates.yaml
16:17:40 [INFO] gameserver.loaders.game_config_loader: Loaded game config from config/game.yaml (29 keys)
16:17:40 [INFO] __main__:   game_config:  loaded
16:17:40 [INFO] __main__: Initializing persistence …
16:17:40 [INFO] gameserver.persistence.database: Database connected: gameserver.db
16:17:40 [INFO] __main__:   database:     connected (gameserver.db)
16:17:40 [INFO] gameserver.persistence.state_load: Restoring state from state.yaml (saved at 2026-02-08T16:17:25, version 1)
16:17:40 [INFO] gameserver.persistence.state_load: Restored 2 empires, 0 attacks, 0 battles
16:17:40 [INFO] __main__:   state:        restored from disk (2 empires, 0 attacks)
16:17:40 [INFO] __main__: Creating services …
16:17:40 [INFO] __main__:   upgrade_provider: 210 items registered
16:17:40 [INFO] __main__:   all services created
16:17:40 [INFO] __main__: Wiring event handlers …
16:17:40 [INFO] __main__:   event handlers registered
16:17:40 [INFO] gameserver.engine.empire_service: Empire registered: uid=100 name='TestImperium'
16:17:40 [INFO] gameserver.engine.empire_service: Empire 100: recalculated effects → {}
16:17:40 [INFO] gameserver.engine.empire_service: Empire registered: uid=2 name='Empire1'
Traceback (most recent call last):
  File "/usr/lib/python3.9/runpy.py", line 197, in _run_module_as_main
    return _run_code(code, main_globals, None,
  File "/usr/lib/python3.9/runpy.py", line 87, in _run_code
    exec(code, run_globals)
  File "/home/pi/e3/python_server/src/gameserver/main.py", line 426, in <module>
    main()
  File "/home/pi/e3/python_server/src/gameserver/main.py", line 422, in main
    asyncio.run(_start())
  File "/usr/lib/python3.9/asyncio/runners.py", line 44, in run
    return loop.run_until_complete(main)
  File "/usr/lib/python3.9/asyncio/base_events.py", line 642, in run_until_complete
    return future.result()
  File "/home/pi/e3/python_server/src/gameserver/main.py", line 385, in _start
    services.empire_service.recalculate_effects(empire)
  File "/home/pi/e3/python_server/src/gameserver/engine/empire_service.py", line 178, in recalculate_effects
    effects = self._upgrades.get_effects(iid)
  File "/home/pi/e3/python_server/src/gameserver/engine/upgrade_provider.py", line 49, in get_effects
    return dict(item.effects) if item else {}
TypeError: 'NoneType' object is not iterable
16:18:33 [INFO] __main__: === Game Server starting ===
16:18:33 [INFO] __main__: Loading configuration …
16:18:33 [INFO] __main__:   items:        210 loaded from config
16:18:33 [INFO] __main__:   map:          4 paths, 23 build tiles from config/maps/default.yaml
16:18:33 [INFO] __main__:   ai_templates: 2 entries from config/ai_templates.yaml
16:18:33 [INFO] gameserver.loaders.game_config_loader: Loaded game config from config/game.yaml (29 keys)
16:18:33 [INFO] __main__:   game_config:  loaded
16:18:33 [INFO] __main__: Initializing persistence …
16:18:33 [INFO] gameserver.persistence.database: Database connected: gameserver.db
16:18:33 [INFO] __main__:   database:     connected (gameserver.db)
16:18:33 [INFO] gameserver.persistence.state_load: Restoring state from state.yaml (saved at 2026-02-08T16:17:25, version 1)
16:18:33 [INFO] gameserver.persistence.state_load: Restored 2 empires, 0 attacks, 0 battles
16:18:33 [INFO] __main__:   state:        restored from disk (2 empires, 0 attacks)
16:18:33 [INFO] __main__: Creating services …
16:18:33 [INFO] __main__:   upgrade_provider: 210 items registered
16:18:33 [INFO] __main__:   all services created
16:18:33 [INFO] __main__: Wiring event handlers …
16:18:33 [INFO] __main__:   event handlers registered
16:18:33 [INFO] gameserver.engine.empire_service: Empire registered: uid=100 name='TestImperium'
16:18:33 [INFO] gameserver.engine.empire_service: Empire 100: recalculated effects → {}
16:18:33 [INFO] gameserver.engine.empire_service: Empire registered: uid=2 name='Empire1'
Traceback (most recent call last):
  File "/usr/lib/python3.9/runpy.py", line 197, in _run_module_as_main
    return _run_code(code, main_globals, None,
  File "/usr/lib/python3.9/runpy.py", line 87, in _run_code
    exec(code, run_globals)
  File "/home/pi/e3/python_server/src/gameserver/main.py", line 426, in <module>
    main()
  File "/home/pi/e3/python_server/src/gameserver/main.py", line 422, in main
    asyncio.run(_start())
  File "/usr/lib/python3.9/asyncio/runners.py", line 44, in run
    return loop.run_until_complete(main)
  File "/usr/lib/python3.9/asyncio/base_events.py", line 642, in run_until_complete
    return future.result()
  File "/home/pi/e3/python_server/src/gameserver/main.py", line 385, in _start
    services.empire_service.recalculate_effects(empire)
  File "/home/pi/e3/python_server/src/gameserver/engine/empire_service.py", line 178, in recalculate_effects
    effects = self._upgrades.get_effects(iid)
  File "/home/pi/e3/python_server/src/gameserver/engine/upgrade_provider.py", line 49, in get_effects
    return dict(item.effects) if item else {}
TypeError: 'NoneType' object is not iterable
16:19:58 [INFO] __main__: === Game Server starting ===
16:19:58 [INFO] __main__: Loading configuration …
16:19:58 [INFO] __main__:   items:        210 loaded from config
16:19:58 [INFO] __main__:   map:          4 paths, 23 build tiles from config/maps/default.yaml
16:19:58 [INFO] __main__:   ai_templates: 2 entries from config/ai_templates.yaml
16:19:58 [INFO] gameserver.loaders.game_config_loader: Loaded game config from config/game.yaml (29 keys)
16:19:58 [INFO] __main__:   game_config:  loaded
16:19:58 [INFO] __main__: Initializing persistence …
16:19:58 [INFO] gameserver.persistence.database: Database connected: gameserver.db
16:19:58 [INFO] __main__:   database:     connected (gameserver.db)
16:19:58 [INFO] gameserver.persistence.state_load: Restoring state from state.yaml (saved at 2026-02-08T16:17:25, version 1)
16:19:58 [INFO] gameserver.persistence.state_load: Restored 2 empires, 0 attacks, 0 battles
16:19:58 [INFO] __main__:   state:        restored from disk (2 empires, 0 attacks)
16:19:58 [INFO] __main__: Creating services …
16:19:58 [INFO] __main__:   upgrade_provider: 210 items registered
16:19:58 [INFO] __main__:   all services created
16:19:58 [INFO] __main__: Wiring event handlers …
16:19:58 [INFO] __main__:   event handlers registered
16:19:58 [INFO] gameserver.engine.empire_service: Empire registered: uid=100 name='TestImperium'
16:19:58 [INFO] gameserver.engine.empire_service: Empire 100: recalculated effects → {}
16:19:58 [INFO] gameserver.engine.empire_service: Empire registered: uid=2 name='Empire1'
16:19:58 [INFO] gameserver.engine.empire_service: Empire 2: recalculated effects → {'gold_offset': 0.05, 'culture_offset': 0.15000000000000002, 'culture_modifier': 0.1, 'build_speed_modifier': 0.1}
16:19:58 [INFO] __main__: Restored 2 empires from saved state
16:19:58 [INFO] __main__: Starting network server …
16:19:58 [INFO] gameserver.network.handlers: Registered 29 message handlers: summary_request, item_request, military_request, new_item, new_structure, delete_structure, upgrade_structure, citizen_upgrade, change_citizen, increase_life, new_army, new_attack_request, change_army, new_wave, change_wave, end_siege, battle_register, battle_unregister, battle_next_wave_request, notification_request, user_message, timeline_request, userinfo_request, hall_of_fame_request, preferences_request, change_preferences, auth_request, signup, create_empire
16:19:58 [INFO] websockets.server: server listening on 0.0.0.0:8765
16:19:58 [INFO] gameserver.network.server: WebSocket server listening on ws://0.0.0.0:8765
16:19:58 [INFO] __main__:   WebSocket server listening on 0.0.0.0:8765
16:19:58 [INFO] gameserver.debug.dashboard: Debug dashboard running at http://0.0.0.0:9000/
16:19:58 [INFO] __main__: Starting game loop …
16:19:58 [INFO] __main__:   game loop running (1 s tick)
16:20:14 [INFO] websockets.server: connection open
16:20:14 [INFO] gameserver.network.server: Session registered: uid=-1
16:20:14 [INFO] gameserver.network.server: Client connected: uid=-1 remote=('192.168.178.2', 59089)
16:20:14 [INFO] gameserver.network.auth: Login success: eem (uid=2)
16:20:14 [INFO] gameserver.network.server: Session registered: uid=2
16:20:14 [INFO] gameserver.network.server: Session upgraded: guest=-1 → uid=2
16:20:36 [INFO] __main__: Shutdown signal received — stopping …
16:20:36 [INFO] __main__: Shutting down …
16:20:37 [INFO] gameserver.persistence.state_save: Game state saved to state.yaml (2 empires, 0 attacks, 0 battles)
16:20:37 [INFO] websockets.server: server closing
16:20:37 [INFO] gameserver.network.server: Session removed: uid=2
16:20:37 [INFO] websockets.server: server closed
16:20:37 [INFO] gameserver.network.server: WebSocket server stopped
16:20:37 [INFO] __main__:   WebSocket server stopped
16:20:37 [INFO] __main__:   debug dashboard stopped
16:20:37 [INFO] __main__:   database closed
16:20:37 [INFO] __main__:   goodbye
16:20:38 [INFO] __main__: === Game Server starting ===
16:20:38 [INFO] __main__: Loading configuration …
16:20:38 [INFO] __main__:   items:        210 loaded from config
16:20:38 [INFO] __main__:   map:          4 paths, 23 build tiles from config/maps/default.yaml
16:20:38 [INFO] __main__:   ai_templates: 2 entries from config/ai_templates.yaml
16:20:38 [INFO] gameserver.loaders.game_config_loader: Loaded game config from config/game.yaml (29 keys)
16:20:38 [INFO] __main__:   game_config:  loaded
16:20:38 [INFO] __main__: Initializing persistence …
16:20:38 [INFO] gameserver.persistence.database: Database connected: gameserver.db
16:20:38 [INFO] __main__:   database:     connected (gameserver.db)
16:20:38 [INFO] gameserver.persistence.state_load: Restoring state from state.yaml (saved at 2026-02-08T16:20:36, version 1)
16:20:38 [INFO] gameserver.persistence.state_load: Restored 2 empires, 0 attacks, 0 battles
16:20:38 [INFO] __main__:   state:        restored from disk (2 empires, 0 attacks)
16:20:38 [INFO] __main__: Creating services …
16:20:38 [INFO] __main__:   upgrade_provider: 210 items registered
16:20:38 [INFO] __main__:   all services created
16:20:38 [INFO] __main__: Wiring event handlers …
16:20:38 [INFO] __main__:   event handlers registered
16:20:38 [INFO] gameserver.engine.empire_service: Empire registered: uid=100 name='TestImperium'
16:20:38 [INFO] gameserver.engine.empire_service: Empire 100: recalculated effects → {}
16:20:38 [INFO] gameserver.engine.empire_service: Empire registered: uid=2 name='Empire1'
16:20:38 [INFO] gameserver.engine.empire_service: Empire 2: recalculated effects → {'gold_offset': 0.05, 'culture_offset': 0.15000000000000002, 'culture_modifier': 0.1, 'build_speed_modifier': 0.1}
16:20:38 [INFO] __main__: Restored 2 empires from saved state
16:20:38 [INFO] __main__: Starting network server …
16:20:38 [INFO] gameserver.network.handlers: Registered 29 message handlers: summary_request, item_request, military_request, new_item, new_structure, delete_structure, upgrade_structure, citizen_upgrade, change_citizen, increase_life, new_army, new_attack_request, change_army, new_wave, change_wave, end_siege, battle_register, battle_unregister, battle_next_wave_request, notification_request, user_message, timeline_request, userinfo_request, hall_of_fame_request, preferences_request, change_preferences, auth_request, signup, create_empire
16:20:38 [INFO] websockets.server: server listening on 0.0.0.0:8765
16:20:38 [INFO] gameserver.network.server: WebSocket server listening on ws://0.0.0.0:8765
16:20:38 [INFO] __main__:   WebSocket server listening on 0.0.0.0:8765
16:20:38 [INFO] gameserver.debug.dashboard: Debug dashboard running at http://0.0.0.0:9000/
16:20:38 [INFO] __main__: Starting game loop …
16:20:38 [INFO] __main__:   game loop running (1 s tick)
16:20:40 [INFO] websockets.server: connection open
16:20:40 [INFO] gameserver.network.server: Session registered: uid=-1
16:20:40 [INFO] gameserver.network.server: Client connected: uid=-1 remote=('192.168.178.2', 52053)
16:20:40 [INFO] gameserver.network.auth: Login success: eem (uid=2)
16:20:40 [INFO] gameserver.network.server: Session registered: uid=2
16:20:40 [INFO] gameserver.network.server: Session upgraded: guest=-1 → uid=2
16:20:46 [INFO] gameserver.network.server: Session removed: uid=2
16:20:46 [INFO] websockets.server: connection open
16:20:46 [INFO] gameserver.network.server: Session registered: uid=-2
16:20:46 [INFO] gameserver.network.server: Client connected: uid=-2 remote=('192.168.178.2', 52060)
16:20:46 [INFO] gameserver.network.auth: Login success: eem (uid=2)
16:20:46 [INFO] gameserver.network.server: Session registered: uid=2
16:20:46 [INFO] gameserver.network.server: Session upgraded: guest=-2 → uid=2
16:20:57 [INFO] __main__: Shutdown signal received — stopping …
16:20:57 [INFO] __main__: Shutting down …
16:20:57 [INFO] gameserver.persistence.state_save: Game state saved to state.yaml (2 empires, 0 attacks, 0 battles)
16:20:57 [INFO] websockets.server: server closing
16:20:58 [INFO] gameserver.network.server: Session removed: uid=2
16:20:58 [INFO] websockets.server: server closed
16:20:58 [INFO] gameserver.network.server: WebSocket server stopped
16:20:58 [INFO] __main__:   WebSocket server stopped
16:20:58 [INFO] __main__:   debug dashboard stopped
16:20:58 [INFO] __main__:   database closed
16:20:58 [INFO] __main__:   goodbye
16:21:09 [INFO] __main__: === Game Server starting ===
16:21:09 [INFO] __main__: Loading configuration …
16:21:09 [INFO] __main__:   items:        210 loaded from config
16:21:09 [INFO] __main__:   map:          4 paths, 23 build tiles from config/maps/default.yaml
16:21:09 [INFO] __main__:   ai_templates: 2 entries from config/ai_templates.yaml
16:21:09 [INFO] gameserver.loaders.game_config_loader: Loaded game config from config/game.yaml (29 keys)
16:21:09 [INFO] __main__:   game_config:  loaded
16:21:09 [INFO] __main__: Initializing persistence …
16:21:09 [INFO] gameserver.persistence.database: Database connected: gameserver.db
16:21:09 [INFO] __main__:   database:     connected (gameserver.db)
16:21:09 [INFO] gameserver.persistence.state_load: Restoring state from state.yaml (saved at 2026-02-08T16:20:57, version 1)
16:21:09 [INFO] gameserver.persistence.state_load: Restored 2 empires, 0 attacks, 0 battles
16:21:09 [INFO] __main__:   state:        restored from disk (2 empires, 0 attacks)
16:21:09 [INFO] __main__: Creating services …
16:21:09 [INFO] __main__:   upgrade_provider: 210 items registered
16:21:09 [INFO] __main__:   all services created
16:21:09 [INFO] __main__: Wiring event handlers …
16:21:09 [INFO] __main__:   event handlers registered
16:21:09 [INFO] gameserver.engine.empire_service: Empire registered: uid=100 name='TestImperium'
16:21:09 [INFO] gameserver.engine.empire_service: Empire 100: recalculated effects → {}
16:21:10 [INFO] gameserver.engine.empire_service: Empire registered: uid=2 name='Empire1'
16:21:10 [INFO] gameserver.engine.empire_service: Empire 2: recalculated effects → {'gold_offset': 0.05, 'culture_offset': 0.15000000000000002, 'culture_modifier': 0.1, 'build_speed_modifier': 0.1}
16:21:10 [INFO] __main__: Restored 2 empires from saved state
16:21:10 [INFO] __main__: Starting network server …
16:21:10 [INFO] gameserver.network.handlers: Registered 29 message handlers: summary_request, item_request, military_request, new_item, new_structure, delete_structure, upgrade_structure, citizen_upgrade, change_citizen, increase_life, new_army, new_attack_request, change_army, new_wave, change_wave, end_siege, battle_register, battle_unregister, battle_next_wave_request, notification_request, user_message, timeline_request, userinfo_request, hall_of_fame_request, preferences_request, change_preferences, auth_request, signup, create_empire
16:21:10 [INFO] websockets.server: server listening on 0.0.0.0:8765
16:21:10 [INFO] gameserver.network.server: WebSocket server listening on ws://0.0.0.0:8765
16:21:10 [INFO] __main__:   WebSocket server listening on 0.0.0.0:8765
16:21:10 [INFO] gameserver.debug.dashboard: Debug dashboard running at http://0.0.0.0:9000/
16:21:10 [INFO] __main__: Starting game loop …
16:21:10 [INFO] __main__:   game loop running (1 s tick)
16:21:11 [INFO] websockets.server: connection open
16:21:11 [INFO] gameserver.network.server: Session registered: uid=-1
16:21:11 [INFO] gameserver.network.server: Client connected: uid=-1 remote=('192.168.178.2', 59349)
16:21:11 [INFO] gameserver.network.auth: Login success: eem (uid=2)
16:21:11 [INFO] gameserver.network.server: Session registered: uid=2
16:21:11 [INFO] gameserver.network.server: Session upgraded: guest=-1 → uid=2
16:21:16 [INFO] gameserver.engine.empire_service: Empire 2: started building BOW_MAKER (effort=2500.0)
16:21:16 [INFO] gameserver.network.handlers: new_item success uid=2 iid=BOW_MAKER
16:21:55 [INFO] __main__: Shutdown signal received — stopping …
16:21:56 [INFO] __main__: Shutting down …
16:21:56 [INFO] gameserver.persistence.state_save: Game state saved to state.yaml (2 empires, 0 attacks, 0 battles)
16:21:56 [INFO] websockets.server: server closing
16:21:56 [INFO] gameserver.network.server: Session removed: uid=2
16:21:56 [INFO] websockets.server: server closed
16:21:56 [INFO] gameserver.network.server: WebSocket server stopped
16:21:56 [INFO] __main__:   WebSocket server stopped
16:21:56 [INFO] __main__:   debug dashboard stopped
16:21:56 [INFO] __main__:   database closed
16:21:56 [INFO] __main__:   goodbye
16:22:56 [INFO] __main__: === Game Server starting ===
16:22:56 [INFO] __main__: Loading configuration …
16:22:57 [INFO] __main__:   items:        210 loaded from config
16:22:57 [INFO] __main__:   map:          4 paths, 23 build tiles from config/maps/default.yaml
16:22:57 [INFO] __main__:   ai_templates: 2 entries from config/ai_templates.yaml
16:22:57 [INFO] gameserver.loaders.game_config_loader: Loaded game config from config/game.yaml (29 keys)
16:22:57 [INFO] __main__:   game_config:  loaded
16:22:57 [INFO] __main__: Initializing persistence …
16:22:57 [INFO] gameserver.persistence.database: Database connected: gameserver.db
16:22:57 [INFO] __main__:   database:     connected (gameserver.db)
16:22:57 [INFO] gameserver.persistence.state_load: Restoring state from state.yaml (saved at 2026-02-08T16:21:56, version 1)
16:22:57 [INFO] gameserver.persistence.state_load: Restored 2 empires, 0 attacks, 0 battles
16:22:57 [INFO] __main__:   state:        restored from disk (2 empires, 0 attacks)
16:22:57 [INFO] __main__: Creating services …
16:22:57 [INFO] __main__:   upgrade_provider: 210 items registered
16:22:57 [INFO] __main__:   all services created
16:22:57 [INFO] __main__: Wiring event handlers …
16:22:57 [INFO] __main__:   event handlers registered
16:22:57 [INFO] gameserver.engine.empire_service: Empire registered: uid=100 name='TestImperium'
16:22:57 [INFO] gameserver.engine.empire_service: Empire 100: recalculated effects → {}
16:22:57 [INFO] gameserver.engine.empire_service: Empire registered: uid=2 name='Empire1'
16:22:57 [INFO] gameserver.engine.empire_service: Empire 2: recalculated effects → {'gold_offset': 0.05, 'culture_offset': 0.15000000000000002, 'culture_modifier': 0.1, 'build_speed_modifier': 0.1}
16:22:57 [INFO] __main__: Restored 2 empires from saved state
16:22:57 [INFO] __main__: Starting network server …
16:22:57 [INFO] gameserver.network.handlers: Registered 29 message handlers: summary_request, item_request, military_request, new_item, new_structure, delete_structure, upgrade_structure, citizen_upgrade, change_citizen, increase_life, new_army, new_attack_request, change_army, new_wave, change_wave, end_siege, battle_register, battle_unregister, battle_next_wave_request, notification_request, user_message, timeline_request, userinfo_request, hall_of_fame_request, preferences_request, change_preferences, auth_request, signup, create_empire
16:22:57 [INFO] websockets.server: server listening on 0.0.0.0:8765
16:22:57 [INFO] gameserver.network.server: WebSocket server listening on ws://0.0.0.0:8765
16:22:57 [INFO] __main__:   WebSocket server listening on 0.0.0.0:8765
16:22:57 [INFO] gameserver.debug.dashboard: Debug dashboard running at http://0.0.0.0:9000/
16:22:57 [INFO] __main__: Starting game loop …
16:22:57 [INFO] __main__:   game loop running (1 s tick)
16:22:58 [INFO] websockets.server: connection open
16:22:58 [INFO] gameserver.network.server: Session registered: uid=-1
16:22:58 [INFO] gameserver.network.server: Client connected: uid=-1 remote=('192.168.178.2', 52223)
16:22:58 [INFO] gameserver.network.auth: Login success: eem (uid=2)
16:22:58 [INFO] gameserver.network.server: Session registered: uid=2
16:22:58 [INFO] gameserver.network.server: Session upgraded: guest=-1 → uid=2
16:23:04 [INFO] gameserver.engine.empire_service: Empire 2: started building BOW_MAKER (effort=2500.0)
16:23:04 [INFO] gameserver.network.handlers: new_item success uid=2 iid=BOW_MAKER
16:23:21 [INFO] gameserver.network.handlers: citizen_upgrade request from uid=2
16:23:21 [INFO] gameserver.network.handlers: citizen_upgrade success uid=2
16:23:24 [INFO] gameserver.network.handlers: change_citizen request from uid=2
16:23:24 [INFO] gameserver.network.handlers: change_citizen success uid=2: {'merchant': 0, 'scientist': 0, 'artist': 1, 'free': 6}
16:23:24 [INFO] gameserver.network.handlers: change_citizen request from uid=2
16:23:24 [INFO] gameserver.network.handlers: change_citizen success uid=2: {'merchant': 0, 'scientist': 0, 'artist': 2, 'free': 5}
16:23:25 [INFO] gameserver.network.handlers: change_citizen request from uid=2
16:23:25 [INFO] gameserver.network.handlers: change_citizen success uid=2: {'merchant': 0, 'scientist': 0, 'artist': 3, 'free': 4}
16:23:25 [INFO] gameserver.network.handlers: change_citizen request from uid=2
16:23:25 [INFO] gameserver.network.handlers: change_citizen success uid=2: {'merchant': 0, 'scientist': 0, 'artist': 4, 'free': 3}
16:23:25 [INFO] gameserver.network.handlers: change_citizen request from uid=2
16:23:25 [INFO] gameserver.network.handlers: change_citizen success uid=2: {'merchant': 0, 'scientist': 0, 'artist': 5, 'free': 2}
16:23:25 [INFO] gameserver.network.handlers: change_citizen request from uid=2
16:23:25 [INFO] gameserver.network.handlers: change_citizen success uid=2: {'merchant': 0, 'scientist': 0, 'artist': 6, 'free': 1}
16:23:25 [INFO] gameserver.network.handlers: change_citizen request from uid=2
16:23:25 [INFO] gameserver.network.handlers: change_citizen success uid=2: {'merchant': 0, 'scientist': 0, 'artist': 7, 'free': 0}
16:23:25 [INFO] gameserver.network.handlers: change_citizen request from uid=2
16:23:25 [INFO] gameserver.network.handlers: change_citizen failed uid=2: Too many citizens assigned (max 7, got 8)
16:23:25 [INFO] gameserver.network.handlers: change_citizen request from uid=2
16:23:25 [INFO] gameserver.network.handlers: change_citizen failed uid=2: Too many citizens assigned (max 7, got 8)
16:23:26 [INFO] gameserver.network.handlers: change_citizen request from uid=2
16:23:26 [INFO] gameserver.network.handlers: change_citizen failed uid=2: Too many citizens assigned (max 7, got 8)
16:23:26 [INFO] gameserver.network.handlers: change_citizen request from uid=2
16:23:26 [INFO] gameserver.network.handlers: change_citizen failed uid=2: Too many citizens assigned (max 7, got 8)
16:23:36 [INFO] gameserver.network.handlers: change_citizen request from uid=2
16:23:36 [INFO] gameserver.network.handlers: change_citizen success uid=2: {'merchant': 0, 'scientist': 0, 'artist': 6, 'free': 1}
16:23:36 [INFO] gameserver.network.handlers: change_citizen request from uid=2
16:23:36 [INFO] gameserver.network.handlers: change_citizen success uid=2: {'merchant': 0, 'scientist': 0, 'artist': 5, 'free': 2}
16:23:36 [INFO] gameserver.network.handlers: change_citizen request from uid=2
16:23:36 [INFO] gameserver.network.handlers: change_citizen success uid=2: {'merchant': 0, 'scientist': 0, 'artist': 4, 'free': 3}
16:23:36 [INFO] gameserver.network.handlers: change_citizen request from uid=2
16:23:36 [INFO] gameserver.network.handlers: change_citizen success uid=2: {'merchant': 0, 'scientist': 0, 'artist': 3, 'free': 4}
16:23:37 [INFO] gameserver.network.handlers: change_citizen request from uid=2
16:23:37 [INFO] gameserver.network.handlers: change_citizen success uid=2: {'merchant': 0, 'scientist': 0, 'artist': 2, 'free': 5}
16:23:37 [INFO] gameserver.network.handlers: change_citizen request from uid=2
16:23:37 [INFO] gameserver.network.handlers: change_citizen success uid=2: {'merchant': 0, 'scientist': 0, 'artist': 1, 'free': 6}
16:23:37 [INFO] gameserver.network.handlers: change_citizen request from uid=2
16:23:37 [INFO] gameserver.network.handlers: change_citizen success uid=2: {'merchant': 0, 'scientist': 0, 'artist': 0, 'free': 7}
16:23:41 [INFO] gameserver.network.handlers: change_citizen request from uid=2
16:23:41 [INFO] gameserver.network.handlers: change_citizen success uid=2: {'merchant': 1, 'scientist': 0, 'artist': 0, 'free': 6}
16:23:45 [INFO] gameserver.network.handlers: change_citizen request from uid=2
16:23:45 [INFO] gameserver.network.handlers: change_citizen success uid=2: {'merchant': 2, 'scientist': 0, 'artist': 0, 'free': 5}
16:23:45 [INFO] gameserver.network.handlers: change_citizen request from uid=2
16:23:45 [INFO] gameserver.network.handlers: change_citizen success uid=2: {'merchant': 3, 'scientist': 0, 'artist': 0, 'free': 4}
16:23:45 [INFO] gameserver.network.handlers: change_citizen request from uid=2
16:23:45 [INFO] gameserver.network.handlers: change_citizen success uid=2: {'merchant': 4, 'scientist': 0, 'artist': 0, 'free': 3}
16:23:45 [INFO] gameserver.network.handlers: change_citizen request from uid=2
16:23:45 [INFO] gameserver.network.handlers: change_citizen success uid=2: {'merchant': 5, 'scientist': 0, 'artist': 0, 'free': 2}
16:23:45 [INFO] gameserver.network.handlers: change_citizen request from uid=2
16:23:45 [INFO] gameserver.network.handlers: change_citizen success uid=2: {'merchant': 6, 'scientist': 0, 'artist': 0, 'free': 1}
16:23:45 [INFO] gameserver.network.handlers: change_citizen request from uid=2
16:23:45 [INFO] gameserver.network.handlers: change_citizen success uid=2: {'merchant': 7, 'scientist': 0, 'artist': 0, 'free': 0}
16:23:46 [INFO] gameserver.network.handlers: change_citizen request from uid=2
16:23:46 [INFO] gameserver.network.handlers: change_citizen failed uid=2: Too many citizens assigned (max 7, got 8)
16:23:46 [INFO] gameserver.network.handlers: change_citizen request from uid=2
16:23:46 [INFO] gameserver.network.handlers: change_citizen failed uid=2: Too many citizens assigned (max 7, got 8)
16:23:46 [INFO] gameserver.network.handlers: change_citizen request from uid=2
16:23:46 [INFO] gameserver.network.handlers: change_citizen failed uid=2: Too many citizens assigned (max 7, got 8)
16:23:46 [INFO] gameserver.network.handlers: change_citizen request from uid=2
16:23:46 [INFO] gameserver.network.handlers: change_citizen failed uid=2: Too many citizens assigned (max 7, got 8)
16:23:46 [INFO] gameserver.network.handlers: change_citizen request from uid=2
16:23:46 [INFO] gameserver.network.handlers: change_citizen failed uid=2: Too many citizens assigned (max 7, got 8)
16:23:47 [INFO] gameserver.network.handlers: change_citizen request from uid=2
16:23:47 [INFO] gameserver.network.handlers: change_citizen success uid=2: {'merchant': 6, 'scientist': 0, 'artist': 0, 'free': 1}
16:23:47 [INFO] gameserver.network.handlers: change_citizen request from uid=2
16:23:47 [INFO] gameserver.network.handlers: change_citizen success uid=2: {'merchant': 5, 'scientist': 0, 'artist': 0, 'free': 2}
16:23:48 [INFO] gameserver.network.handlers: change_citizen request from uid=2
16:23:48 [INFO] gameserver.network.handlers: change_citizen success uid=2: {'merchant': 4, 'scientist': 0, 'artist': 0, 'free': 3}
16:23:48 [INFO] gameserver.network.handlers: change_citizen request from uid=2
16:23:48 [INFO] gameserver.network.handlers: change_citizen success uid=2: {'merchant': 3, 'scientist': 0, 'artist': 0, 'free': 4}
16:23:48 [INFO] gameserver.network.handlers: change_citizen request from uid=2
16:23:48 [INFO] gameserver.network.handlers: change_citizen success uid=2: {'merchant': 2, 'scientist': 0, 'artist': 0, 'free': 5}
16:23:48 [INFO] gameserver.network.handlers: change_citizen request from uid=2
16:23:48 [INFO] gameserver.network.handlers: change_citizen success uid=2: {'merchant': 1, 'scientist': 0, 'artist': 0, 'free': 6}
16:23:48 [INFO] gameserver.network.handlers: change_citizen request from uid=2
16:23:48 [INFO] gameserver.network.handlers: change_citizen success uid=2: {'merchant': 0, 'scientist': 0, 'artist': 0, 'free': 7}
16:25:11 [INFO] gameserver.network.server: Session removed: uid=2
16:25:11 [INFO] websockets.server: connection open
16:25:11 [INFO] gameserver.network.server: Session registered: uid=-2
16:25:11 [INFO] gameserver.network.server: Client connected: uid=-2 remote=('192.168.178.2', 58510)
16:25:11 [INFO] gameserver.network.auth: Login success: eem (uid=2)
16:25:11 [INFO] gameserver.network.server: Session registered: uid=2
16:25:11 [INFO] gameserver.network.server: Session upgraded: guest=-2 → uid=2
16:25:12 [INFO] gameserver.network.server: Session removed: uid=2
16:25:12 [INFO] websockets.server: connection open
16:25:12 [INFO] gameserver.network.server: Session registered: uid=-3
16:25:12 [INFO] gameserver.network.server: Client connected: uid=-3 remote=('192.168.178.2', 58513)
16:25:12 [INFO] gameserver.network.auth: Login success: eem (uid=2)
16:25:12 [INFO] gameserver.network.server: Session registered: uid=2
16:25:12 [INFO] gameserver.network.server: Session upgraded: guest=-3 → uid=2
16:25:13 [INFO] gameserver.network.server: Session removed: uid=2
16:25:13 [INFO] websockets.server: connection open
16:25:13 [INFO] gameserver.network.server: Session registered: uid=-4
16:25:13 [INFO] gameserver.network.server: Client connected: uid=-4 remote=('192.168.178.2', 58516)
16:25:13 [INFO] gameserver.network.auth: Login success: eem (uid=2)
16:25:13 [INFO] gameserver.network.server: Session registered: uid=2
16:25:13 [INFO] gameserver.network.server: Session upgraded: guest=-4 → uid=2
16:25:33 [INFO] gameserver.network.server: Session removed: uid=2
16:25:33 [INFO] websockets.server: connection open
16:25:33 [INFO] gameserver.network.server: Session registered: uid=-5
16:25:33 [INFO] gameserver.network.server: Client connected: uid=-5 remote=('192.168.178.2', 60884)
16:25:33 [INFO] gameserver.network.auth: Login success: eem (uid=2)
16:25:33 [INFO] gameserver.network.server: Session registered: uid=2
16:25:33 [INFO] gameserver.network.server: Session upgraded: guest=-5 → uid=2
16:25:35 [INFO] gameserver.network.server: Session removed: uid=2
16:25:35 [INFO] websockets.server: connection open
16:25:35 [INFO] gameserver.network.server: Session registered: uid=-6
16:25:35 [INFO] gameserver.network.server: Client connected: uid=-6 remote=('192.168.178.2', 60887)
16:25:35 [INFO] gameserver.network.auth: Login success: eem (uid=2)
16:25:35 [INFO] gameserver.network.server: Session registered: uid=2
16:25:35 [INFO] gameserver.network.server: Session upgraded: guest=-6 → uid=2
16:25:35 [INFO] gameserver.network.server: Session removed: uid=2
16:25:35 [INFO] websockets.server: connection open
16:25:35 [INFO] gameserver.network.server: Session registered: uid=-7
16:25:35 [INFO] gameserver.network.server: Client connected: uid=-7 remote=('192.168.178.2', 60890)
16:25:35 [INFO] gameserver.network.auth: Login success: eem (uid=2)
16:25:35 [INFO] gameserver.network.server: Session registered: uid=2
16:25:35 [INFO] gameserver.network.server: Session upgraded: guest=-7 → uid=2
16:25:35 [INFO] gameserver.network.server: Session removed: uid=2
16:25:35 [INFO] websockets.server: connection open
16:25:35 [INFO] gameserver.network.server: Session registered: uid=-8
16:25:35 [INFO] gameserver.network.server: Client connected: uid=-8 remote=('192.168.178.2', 60893)
16:25:35 [INFO] gameserver.network.auth: Login success: eem (uid=2)
16:25:35 [INFO] gameserver.network.server: Session registered: uid=2
16:25:35 [INFO] gameserver.network.server: Session upgraded: guest=-8 → uid=2
16:26:24 [INFO] gameserver.network.server: Session removed: uid=2
16:26:25 [INFO] websockets.server: connection open
16:26:25 [INFO] gameserver.network.server: Session registered: uid=-9
16:26:25 [INFO] gameserver.network.server: Client connected: uid=-9 remote=('192.168.178.2', 52024)
16:26:25 [INFO] gameserver.network.auth: Login success: eem (uid=2)
16:26:25 [INFO] gameserver.network.server: Session registered: uid=2
16:26:25 [INFO] gameserver.network.server: Session upgraded: guest=-9 → uid=2
16:27:18 [INFO] gameserver.network.server: Session removed: uid=2
16:27:18 [INFO] websockets.server: connection open
16:27:18 [INFO] gameserver.network.server: Session registered: uid=-10
16:27:18 [INFO] gameserver.network.server: Client connected: uid=-10 remote=('192.168.178.2', 65368)
16:27:18 [INFO] gameserver.network.auth: Login success: eem (uid=2)
16:27:18 [INFO] gameserver.network.server: Session registered: uid=2
16:27:18 [INFO] gameserver.network.server: Session upgraded: guest=-10 → uid=2
16:28:06 [INFO] gameserver.network.server: Session removed: uid=2
16:28:06 [INFO] websockets.server: connection open
16:28:06 [INFO] gameserver.network.server: Session registered: uid=-11
16:28:06 [INFO] gameserver.network.server: Client connected: uid=-11 remote=('192.168.178.2', 53404)
16:28:06 [INFO] gameserver.network.auth: Login success: eem (uid=2)
16:28:06 [INFO] gameserver.network.server: Session registered: uid=2
16:28:06 [INFO] gameserver.network.server: Session upgraded: guest=-11 → uid=2
16:28:24 [INFO] gameserver.network.handlers: change_citizen request from uid=2
16:28:24 [INFO] gameserver.network.handlers: change_citizen success uid=2: {'merchant': 0, 'scientist': 0, 'artist': 1, 'free': 6}
16:28:24 [INFO] gameserver.network.handlers: change_citizen request from uid=2
16:28:24 [INFO] gameserver.network.handlers: change_citizen success uid=2: {'merchant': 0, 'scientist': 0, 'artist': 2, 'free': 5}
16:28:25 [INFO] gameserver.network.handlers: change_citizen request from uid=2
16:28:25 [INFO] gameserver.network.handlers: change_citizen success uid=2: {'merchant': 0, 'scientist': 0, 'artist': 3, 'free': 4}
16:28:25 [INFO] gameserver.network.handlers: change_citizen request from uid=2
16:28:25 [INFO] gameserver.network.handlers: change_citizen success uid=2: {'merchant': 0, 'scientist': 0, 'artist': 4, 'free': 3}
16:28:25 [INFO] gameserver.network.handlers: change_citizen request from uid=2
16:28:25 [INFO] gameserver.network.handlers: change_citizen success uid=2: {'merchant': 0, 'scientist': 0, 'artist': 5, 'free': 2}
16:28:25 [INFO] gameserver.network.handlers: change_citizen request from uid=2
16:28:25 [INFO] gameserver.network.handlers: change_citizen success uid=2: {'merchant': 0, 'scientist': 0, 'artist': 6, 'free': 1}
16:28:25 [INFO] gameserver.network.handlers: change_citizen request from uid=2
16:28:25 [INFO] gameserver.network.handlers: change_citizen success uid=2: {'merchant': 0, 'scientist': 0, 'artist': 7, 'free': 0}
16:28:25 [INFO] gameserver.network.handlers: change_citizen request from uid=2
16:28:25 [INFO] gameserver.network.handlers: change_citizen failed uid=2: Too many citizens assigned (max 7, got 8)
16:28:25 [INFO] gameserver.network.handlers: change_citizen request from uid=2
16:28:25 [INFO] gameserver.network.handlers: change_citizen failed uid=2: Too many citizens assigned (max 7, got 8)
16:28:26 [INFO] gameserver.network.handlers: change_citizen request from uid=2
16:28:26 [INFO] gameserver.network.handlers: change_citizen failed uid=2: Too many citizens assigned (max 7, got 8)
16:28:26 [INFO] gameserver.network.handlers: change_citizen request from uid=2
16:28:26 [INFO] gameserver.network.handlers: change_citizen failed uid=2: Too many citizens assigned (max 7, got 8)
16:28:26 [INFO] gameserver.network.handlers: change_citizen request from uid=2
16:28:26 [INFO] gameserver.network.handlers: change_citizen failed uid=2: Too many citizens assigned (max 7, got 8)
16:28:26 [INFO] gameserver.network.handlers: change_citizen request from uid=2
16:28:26 [INFO] gameserver.network.handlers: change_citizen failed uid=2: Too many citizens assigned (max 7, got 8)
16:30:57 [INFO] gameserver.network.server: Session removed: uid=2
16:30:58 [INFO] websockets.server: connection open
16:30:58 [INFO] gameserver.network.server: Session registered: uid=-12
16:30:58 [INFO] gameserver.network.server: Client connected: uid=-12 remote=('192.168.178.2', 58091)
16:30:58 [INFO] gameserver.network.auth: Login success: eem (uid=2)
16:30:58 [INFO] gameserver.network.server: Session registered: uid=2
16:30:58 [INFO] gameserver.network.server: Session upgraded: guest=-12 → uid=2
16:31:09 [INFO] __main__: Shutdown signal received — stopping …
16:31:10 [INFO] __main__: Shutting down …
16:31:10 [INFO] gameserver.persistence.state_save: Game state saved to state.yaml (2 empires, 0 attacks, 0 battles)
16:31:10 [INFO] websockets.server: server closing
16:31:10 [INFO] gameserver.network.server: Session removed: uid=2
16:31:10 [INFO] websockets.server: server closed
16:31:10 [INFO] gameserver.network.server: WebSocket server stopped
16:31:10 [INFO] __main__:   WebSocket server stopped
16:31:10 [INFO] __main__:   debug dashboard stopped
16:31:10 [INFO] __main__:   database closed
16:31:10 [INFO] __main__:   goodbye
16:31:12 [INFO] __main__: === Game Server starting ===
16:31:12 [INFO] __main__: Loading configuration …
16:31:13 [INFO] __main__:   items:        210 loaded from config
16:31:13 [INFO] __main__:   map:          4 paths, 23 build tiles from config/maps/default.yaml
16:31:13 [INFO] __main__:   ai_templates: 2 entries from config/ai_templates.yaml
16:31:13 [INFO] gameserver.loaders.game_config_loader: Loaded game config from config/game.yaml (29 keys)
16:31:13 [INFO] __main__:   game_config:  loaded
16:31:13 [INFO] __main__: Initializing persistence …
16:31:13 [INFO] gameserver.persistence.database: Database connected: gameserver.db
16:31:13 [INFO] __main__:   database:     connected (gameserver.db)
16:31:13 [INFO] gameserver.persistence.state_load: Restoring state from state.yaml (saved at 2026-02-08T16:31:10, version 1)
16:31:13 [INFO] gameserver.persistence.state_load: Restored 2 empires, 0 attacks, 0 battles
16:31:13 [INFO] __main__:   state:        restored from disk (2 empires, 0 attacks)
16:31:13 [INFO] __main__: Creating services …
16:31:13 [INFO] __main__:   upgrade_provider: 210 items registered
16:31:13 [INFO] __main__:   all services created
16:31:13 [INFO] __main__: Wiring event handlers …
16:31:13 [INFO] __main__:   event handlers registered
16:31:13 [INFO] gameserver.engine.empire_service: Empire registered: uid=100 name='TestImperium'
16:31:13 [INFO] gameserver.engine.empire_service: Empire 100: recalculated effects → {}
16:31:13 [INFO] gameserver.engine.empire_service: Empire registered: uid=2 name='Empire1'
16:31:13 [INFO] gameserver.engine.empire_service: Empire 2: recalculated effects → {'gold_offset': 0.05, 'culture_offset': 0.15000000000000002, 'culture_modifier': 0.1, 'build_speed_modifier': 0.1}
16:31:13 [INFO] __main__: Restored 2 empires from saved state
16:31:13 [INFO] __main__: Starting network server …
16:31:13 [INFO] gameserver.network.handlers: Registered 29 message handlers: summary_request, item_request, military_request, new_item, new_structure, delete_structure, upgrade_structure, citizen_upgrade, change_citizen, increase_life, new_army, new_attack_request, change_army, new_wave, change_wave, end_siege, battle_register, battle_unregister, battle_next_wave_request, notification_request, user_message, timeline_request, userinfo_request, hall_of_fame_request, preferences_request, change_preferences, auth_request, signup, create_empire
16:31:13 [INFO] websockets.server: server listening on 0.0.0.0:8765
16:31:13 [INFO] gameserver.network.server: WebSocket server listening on ws://0.0.0.0:8765
16:31:13 [INFO] __main__:   WebSocket server listening on 0.0.0.0:8765
16:31:13 [INFO] gameserver.debug.dashboard: Debug dashboard running at http://0.0.0.0:9000/
16:31:13 [INFO] __main__: Starting game loop …
16:31:13 [INFO] __main__:   game loop running (1 s tick)
16:31:13 [INFO] websockets.server: connection open
16:31:13 [INFO] gameserver.network.server: Session registered: uid=-1
16:31:13 [INFO] gameserver.network.server: Client connected: uid=-1 remote=('192.168.178.2', 65342)
16:31:13 [INFO] gameserver.network.auth: Login success: eem (uid=2)
16:31:13 [INFO] gameserver.network.server: Session registered: uid=2
16:31:13 [INFO] gameserver.network.server: Session upgraded: guest=-1 → uid=2
16:31:21 [INFO] gameserver.network.handlers: change_citizen request from uid=2
16:31:21 [INFO] gameserver.network.handlers: change_citizen success uid=2: {'merchant': 0, 'scientist': 0, 'artist': 6, 'free': 1}
16:31:21 [INFO] gameserver.network.handlers: change_citizen request from uid=2
16:31:21 [INFO] gameserver.network.handlers: change_citizen success uid=2: {'merchant': 0, 'scientist': 0, 'artist': 5, 'free': 2}
16:31:22 [INFO] gameserver.network.handlers: change_citizen request from uid=2
16:31:22 [INFO] gameserver.network.handlers: change_citizen success uid=2: {'merchant': 0, 'scientist': 0, 'artist': 4, 'free': 3}
16:31:22 [INFO] gameserver.network.handlers: change_citizen request from uid=2
16:31:22 [INFO] gameserver.network.handlers: change_citizen success uid=2: {'merchant': 0, 'scientist': 0, 'artist': 3, 'free': 4}
16:31:22 [INFO] gameserver.network.handlers: change_citizen request from uid=2
16:31:22 [INFO] gameserver.network.handlers: change_citizen success uid=2: {'merchant': 0, 'scientist': 0, 'artist': 2, 'free': 5}
16:31:22 [INFO] gameserver.network.handlers: change_citizen request from uid=2
16:31:22 [INFO] gameserver.network.handlers: change_citizen success uid=2: {'merchant': 0, 'scientist': 0, 'artist': 1, 'free': 6}
16:31:22 [INFO] gameserver.network.handlers: change_citizen request from uid=2
16:31:22 [INFO] gameserver.network.handlers: change_citizen success uid=2: {'merchant': 0, 'scientist': 0, 'artist': 0, 'free': 7}
16:31:24 [INFO] gameserver.network.handlers: change_citizen request from uid=2
16:31:24 [INFO] gameserver.network.handlers: change_citizen success uid=2: {'merchant': 1, 'scientist': 0, 'artist': 0, 'free': 6}
16:31:24 [INFO] gameserver.network.handlers: change_citizen request from uid=2
16:31:24 [INFO] gameserver.network.handlers: change_citizen success uid=2: {'merchant': 2, 'scientist': 0, 'artist': 0, 'free': 5}
16:31:24 [INFO] gameserver.network.handlers: change_citizen request from uid=2
16:31:24 [INFO] gameserver.network.handlers: change_citizen success uid=2: {'merchant': 3, 'scientist': 0, 'artist': 0, 'free': 4}
16:31:24 [INFO] gameserver.network.handlers: change_citizen request from uid=2
16:31:24 [INFO] gameserver.network.handlers: change_citizen success uid=2: {'merchant': 4, 'scientist': 0, 'artist': 0, 'free': 3}
16:31:25 [INFO] gameserver.network.handlers: change_citizen request from uid=2
16:31:25 [INFO] gameserver.network.handlers: change_citizen success uid=2: {'merchant': 5, 'scientist': 0, 'artist': 0, 'free': 2}
16:31:25 [INFO] gameserver.network.handlers: change_citizen request from uid=2
16:31:25 [INFO] gameserver.network.handlers: change_citizen success uid=2: {'merchant': 6, 'scientist': 0, 'artist': 0, 'free': 1}
16:31:25 [INFO] gameserver.network.handlers: change_citizen request from uid=2
16:31:25 [INFO] gameserver.network.handlers: change_citizen success uid=2: {'merchant': 7, 'scientist': 0, 'artist': 0, 'free': 0}
16:31:25 [INFO] gameserver.network.handlers: change_citizen request from uid=2
16:31:25 [INFO] gameserver.network.handlers: change_citizen failed uid=2: Too many citizens assigned (max 7, got 8)
16:31:25 [INFO] gameserver.network.handlers: change_citizen request from uid=2
16:31:25 [INFO] gameserver.network.handlers: change_citizen failed uid=2: Too many citizens assigned (max 7, got 8)
16:31:25 [INFO] gameserver.network.handlers: change_citizen request from uid=2
16:31:25 [INFO] gameserver.network.handlers: change_citizen failed uid=2: Too many citizens assigned (max 7, got 8)
16:31:25 [INFO] gameserver.network.handlers: change_citizen request from uid=2
16:31:25 [INFO] gameserver.network.handlers: change_citizen failed uid=2: Too many citizens assigned (max 7, got 8)
16:31:26 [INFO] gameserver.network.handlers: change_citizen request from uid=2
16:31:26 [INFO] gameserver.network.handlers: change_citizen failed uid=2: Too many citizens assigned (max 7, got 8)
16:31:26 [INFO] gameserver.network.handlers: change_citizen request from uid=2
16:31:26 [INFO] gameserver.network.handlers: change_citizen failed uid=2: Too many citizens assigned (max 7, got 8)
16:31:26 [INFO] gameserver.network.handlers: change_citizen request from uid=2
16:31:26 [INFO] gameserver.network.handlers: change_citizen failed uid=2: Too many citizens assigned (max 7, got 8)
16:31:26 [INFO] gameserver.network.handlers: change_citizen request from uid=2
16:31:26 [INFO] gameserver.network.handlers: change_citizen failed uid=2: Too many citizens assigned (max 7, got 8)
16:31:28 [INFO] gameserver.network.handlers: change_citizen request from uid=2
16:31:28 [INFO] gameserver.network.handlers: change_citizen success uid=2: {'merchant': 6, 'scientist': 0, 'artist': 0, 'free': 1}
16:31:28 [INFO] gameserver.network.handlers: change_citizen request from uid=2
16:31:28 [INFO] gameserver.network.handlers: change_citizen success uid=2: {'merchant': 5, 'scientist': 0, 'artist': 0, 'free': 2}
16:31:28 [INFO] gameserver.network.handlers: change_citizen request from uid=2
16:31:28 [INFO] gameserver.network.handlers: change_citizen success uid=2: {'merchant': 4, 'scientist': 0, 'artist': 0, 'free': 3}
16:31:28 [INFO] gameserver.network.handlers: change_citizen request from uid=2
16:31:28 [INFO] gameserver.network.handlers: change_citizen success uid=2: {'merchant': 3, 'scientist': 0, 'artist': 0, 'free': 4}
16:31:28 [INFO] gameserver.network.handlers: change_citizen request from uid=2
16:31:28 [INFO] gameserver.network.handlers: change_citizen success uid=2: {'merchant': 2, 'scientist': 0, 'artist': 0, 'free': 5}
16:31:29 [INFO] gameserver.network.handlers: change_citizen request from uid=2
16:31:29 [INFO] gameserver.network.handlers: change_citizen success uid=2: {'merchant': 1, 'scientist': 0, 'artist': 0, 'free': 6}
16:31:29 [INFO] gameserver.network.handlers: change_citizen request from uid=2
16:31:29 [INFO] gameserver.network.handlers: change_citizen success uid=2: {'merchant': 0, 'scientist': 0, 'artist': 0, 'free': 7}
16:31:31 [INFO] gameserver.network.handlers: change_citizen request from uid=2
16:31:31 [INFO] gameserver.network.handlers: change_citizen success uid=2: {'merchant': 0, 'scientist': 1, 'artist': 0, 'free': 6}
16:31:31 [INFO] gameserver.network.handlers: change_citizen request from uid=2
16:31:31 [INFO] gameserver.network.handlers: change_citizen success uid=2: {'merchant': 0, 'scientist': 2, 'artist': 0, 'free': 5}
16:31:31 [INFO] gameserver.network.handlers: change_citizen request from uid=2
16:31:31 [INFO] gameserver.network.handlers: change_citizen success uid=2: {'merchant': 0, 'scientist': 3, 'artist': 0, 'free': 4}
16:31:31 [INFO] gameserver.network.handlers: change_citizen request from uid=2
16:31:31 [INFO] gameserver.network.handlers: change_citizen success uid=2: {'merchant': 0, 'scientist': 4, 'artist': 0, 'free': 3}
16:31:32 [INFO] gameserver.network.handlers: change_citizen request from uid=2
16:31:32 [INFO] gameserver.network.handlers: change_citizen success uid=2: {'merchant': 0, 'scientist': 5, 'artist': 0, 'free': 2}
16:31:32 [INFO] gameserver.network.handlers: change_citizen request from uid=2
16:31:32 [INFO] gameserver.network.handlers: change_citizen success uid=2: {'merchant': 0, 'scientist': 6, 'artist': 0, 'free': 1}
16:31:32 [INFO] gameserver.network.handlers: change_citizen request from uid=2
16:31:32 [INFO] gameserver.network.handlers: change_citizen success uid=2: {'merchant': 0, 'scientist': 7, 'artist': 0, 'free': 0}
16:31:32 [INFO] gameserver.network.handlers: change_citizen request from uid=2
16:31:32 [INFO] gameserver.network.handlers: change_citizen failed uid=2: Too many citizens assigned (max 7, got 8)
16:31:32 [INFO] gameserver.network.handlers: change_citizen request from uid=2
16:31:32 [INFO] gameserver.network.handlers: change_citizen failed uid=2: Too many citizens assigned (max 7, got 8)
16:31:33 [INFO] gameserver.network.handlers: change_citizen request from uid=2
16:31:33 [INFO] gameserver.network.handlers: change_citizen success uid=2: {'merchant': 0, 'scientist': 6, 'artist': 0, 'free': 1}
16:31:33 [INFO] gameserver.network.handlers: change_citizen request from uid=2
16:31:33 [INFO] gameserver.network.handlers: change_citizen success uid=2: {'merchant': 0, 'scientist': 5, 'artist': 0, 'free': 2}
16:31:33 [INFO] gameserver.network.handlers: change_citizen request from uid=2
16:31:33 [INFO] gameserver.network.handlers: change_citizen success uid=2: {'merchant': 0, 'scientist': 4, 'artist': 0, 'free': 3}
16:31:33 [INFO] gameserver.network.handlers: change_citizen request from uid=2
16:31:33 [INFO] gameserver.network.handlers: change_citizen success uid=2: {'merchant': 0, 'scientist': 3, 'artist': 0, 'free': 4}
16:31:34 [INFO] gameserver.network.handlers: change_citizen request from uid=2
16:31:34 [INFO] gameserver.network.handlers: change_citizen success uid=2: {'merchant': 0, 'scientist': 2, 'artist': 0, 'free': 5}
16:31:34 [INFO] gameserver.network.handlers: change_citizen request from uid=2
16:31:34 [INFO] gameserver.network.handlers: change_citizen success uid=2: {'merchant': 0, 'scientist': 1, 'artist': 0, 'free': 6}
16:31:34 [INFO] gameserver.network.handlers: change_citizen request from uid=2
16:31:34 [INFO] gameserver.network.handlers: change_citizen success uid=2: {'merchant': 0, 'scientist': 0, 'artist': 0, 'free': 7}
16:36:05 [INFO] gameserver.engine.empire_service: Empire 2: knowledge HORSEBACK_RIDING completed
16:36:23 [INFO] gameserver.network.server: Session removed: uid=2
16:36:23 [INFO] websockets.server: connection open
16:36:23 [INFO] gameserver.network.server: Session registered: uid=-2
16:36:23 [INFO] gameserver.network.server: Client connected: uid=-2 remote=('192.168.178.2', 65495)
16:36:23 [INFO] gameserver.network.auth: Login success: eem (uid=2)
16:36:23 [INFO] gameserver.network.server: Session registered: uid=2
16:36:23 [INFO] gameserver.network.server: Session upgraded: guest=-2 → uid=2
16:37:03 [INFO] gameserver.network.server: Session removed: uid=2
16:37:03 [INFO] websockets.server: connection open
16:37:03 [INFO] gameserver.network.server: Session registered: uid=-3
16:37:03 [INFO] gameserver.network.server: Client connected: uid=-3 remote=('192.168.178.2', 49154)
16:37:03 [INFO] gameserver.network.auth: Login success: eem (uid=2)
16:37:03 [INFO] gameserver.network.server: Session registered: uid=2
16:37:03 [INFO] gameserver.network.server: Session upgraded: guest=-3 → uid=2
16:37:37 [INFO] __main__: Shutdown signal received — stopping …
16:37:37 [INFO] __main__: Shutting down …
16:37:37 [INFO] gameserver.persistence.state_save: Game state saved to state.yaml (2 empires, 0 attacks, 0 battles)
16:37:37 [INFO] websockets.server: server closing
16:37:37 [INFO] gameserver.network.server: Session removed: uid=2
16:37:37 [INFO] websockets.server: server closed
16:37:37 [INFO] gameserver.network.server: WebSocket server stopped
16:37:37 [INFO] __main__:   WebSocket server stopped
16:37:37 [INFO] __main__:   debug dashboard stopped
16:37:37 [INFO] __main__:   database closed
16:37:37 [INFO] __main__:   goodbye
16:37:39 [INFO] __main__: === Game Server starting ===
16:37:39 [INFO] __main__: Loading configuration …
16:37:39 [INFO] __main__:   items:        210 loaded from config
16:37:40 [INFO] __main__:   map:          4 paths, 23 build tiles from config/maps/default.yaml
16:37:40 [INFO] __main__:   ai_templates: 2 entries from config/ai_templates.yaml
16:37:40 [INFO] gameserver.loaders.game_config_loader: Loaded game config from config/game.yaml (29 keys)
16:37:40 [INFO] __main__:   game_config:  loaded
16:37:40 [INFO] __main__: Initializing persistence …
16:37:40 [INFO] gameserver.persistence.database: Database connected: gameserver.db
16:37:40 [INFO] __main__:   database:     connected (gameserver.db)
16:37:40 [INFO] gameserver.persistence.state_load: Restoring state from state.yaml (saved at 2026-02-08T16:37:37, version 1)
16:37:40 [INFO] gameserver.persistence.state_load: Restored 2 empires, 0 attacks, 0 battles
16:37:40 [INFO] __main__:   state:        restored from disk (2 empires, 0 attacks)
16:37:40 [INFO] __main__: Creating services …
16:37:40 [INFO] __main__:   upgrade_provider: 210 items registered
16:37:40 [INFO] __main__:   all services created
16:37:40 [INFO] __main__: Wiring event handlers …
16:37:40 [INFO] __main__:   event handlers registered
16:37:40 [INFO] gameserver.engine.empire_service: Empire registered: uid=100 name='TestImperium'
16:37:40 [INFO] gameserver.engine.empire_service: Empire 100: recalculated effects → {}
16:37:40 [INFO] gameserver.engine.empire_service: Empire registered: uid=2 name='Empire1'
16:37:40 [INFO] gameserver.engine.empire_service: Empire 2: recalculated effects → {'gold_offset': 0.15000000000000002, 'culture_offset': 0.15000000000000002, 'culture_modifier': 0.1, 'build_speed_modifier': 0.1}
16:37:40 [INFO] __main__: Restored 2 empires from saved state
16:37:40 [INFO] __main__: Starting network server …
16:37:40 [INFO] gameserver.network.handlers: Registered 29 message handlers: summary_request, item_request, military_request, new_item, new_structure, delete_structure, upgrade_structure, citizen_upgrade, change_citizen, increase_life, new_army, new_attack_request, change_army, new_wave, change_wave, end_siege, battle_register, battle_unregister, battle_next_wave_request, notification_request, user_message, timeline_request, userinfo_request, hall_of_fame_request, preferences_request, change_preferences, auth_request, signup, create_empire
16:37:40 [INFO] websockets.server: server listening on 0.0.0.0:8765
16:37:40 [INFO] gameserver.network.server: WebSocket server listening on ws://0.0.0.0:8765
16:37:40 [INFO] __main__:   WebSocket server listening on 0.0.0.0:8765
16:37:40 [INFO] gameserver.debug.dashboard: Debug dashboard running at http://0.0.0.0:9000/
16:37:40 [INFO] __main__: Starting game loop …
16:37:40 [INFO] __main__:   game loop running (1 s tick)
16:37:40 [INFO] websockets.server: connection open
16:37:40 [INFO] gameserver.network.server: Session registered: uid=-1
16:37:40 [INFO] gameserver.network.server: Client connected: uid=-1 remote=('192.168.178.2', 55787)
16:37:40 [INFO] gameserver.network.auth: Login success: eem (uid=2)
16:37:40 [INFO] gameserver.network.server: Session registered: uid=2
16:37:40 [INFO] gameserver.network.server: Session upgraded: guest=-1 → uid=2
16:37:45 [INFO] __main__: Shutdown signal received — stopping …
16:37:46 [INFO] __main__: Shutting down …
16:37:46 [INFO] gameserver.persistence.state_save: Game state saved to state.yaml (2 empires, 0 attacks, 0 battles)
16:37:46 [INFO] websockets.server: server closing
16:37:46 [INFO] gameserver.network.server: Session removed: uid=2
16:37:46 [INFO] websockets.server: server closed
16:37:46 [INFO] gameserver.network.server: WebSocket server stopped
16:37:46 [INFO] __main__:   WebSocket server stopped
16:37:46 [INFO] __main__:   debug dashboard stopped
16:37:46 [INFO] __main__:   database closed
16:37:46 [INFO] __main__:   goodbye
16:37:48 [INFO] __main__: === Game Server starting ===
16:37:48 [INFO] __main__: Loading configuration …
16:37:48 [INFO] __main__:   items:        210 loaded from config
16:37:48 [INFO] __main__:   map:          4 paths, 23 build tiles from config/maps/default.yaml
16:37:49 [INFO] __main__:   ai_templates: 2 entries from config/ai_templates.yaml
16:37:49 [INFO] gameserver.loaders.game_config_loader: Loaded game config from config/game.yaml (29 keys)
16:37:49 [INFO] __main__:   game_config:  loaded
16:37:49 [INFO] __main__: Initializing persistence …
16:37:49 [INFO] gameserver.persistence.database: Database connected: gameserver.db
16:37:49 [INFO] __main__:   database:     connected (gameserver.db)
16:37:49 [INFO] gameserver.persistence.state_load: Restoring state from state.yaml (saved at 2026-02-08T16:37:46, version 1)
16:37:49 [INFO] gameserver.persistence.state_load: Restored 2 empires, 0 attacks, 0 battles
16:37:49 [INFO] __main__:   state:        restored from disk (2 empires, 0 attacks)
16:37:49 [INFO] __main__: Creating services …
16:37:49 [INFO] __main__:   upgrade_provider: 210 items registered
16:37:49 [INFO] __main__:   all services created
16:37:49 [INFO] __main__: Wiring event handlers …
16:37:49 [INFO] __main__:   event handlers registered
16:37:49 [INFO] gameserver.engine.empire_service: Empire registered: uid=100 name='TestImperium'
16:37:49 [INFO] gameserver.engine.empire_service: Empire 100: recalculated effects → {}
16:37:49 [INFO] gameserver.engine.empire_service: Empire registered: uid=2 name='Empire1'
16:37:49 [INFO] gameserver.engine.empire_service: Empire 2: recalculated effects → {'gold_offset': 0.15000000000000002, 'culture_offset': 0.15000000000000002, 'culture_modifier': 0.1, 'build_speed_modifier': 0.1}
16:37:49 [INFO] __main__: Restored 2 empires from saved state
16:37:49 [INFO] __main__: Starting network server …
16:37:49 [INFO] gameserver.network.handlers: Registered 29 message handlers: summary_request, item_request, military_request, new_item, new_structure, delete_structure, upgrade_structure, citizen_upgrade, change_citizen, increase_life, new_army, new_attack_request, change_army, new_wave, change_wave, end_siege, battle_register, battle_unregister, battle_next_wave_request, notification_request, user_message, timeline_request, userinfo_request, hall_of_fame_request, preferences_request, change_preferences, auth_request, signup, create_empire
16:37:49 [INFO] websockets.server: server listening on 0.0.0.0:8765
16:37:49 [INFO] gameserver.network.server: WebSocket server listening on ws://0.0.0.0:8765
16:37:49 [INFO] __main__:   WebSocket server listening on 0.0.0.0:8765
16:37:49 [INFO] gameserver.debug.dashboard: Debug dashboard running at http://0.0.0.0:9000/
16:37:49 [INFO] __main__: Starting game loop …
16:37:49 [INFO] __main__:   game loop running (1 s tick)
16:37:49 [INFO] websockets.server: connection open
16:37:49 [INFO] gameserver.network.server: Session registered: uid=-1
16:37:49 [INFO] gameserver.network.server: Client connected: uid=-1 remote=('192.168.178.2', 55795)
16:37:49 [INFO] gameserver.network.auth: Login success: eem (uid=2)
16:37:49 [INFO] gameserver.network.server: Session registered: uid=2
16:37:49 [INFO] gameserver.network.server: Session upgraded: guest=-1 → uid=2
16:37:50 [INFO] gameserver.network.server: Session removed: uid=2
16:37:50 [INFO] websockets.server: connection open
16:37:50 [INFO] gameserver.network.server: Session registered: uid=-2
16:37:50 [INFO] gameserver.network.server: Client connected: uid=-2 remote=('192.168.178.2', 55798)
16:37:50 [INFO] gameserver.network.auth: Login success: eem (uid=2)
16:37:50 [INFO] gameserver.network.server: Session registered: uid=2
16:37:50 [INFO] gameserver.network.server: Session upgraded: guest=-2 → uid=2
16:38:05 [INFO] gameserver.network.handlers: change_citizen request from uid=2
16:38:05 [INFO] gameserver.network.handlers: change_citizen success uid=2: {'merchant': 1, 'scientist': 0, 'artist': 0, 'free': 6}
16:38:05 [INFO] gameserver.network.handlers: change_citizen request from uid=2
16:38:05 [INFO] gameserver.network.handlers: change_citizen success uid=2: {'merchant': 2, 'scientist': 0, 'artist': 0, 'free': 5}
16:38:05 [INFO] gameserver.network.handlers: change_citizen request from uid=2
16:38:05 [INFO] gameserver.network.handlers: change_citizen success uid=2: {'merchant': 3, 'scientist': 0, 'artist': 0, 'free': 4}
16:38:06 [INFO] gameserver.network.handlers: change_citizen request from uid=2
16:38:06 [INFO] gameserver.network.handlers: change_citizen success uid=2: {'merchant': 4, 'scientist': 0, 'artist': 0, 'free': 3}
16:38:06 [INFO] gameserver.network.handlers: change_citizen request from uid=2
16:38:06 [INFO] gameserver.network.handlers: change_citizen success uid=2: {'merchant': 5, 'scientist': 0, 'artist': 0, 'free': 2}
16:38:06 [INFO] gameserver.network.handlers: change_citizen request from uid=2
16:38:06 [INFO] gameserver.network.handlers: change_citizen success uid=2: {'merchant': 6, 'scientist': 0, 'artist': 0, 'free': 1}
16:38:06 [INFO] gameserver.network.handlers: change_citizen request from uid=2
16:38:06 [INFO] gameserver.network.handlers: change_citizen success uid=2: {'merchant': 7, 'scientist': 0, 'artist': 0, 'free': 0}
16:38:06 [INFO] gameserver.network.handlers: change_citizen request from uid=2
16:38:06 [INFO] gameserver.network.handlers: change_citizen failed uid=2: Too many citizens assigned (max 7, got 8)
16:38:06 [INFO] gameserver.network.handlers: change_citizen request from uid=2
16:38:06 [INFO] gameserver.network.handlers: change_citizen failed uid=2: Too many citizens assigned (max 7, got 8)
16:38:06 [INFO] gameserver.network.handlers: change_citizen request from uid=2
16:38:06 [INFO] gameserver.network.handlers: change_citizen failed uid=2: Too many citizens assigned (max 7, got 8)
16:38:07 [INFO] gameserver.network.handlers: change_citizen request from uid=2
16:38:07 [INFO] gameserver.network.handlers: change_citizen failed uid=2: Too many citizens assigned (max 7, got 8)
16:38:07 [INFO] gameserver.network.handlers: change_citizen request from uid=2
16:38:07 [INFO] gameserver.network.handlers: change_citizen failed uid=2: Too many citizens assigned (max 7, got 8)
16:38:07 [INFO] gameserver.network.handlers: change_citizen request from uid=2
16:38:07 [INFO] gameserver.network.handlers: change_citizen failed uid=2: Too many citizens assigned (max 7, got 8)
16:38:07 [INFO] gameserver.network.handlers: change_citizen request from uid=2
16:38:07 [INFO] gameserver.network.handlers: change_citizen failed uid=2: Too many citizens assigned (max 7, got 8)
16:45:13 [INFO] gameserver.network.server: Session removed: uid=2
16:45:13 [INFO] websockets.server: connection open
16:45:13 [INFO] gameserver.network.server: Session registered: uid=-3
16:45:13 [INFO] gameserver.network.server: Client connected: uid=-3 remote=('192.168.178.2', 60228)
16:45:13 [INFO] gameserver.network.auth: Login success: eem (uid=2)
16:45:13 [INFO] gameserver.network.server: Session registered: uid=2
16:45:13 [INFO] gameserver.network.server: Session upgraded: guest=-3 → uid=2
16:47:43 [INFO] gameserver.network.server: Session removed: uid=2
16:47:43 [INFO] websockets.server: connection open
16:47:43 [INFO] gameserver.network.server: Session registered: uid=-4
16:47:43 [INFO] gameserver.network.server: Client connected: uid=-4 remote=('192.168.178.2', 53192)
16:47:43 [INFO] gameserver.network.auth: Login success: eem (uid=2)
16:47:43 [INFO] gameserver.network.server: Session registered: uid=2
16:47:43 [INFO] gameserver.network.server: Session upgraded: guest=-4 → uid=2
16:49:52 [INFO] __main__: Shutdown signal received — stopping …
16:49:53 [INFO] __main__: Shutting down …
16:49:53 [INFO] gameserver.persistence.state_save: Game state saved to state.yaml (2 empires, 0 attacks, 0 battles)
16:49:53 [INFO] websockets.server: server closing
16:49:53 [INFO] gameserver.network.server: Session removed: uid=2
16:49:53 [INFO] websockets.server: server closed
16:49:53 [INFO] gameserver.network.server: WebSocket server stopped
16:49:53 [INFO] __main__:   WebSocket server stopped
16:49:53 [INFO] __main__:   debug dashboard stopped
16:49:53 [INFO] __main__:   database closed
16:49:53 [INFO] __main__:   goodbye
16:49:55 [INFO] __main__: === Game Server starting ===
16:49:55 [INFO] __main__: Loading configuration …
16:49:55 [INFO] __main__:   items:        210 loaded from config
16:49:56 [INFO] __main__:   map:          4 paths, 23 build tiles from config/maps/default.yaml
16:49:56 [INFO] __main__:   ai_templates: 2 entries from config/ai_templates.yaml
16:49:56 [INFO] gameserver.loaders.game_config_loader: Loaded game config from config/game.yaml (29 keys)
16:49:56 [INFO] __main__:   game_config:  loaded
16:49:56 [INFO] __main__: Initializing persistence …
16:49:56 [INFO] gameserver.persistence.database: Database connected: gameserver.db
16:49:56 [INFO] __main__:   database:     connected (gameserver.db)
16:49:56 [INFO] gameserver.persistence.state_load: Restoring state from state.yaml (saved at 2026-02-08T16:49:53, version 1)
16:49:56 [INFO] gameserver.persistence.state_load: Restored 2 empires, 0 attacks, 0 battles
16:49:56 [INFO] __main__:   state:        restored from disk (2 empires, 0 attacks)
16:49:56 [INFO] __main__: Creating services …
16:49:56 [INFO] __main__:   upgrade_provider: 210 items registered
16:49:56 [INFO] __main__:   all services created
16:49:56 [INFO] __main__: Wiring event handlers …
16:49:56 [INFO] __main__:   event handlers registered
16:49:56 [INFO] gameserver.engine.empire_service: Empire registered: uid=100 name='TestImperium'
16:49:56 [INFO] gameserver.engine.empire_service: Empire 100: recalculated effects → {}
16:49:56 [INFO] gameserver.engine.empire_service: Empire registered: uid=2 name='Empire1'
16:49:56 [INFO] gameserver.engine.empire_service: Empire 2: recalculated effects → {'life_offset': 0.01, 'gold_offset': 0.15000000000000002, 'culture_offset': 0.15000000000000002, 'culture_modifier': 0.1, 'build_speed_modifier': 0.1}
16:49:56 [INFO] __main__: Restored 2 empires from saved state
16:49:56 [INFO] __main__: Starting network server …
16:49:56 [INFO] gameserver.network.handlers: Registered 29 message handlers: summary_request, item_request, military_request, new_item, new_structure, delete_structure, upgrade_structure, citizen_upgrade, change_citizen, increase_life, new_army, new_attack_request, change_army, new_wave, change_wave, end_siege, battle_register, battle_unregister, battle_next_wave_request, notification_request, user_message, timeline_request, userinfo_request, hall_of_fame_request, preferences_request, change_preferences, auth_request, signup, create_empire
16:49:56 [INFO] websockets.server: server listening on 0.0.0.0:8765
16:49:56 [INFO] gameserver.network.server: WebSocket server listening on ws://0.0.0.0:8765
16:49:56 [INFO] __main__:   WebSocket server listening on 0.0.0.0:8765
16:49:56 [INFO] gameserver.debug.dashboard: Debug dashboard running at http://0.0.0.0:9000/
16:49:56 [INFO] __main__: Starting game loop …
16:49:56 [INFO] __main__:   game loop running (1 s tick)
16:49:56 [INFO] websockets.server: connection open
16:49:56 [INFO] gameserver.network.server: Session registered: uid=-1
16:49:56 [INFO] gameserver.network.server: Client connected: uid=-1 remote=('192.168.178.2', 63406)
16:49:56 [INFO] gameserver.network.auth: Login success: eem (uid=2)
16:49:56 [INFO] gameserver.network.server: Session registered: uid=2
16:49:56 [INFO] gameserver.network.server: Session upgraded: guest=-1 → uid=2
16:49:57 [INFO] gameserver.network.server: Session removed: uid=2
16:49:57 [INFO] websockets.server: connection open
16:49:57 [INFO] gameserver.network.server: Session registered: uid=-2
16:49:57 [INFO] gameserver.network.server: Client connected: uid=-2 remote=('192.168.178.2', 63411)
16:49:57 [INFO] gameserver.network.auth: Login success: eem (uid=2)
16:49:57 [INFO] gameserver.network.server: Session registered: uid=2
16:49:57 [INFO] gameserver.network.server: Session upgraded: guest=-2 → uid=2
17:01:13 [INFO] gameserver.engine.empire_service: Empire 2: building BOW_MAKER completed
17:11:46 [INFO] gameserver.network.server: Session removed: uid=2
17:11:46 [INFO] websockets.server: connection open
17:11:46 [INFO] gameserver.network.server: Session registered: uid=-3
17:11:46 [INFO] gameserver.network.server: Client connected: uid=-3 remote=('192.168.178.2', 58824)
17:11:46 [INFO] gameserver.network.auth: Login success: eem (uid=2)
17:11:46 [INFO] gameserver.network.server: Session registered: uid=2
17:11:46 [INFO] gameserver.network.server: Session upgraded: guest=-3 → uid=2
17:12:13 [INFO] gameserver.network.server: Session removed: uid=2
17:12:13 [INFO] websockets.server: connection open
17:12:13 [INFO] gameserver.network.server: Session registered: uid=-4
17:12:13 [INFO] gameserver.network.server: Client connected: uid=-4 remote=('192.168.178.2', 53561)
17:12:13 [INFO] gameserver.network.auth: Login success: eem (uid=2)
17:12:13 [INFO] gameserver.network.server: Session registered: uid=2
17:12:13 [INFO] gameserver.network.server: Session upgraded: guest=-4 → uid=2
17:12:24 [INFO] __main__: Shutdown signal received — stopping …
17:12:25 [INFO] __main__: Shutting down …
17:12:25 [INFO] gameserver.persistence.state_save: Game state saved to state.yaml (2 empires, 0 attacks, 0 battles)
17:12:25 [INFO] websockets.server: server closing
17:12:25 [INFO] gameserver.network.server: Session removed: uid=2
17:12:25 [INFO] websockets.server: server closed
17:12:25 [INFO] gameserver.network.server: WebSocket server stopped
17:12:25 [INFO] __main__:   WebSocket server stopped
17:12:25 [INFO] __main__:   debug dashboard stopped
17:12:25 [INFO] __main__:   database closed
17:12:25 [INFO] __main__:   goodbye
17:12:42 [INFO] __main__: === Game Server starting ===
17:12:42 [INFO] __main__: Loading configuration …
17:12:43 [INFO] __main__:   items:        210 loaded from config
17:12:43 [INFO] __main__:   map:          4 paths, 23 build tiles from config/maps/default.yaml
17:12:43 [INFO] __main__:   ai_templates: 2 entries from config/ai_templates.yaml
17:12:43 [INFO] gameserver.loaders.game_config_loader: Loaded game config from config/game.yaml (29 keys)
17:12:43 [INFO] __main__:   game_config:  loaded
17:12:43 [INFO] __main__: Initializing persistence …
17:12:43 [INFO] gameserver.persistence.database: Database connected: gameserver.db
17:12:43 [INFO] __main__:   database:     connected (gameserver.db)
17:12:43 [INFO] gameserver.persistence.state_load: Restoring state from state.yaml (saved at 2026-02-08T17:12:25, version 1)
17:12:43 [INFO] gameserver.persistence.state_load: Restored 2 empires, 0 attacks, 0 battles
17:12:43 [INFO] __main__:   state:        restored from disk (2 empires, 0 attacks)
17:12:43 [INFO] __main__: Creating services …
17:12:43 [INFO] __main__:   upgrade_provider: 210 items registered
17:12:43 [INFO] __main__:   all services created
17:12:43 [INFO] __main__: Wiring event handlers …
17:12:43 [INFO] __main__:   event handlers registered
17:12:43 [INFO] gameserver.engine.empire_service: Empire registered: uid=100 name='TestImperium'
17:12:43 [INFO] gameserver.engine.empire_service: Empire 100: recalculated effects → {}
17:12:43 [INFO] gameserver.engine.empire_service: Empire registered: uid=2 name='Empire1'
17:12:43 [INFO] gameserver.engine.empire_service: Empire 2: recalculated effects → {'life_offset': 0.01, 'gold_offset': 0.15000000000000002, 'culture_offset': 0.15000000000000002, 'culture_modifier': 0.1, 'build_speed_modifier': 0.1}
17:12:43 [INFO] __main__: Restored 2 empires from saved state
17:12:43 [INFO] __main__: Starting network server …
17:12:43 [INFO] gameserver.network.handlers: Registered 29 message handlers: summary_request, item_request, military_request, new_item, new_structure, delete_structure, upgrade_structure, citizen_upgrade, change_citizen, increase_life, new_army, new_attack_request, change_army, new_wave, change_wave, end_siege, battle_register, battle_unregister, battle_next_wave_request, notification_request, user_message, timeline_request, userinfo_request, hall_of_fame_request, preferences_request, change_preferences, auth_request, signup, create_empire
17:12:43 [INFO] websockets.server: server listening on 0.0.0.0:8765
17:12:43 [INFO] gameserver.network.server: WebSocket server listening on ws://0.0.0.0:8765
17:12:43 [INFO] __main__:   WebSocket server listening on 0.0.0.0:8765
17:12:43 [INFO] gameserver.debug.dashboard: Debug dashboard running at http://0.0.0.0:9000/
17:12:43 [INFO] __main__: Starting game loop …
17:12:43 [INFO] __main__:   game loop running (1 s tick)
17:12:45 [INFO] websockets.server: connection open
17:12:45 [INFO] gameserver.network.server: Session registered: uid=-1
17:12:45 [INFO] gameserver.network.server: Client connected: uid=-1 remote=('192.168.178.2', 53590)
17:12:45 [INFO] gameserver.network.auth: Login success: eem (uid=2)
17:12:45 [INFO] gameserver.network.server: Session registered: uid=2
17:12:45 [INFO] gameserver.network.server: Session upgraded: guest=-1 → uid=2
17:13:17 [INFO] __main__: Shutdown signal received — stopping …
17:13:17 [INFO] __main__: Shutting down …
17:13:17 [INFO] gameserver.persistence.state_save: Game state saved to state.yaml (2 empires, 0 attacks, 0 battles)
17:13:17 [INFO] websockets.server: server closing
17:13:17 [INFO] gameserver.network.server: Session removed: uid=2
17:13:17 [INFO] websockets.server: server closed
17:13:17 [INFO] gameserver.network.server: WebSocket server stopped
17:13:17 [INFO] __main__:   WebSocket server stopped
17:13:17 [INFO] __main__:   debug dashboard stopped
17:13:17 [INFO] __main__:   database closed
17:13:17 [INFO] __main__:   goodbye
17:13:19 [INFO] __main__: === Game Server starting ===
17:13:19 [INFO] __main__: Loading configuration …
17:13:20 [INFO] __main__:   items:        210 loaded from config
17:13:20 [INFO] __main__:   map:          4 paths, 23 build tiles from config/maps/default.yaml
17:13:20 [INFO] __main__:   ai_templates: 2 entries from config/ai_templates.yaml
17:13:20 [INFO] gameserver.loaders.game_config_loader: Loaded game config from config/game.yaml (29 keys)
17:13:20 [INFO] __main__:   game_config:  loaded
17:13:20 [INFO] __main__: Initializing persistence …
17:13:20 [INFO] gameserver.persistence.database: Database connected: gameserver.db
17:13:20 [INFO] __main__:   database:     connected (gameserver.db)
17:13:20 [INFO] gameserver.persistence.state_load: Restoring state from state.yaml (saved at 2026-02-08T17:13:17, version 1)
17:13:20 [INFO] gameserver.persistence.state_load: Restored 2 empires, 0 attacks, 0 battles
17:13:20 [INFO] __main__:   state:        restored from disk (2 empires, 0 attacks)
17:13:20 [INFO] __main__: Creating services …
17:13:20 [INFO] __main__:   upgrade_provider: 210 items registered
17:13:20 [INFO] __main__:   all services created
17:13:20 [INFO] __main__: Wiring event handlers …
17:13:20 [INFO] __main__:   event handlers registered
17:13:20 [INFO] gameserver.engine.empire_service: Empire registered: uid=100 name='TestImperium'
17:13:20 [INFO] gameserver.engine.empire_service: Empire 100: recalculated effects → {}
17:13:20 [INFO] gameserver.engine.empire_service: Empire registered: uid=2 name='Empire1'
17:13:20 [INFO] gameserver.engine.empire_service: Empire 2: recalculated effects → {'life_offset': 0.001, 'gold_offset': 0.15000000000000002, 'culture_offset': 0.15000000000000002, 'culture_modifier': 0.1, 'build_speed_modifier': 0.1}
17:13:20 [INFO] __main__: Restored 2 empires from saved state
17:13:20 [INFO] __main__: Starting network server …
17:13:20 [INFO] gameserver.network.handlers: Registered 29 message handlers: summary_request, item_request, military_request, new_item, new_structure, delete_structure, upgrade_structure, citizen_upgrade, change_citizen, increase_life, new_army, new_attack_request, change_army, new_wave, change_wave, end_siege, battle_register, battle_unregister, battle_next_wave_request, notification_request, user_message, timeline_request, userinfo_request, hall_of_fame_request, preferences_request, change_preferences, auth_request, signup, create_empire
17:13:20 [INFO] websockets.server: server listening on 0.0.0.0:8765
17:13:20 [INFO] gameserver.network.server: WebSocket server listening on ws://0.0.0.0:8765
17:13:20 [INFO] __main__:   WebSocket server listening on 0.0.0.0:8765
17:13:20 [INFO] gameserver.debug.dashboard: Debug dashboard running at http://0.0.0.0:9000/
17:13:20 [INFO] __main__: Starting game loop …
17:13:20 [INFO] __main__:   game loop running (1 s tick)
17:13:20 [INFO] websockets.server: connection open
17:13:20 [INFO] gameserver.network.server: Session registered: uid=-1
17:13:20 [INFO] gameserver.network.server: Client connected: uid=-1 remote=('192.168.178.2', 49435)
17:13:20 [INFO] gameserver.network.auth: Login success: eem (uid=2)
17:13:20 [INFO] gameserver.network.server: Session registered: uid=2
17:13:20 [INFO] gameserver.network.server: Session upgraded: guest=-1 → uid=2
17:14:30 [INFO] gameserver.network.handlers: citizen_upgrade request from uid=2
17:14:30 [INFO] gameserver.network.handlers: citizen_upgrade failed uid=2: Not enough culture (need 1522.9, have 1438.2)
17:16:09 [INFO] gameserver.network.server: Session removed: uid=2
17:16:09 [INFO] websockets.server: connection open
17:16:09 [INFO] gameserver.network.server: Session registered: uid=-2
17:16:09 [INFO] gameserver.network.server: Client connected: uid=-2 remote=('192.168.178.2', 62467)
17:16:09 [INFO] gameserver.network.auth: Login success: eem (uid=2)
17:16:09 [INFO] gameserver.network.server: Session registered: uid=2
17:16:09 [INFO] gameserver.network.server: Session upgraded: guest=-2 → uid=2
17:16:42 [INFO] gameserver.network.handlers: change_citizen request from uid=2
17:16:42 [INFO] gameserver.network.handlers: change_citizen success uid=2: {'merchant': 6, 'scientist': 0, 'artist': 0, 'free': 1}
17:16:42 [INFO] gameserver.network.handlers: change_citizen request from uid=2
17:16:42 [INFO] gameserver.network.handlers: change_citizen success uid=2: {'merchant': 5, 'scientist': 0, 'artist': 0, 'free': 2}
17:16:42 [INFO] gameserver.network.handlers: change_citizen request from uid=2
17:16:42 [INFO] gameserver.network.handlers: change_citizen success uid=2: {'merchant': 4, 'scientist': 0, 'artist': 0, 'free': 3}
17:16:42 [INFO] gameserver.network.handlers: change_citizen request from uid=2
17:16:42 [INFO] gameserver.network.handlers: change_citizen success uid=2: {'merchant': 3, 'scientist': 0, 'artist': 0, 'free': 4}
17:16:42 [INFO] gameserver.network.handlers: change_citizen request from uid=2
17:16:42 [INFO] gameserver.network.handlers: change_citizen success uid=2: {'merchant': 2, 'scientist': 0, 'artist': 0, 'free': 5}
17:16:42 [INFO] gameserver.network.handlers: change_citizen request from uid=2
17:16:42 [INFO] gameserver.network.handlers: change_citizen success uid=2: {'merchant': 1, 'scientist': 0, 'artist': 0, 'free': 6}
17:16:42 [INFO] gameserver.network.handlers: change_citizen request from uid=2
17:16:42 [INFO] gameserver.network.handlers: change_citizen success uid=2: {'merchant': 0, 'scientist': 0, 'artist': 0, 'free': 7}
17:16:43 [INFO] gameserver.network.handlers: change_citizen request from uid=2
17:16:43 [INFO] gameserver.network.handlers: change_citizen success uid=2: {'merchant': 0, 'scientist': 1, 'artist': 0, 'free': 6}
17:16:44 [INFO] gameserver.network.handlers: change_citizen request from uid=2
17:16:44 [INFO] gameserver.network.handlers: change_citizen success uid=2: {'merchant': 0, 'scientist': 2, 'artist': 0, 'free': 5}
17:16:44 [INFO] gameserver.network.handlers: change_citizen request from uid=2
17:16:44 [INFO] gameserver.network.handlers: change_citizen success uid=2: {'merchant': 0, 'scientist': 3, 'artist': 0, 'free': 4}
17:16:44 [INFO] gameserver.network.handlers: change_citizen request from uid=2
17:16:44 [INFO] gameserver.network.handlers: change_citizen success uid=2: {'merchant': 0, 'scientist': 4, 'artist': 0, 'free': 3}
17:16:44 [INFO] gameserver.network.handlers: change_citizen request from uid=2
17:16:44 [INFO] gameserver.network.handlers: change_citizen success uid=2: {'merchant': 0, 'scientist': 5, 'artist': 0, 'free': 2}
17:16:44 [INFO] gameserver.network.handlers: change_citizen request from uid=2
17:16:44 [INFO] gameserver.network.handlers: change_citizen success uid=2: {'merchant': 0, 'scientist': 6, 'artist': 0, 'free': 1}
17:16:44 [INFO] gameserver.network.handlers: change_citizen request from uid=2
17:16:44 [INFO] gameserver.network.handlers: change_citizen success uid=2: {'merchant': 0, 'scientist': 7, 'artist': 0, 'free': 0}
17:16:44 [INFO] gameserver.network.handlers: change_citizen request from uid=2
17:16:44 [INFO] gameserver.network.handlers: change_citizen failed uid=2: Too many citizens assigned (max 7, got 8)
17:16:45 [INFO] gameserver.network.handlers: change_citizen request from uid=2
17:16:45 [INFO] gameserver.network.handlers: change_citizen failed uid=2: Too many citizens assigned (max 7, got 8)
17:18:31 [INFO] gameserver.network.server: Session removed: uid=2
17:18:31 [INFO] websockets.server: connection open
17:18:31 [INFO] gameserver.network.server: Session registered: uid=-3
17:18:31 [INFO] gameserver.network.server: Client connected: uid=-3 remote=('192.168.178.2', 56303)
17:18:31 [INFO] gameserver.network.auth: Login success: eem (uid=2)
17:18:31 [INFO] gameserver.network.server: Session registered: uid=2
17:18:31 [INFO] gameserver.network.server: Session upgraded: guest=-3 → uid=2
17:18:47 [INFO] gameserver.network.handlers: change_citizen request from uid=2
17:18:47 [INFO] gameserver.network.handlers: change_citizen success uid=2: {'merchant': 0, 'scientist': 6, 'artist': 0, 'free': 1}
17:18:47 [INFO] gameserver.network.handlers: change_citizen request from uid=2
17:18:47 [INFO] gameserver.network.handlers: change_citizen success uid=2: {'merchant': 0, 'scientist': 5, 'artist': 0, 'free': 2}
17:18:48 [INFO] gameserver.network.handlers: change_citizen request from uid=2
17:18:48 [INFO] gameserver.network.handlers: change_citizen success uid=2: {'merchant': 0, 'scientist': 4, 'artist': 0, 'free': 3}
17:18:48 [INFO] gameserver.network.handlers: change_citizen request from uid=2
17:18:48 [INFO] gameserver.network.handlers: change_citizen success uid=2: {'merchant': 0, 'scientist': 3, 'artist': 0, 'free': 4}
17:18:48 [INFO] gameserver.network.handlers: change_citizen request from uid=2
17:18:48 [INFO] gameserver.network.handlers: change_citizen success uid=2: {'merchant': 0, 'scientist': 2, 'artist': 0, 'free': 5}
17:18:48 [INFO] gameserver.network.handlers: change_citizen request from uid=2
17:18:48 [INFO] gameserver.network.handlers: change_citizen success uid=2: {'merchant': 0, 'scientist': 1, 'artist': 0, 'free': 6}
17:18:48 [INFO] gameserver.network.handlers: change_citizen request from uid=2
17:18:48 [INFO] gameserver.network.handlers: change_citizen success uid=2: {'merchant': 0, 'scientist': 0, 'artist': 0, 'free': 7}
17:18:50 [INFO] gameserver.network.handlers: change_citizen request from uid=2
17:18:50 [INFO] gameserver.network.handlers: change_citizen success uid=2: {'merchant': 0, 'scientist': 1, 'artist': 0, 'free': 6}
17:18:52 [INFO] gameserver.network.handlers: change_citizen request from uid=2
17:18:52 [INFO] gameserver.network.handlers: change_citizen success uid=2: {'merchant': 0, 'scientist': 0, 'artist': 0, 'free': 7}
17:18:59 [INFO] gameserver.network.handlers: change_citizen request from uid=2
17:18:59 [INFO] gameserver.network.handlers: change_citizen success uid=2: {'merchant': 0, 'scientist': 1, 'artist': 0, 'free': 6}
17:19:01 [INFO] gameserver.network.handlers: change_citizen request from uid=2
17:19:01 [INFO] gameserver.network.handlers: change_citizen success uid=2: {'merchant': 0, 'scientist': 0, 'artist': 0, 'free': 7}
17:19:18 [INFO] gameserver.network.handlers: change_citizen request from uid=2
17:19:18 [INFO] gameserver.network.handlers: change_citizen success uid=2: {'merchant': 0, 'scientist': 1, 'artist': 0, 'free': 6}
17:20:03 [INFO] gameserver.network.server: Session removed: uid=2
17:20:03 [INFO] websockets.server: connection open
17:20:03 [INFO] gameserver.network.server: Session registered: uid=-4
17:20:03 [INFO] gameserver.network.server: Client connected: uid=-4 remote=('192.168.178.2', 52342)
17:20:03 [INFO] gameserver.network.auth: Login success: eem (uid=2)
17:20:03 [INFO] gameserver.network.server: Session registered: uid=2
17:20:03 [INFO] gameserver.network.server: Session upgraded: guest=-4 → uid=2
17:20:07 [INFO] gameserver.network.handlers: change_citizen request from uid=2
17:20:07 [INFO] gameserver.network.handlers: change_citizen success uid=2: {'merchant': 0, 'scientist': 0, 'artist': 0, 'free': 7}
17:20:35 [INFO] gameserver.network.server: Session removed: uid=2
17:20:35 [INFO] websockets.server: connection open
17:20:35 [INFO] gameserver.network.server: Session registered: uid=-5
17:20:35 [INFO] gameserver.network.server: Client connected: uid=-5 remote=('192.168.178.2', 50905)
17:20:35 [INFO] gameserver.network.auth: Login success: eem (uid=2)
17:20:35 [INFO] gameserver.network.server: Session registered: uid=2
17:20:35 [INFO] gameserver.network.server: Session upgraded: guest=-5 → uid=2
17:20:44 [INFO] gameserver.network.handlers: change_citizen request from uid=2
17:20:44 [INFO] gameserver.network.handlers: change_citizen success uid=2: {'merchant': 0, 'scientist': 1, 'artist': 0, 'free': 6}
17:20:46 [INFO] gameserver.network.handlers: change_citizen request from uid=2
17:20:46 [INFO] gameserver.network.handlers: change_citizen success uid=2: {'merchant': 0, 'scientist': 0, 'artist': 0, 'free': 7}
17:20:47 [INFO] gameserver.network.handlers: change_citizen request from uid=2
17:20:47 [INFO] gameserver.network.handlers: change_citizen success uid=2: {'merchant': 0, 'scientist': 0, 'artist': 1, 'free': 6}
17:20:49 [INFO] gameserver.network.handlers: change_citizen request from uid=2
17:20:49 [INFO] gameserver.network.handlers: change_citizen success uid=2: {'merchant': 0, 'scientist': 0, 'artist': 0, 'free': 7}
17:36:34 [INFO] gameserver.network.handlers: change_citizen request from uid=2
17:36:34 [INFO] gameserver.network.handlers: change_citizen success uid=2: {'merchant': 0, 'scientist': 0, 'artist': 1, 'free': 6}
17:36:35 [INFO] gameserver.network.handlers: change_citizen request from uid=2
17:36:35 [INFO] gameserver.network.handlers: change_citizen success uid=2: {'merchant': 0, 'scientist': 0, 'artist': 2, 'free': 5}
17:36:35 [INFO] gameserver.network.handlers: change_citizen request from uid=2
17:36:35 [INFO] gameserver.network.handlers: change_citizen success uid=2: {'merchant': 0, 'scientist': 0, 'artist': 3, 'free': 4}
17:36:35 [INFO] gameserver.network.handlers: change_citizen request from uid=2
17:36:35 [INFO] gameserver.network.handlers: change_citizen success uid=2: {'merchant': 0, 'scientist': 1, 'artist': 3, 'free': 3}
17:36:35 [INFO] gameserver.network.handlers: change_citizen request from uid=2
17:36:35 [INFO] gameserver.network.handlers: change_citizen success uid=2: {'merchant': 0, 'scientist': 2, 'artist': 3, 'free': 2}
17:36:35 [INFO] gameserver.network.handlers: change_citizen request from uid=2
17:36:35 [INFO] gameserver.network.handlers: change_citizen success uid=2: {'merchant': 0, 'scientist': 3, 'artist': 3, 'free': 1}
17:36:36 [INFO] gameserver.network.handlers: change_citizen request from uid=2
17:36:36 [INFO] gameserver.network.handlers: change_citizen success uid=2: {'merchant': 1, 'scientist': 3, 'artist': 3, 'free': 0}
17:36:36 [INFO] gameserver.network.handlers: change_citizen request from uid=2
17:36:36 [INFO] gameserver.network.handlers: change_citizen failed uid=2: Too many citizens assigned (max 7, got 8)
17:36:36 [INFO] gameserver.network.handlers: change_citizen request from uid=2
17:36:36 [INFO] gameserver.network.handlers: change_citizen failed uid=2: Too many citizens assigned (max 7, got 8)
17:36:39 [INFO] gameserver.network.handlers: citizen_upgrade request from uid=2
17:36:39 [INFO] gameserver.network.handlers: citizen_upgrade success uid=2
17:36:41 [INFO] gameserver.network.handlers: change_citizen request from uid=2
17:36:41 [INFO] gameserver.network.handlers: change_citizen success uid=2: {'merchant': 2, 'scientist': 3, 'artist': 3, 'free': 0}
17:36:46 [INFO] gameserver.engine.empire_service: Empire 2: started building EXCHANGE_POST (effort=1500.0)
17:36:46 [INFO] gameserver.network.handlers: new_item success uid=2 iid=EXCHANGE_POST
17:39:06 [INFO] gameserver.network.server: Session removed: uid=2
17:39:06 [INFO] websockets.server: connection open
17:39:06 [INFO] gameserver.network.server: Session registered: uid=-6
17:39:06 [INFO] gameserver.network.server: Client connected: uid=-6 remote=('192.168.178.2', 56695)
17:39:06 [INFO] gameserver.network.auth: Login success: eem (uid=2)
17:39:06 [INFO] gameserver.network.server: Session registered: uid=2
17:39:06 [INFO] gameserver.network.server: Session upgraded: guest=-6 → uid=2
17:39:48 [INFO] gameserver.network.server: Session removed: uid=2
17:39:48 [INFO] websockets.server: connection open
17:39:48 [INFO] gameserver.network.server: Session registered: uid=-7
17:39:48 [INFO] gameserver.network.server: Client connected: uid=-7 remote=('192.168.178.2', 53061)
17:39:48 [INFO] gameserver.network.auth: Login success: eem (uid=2)
17:39:48 [INFO] gameserver.network.server: Session registered: uid=2
17:39:48 [INFO] gameserver.network.server: Session upgraded: guest=-7 → uid=2
17:40:19 [INFO] gameserver.network.server: Session removed: uid=2
17:40:19 [INFO] websockets.server: connection open
17:40:19 [INFO] gameserver.network.server: Session registered: uid=-8
17:40:19 [INFO] gameserver.network.server: Client connected: uid=-8 remote=('192.168.178.2', 53097)
17:40:19 [INFO] gameserver.network.auth: Login success: eem (uid=2)
17:40:19 [INFO] gameserver.network.server: Session registered: uid=2
17:40:19 [INFO] gameserver.network.server: Session upgraded: guest=-8 → uid=2
17:42:27 [INFO] websockets.server: connection open
17:42:27 [INFO] gameserver.network.server: Session registered: uid=-9
17:42:27 [INFO] gameserver.network.server: Client connected: uid=-9 remote=('127.0.0.1', 48228)
17:42:31 [INFO] gameserver.network.auth: Login success: eem (uid=2)
17:42:31 [INFO] gameserver.network.server: Session registered: uid=2
17:42:31 [INFO] gameserver.network.server: Session upgraded: guest=-9 → uid=2
17:42:31 [INFO] gameserver.network.server: Client disconnected: uid=-8 code=1008
17:42:31 [INFO] gameserver.network.server: Session removed: uid=2
17:42:34 [INFO] websockets.server: connection open
17:42:34 [INFO] gameserver.network.server: Session registered: uid=-10
17:42:34 [INFO] gameserver.network.server: Client connected: uid=-10 remote=('192.168.178.2', 64305)
17:42:34 [INFO] gameserver.network.auth: Login success: eem (uid=2)
17:42:34 [INFO] gameserver.network.server: Session registered: uid=2
17:42:34 [INFO] gameserver.network.server: Session upgraded: guest=-10 → uid=2
17:43:13 [INFO] gameserver.engine.empire_service: Empire 2: applied effects for EXCHANGE_POST: {'gold_modifier': 0.1, 'gold_offset': 0.05}
17:43:13 [INFO] gameserver.engine.empire_service: Empire 2: building EXCHANGE_POST completed
17:43:37 [INFO] gameserver.network.server: Client disconnected: uid=-9 code=CloseCode.ABNORMAL_CLOSURE
17:43:37 [INFO] gameserver.network.server: Session removed: uid=2
17:43:45 [INFO] websockets.server: connection open
17:43:45 [INFO] gameserver.network.server: Session registered: uid=-11
17:43:45 [INFO] gameserver.network.server: Client connected: uid=-11 remote=('127.0.0.1', 48294)
17:43:45 [INFO] gameserver.network.auth: Login success: eem (uid=2)
17:43:45 [INFO] gameserver.network.server: Session registered: uid=2
17:43:45 [INFO] gameserver.network.server: Session upgraded: guest=-11 → uid=2
17:50:12 [INFO] __main__: Shutdown signal received — stopping …
17:50:13 [INFO] __main__: Shutting down …
17:50:13 [INFO] gameserver.persistence.state_save: Game state saved to state.yaml (2 empires, 0 attacks, 0 battles)
17:50:13 [INFO] websockets.server: server closing
17:50:13 [INFO] gameserver.network.server: Session removed: uid=2
17:50:13 [INFO] gameserver.network.server: Session removed: uid=2
17:50:13 [INFO] websockets.server: server closed
17:50:13 [INFO] gameserver.network.server: WebSocket server stopped
17:50:13 [INFO] __main__:   WebSocket server stopped
17:50:13 [INFO] __main__:   debug dashboard stopped
17:50:13 [INFO] __main__:   database closed
17:50:13 [INFO] __main__:   goodbye
17:53:53 [INFO] __main__: === Game Server starting ===
17:53:53 [INFO] __main__: Loading configuration …
17:53:54 [INFO] __main__:   items:        210 loaded from config
17:53:54 [INFO] __main__:   map:          4 paths, 23 build tiles from config/maps/default.yaml
17:53:54 [INFO] __main__:   ai_templates: 2 entries from config/ai_templates.yaml
17:53:54 [INFO] gameserver.loaders.game_config_loader: Loaded game config from config/game.yaml (29 keys)
17:53:54 [INFO] __main__:   game_config:  loaded
17:53:54 [INFO] __main__: Initializing persistence …
17:53:54 [INFO] gameserver.persistence.database: Database connected: gameserver.db
17:53:54 [INFO] __main__:   database:     connected (gameserver.db)
17:53:54 [INFO] gameserver.persistence.state_load: Restoring state from state.yaml (saved at 2026-02-08T17:53:52, version 1)
17:53:54 [INFO] gameserver.persistence.state_load: Restored 2 empires, 0 attacks, 0 battles
17:53:54 [INFO] __main__:   state:        restored from disk (2 empires, 0 attacks)
17:53:54 [INFO] __main__: Creating services …
17:53:54 [INFO] __main__:   upgrade_provider: 210 items registered
17:53:54 [INFO] __main__:   all services created
17:53:54 [INFO] __main__: Wiring event handlers …
17:53:54 [INFO] __main__:   event handlers registered
17:53:54 [INFO] gameserver.engine.empire_service: Empire registered: uid=100 name='TestImperium'
17:53:54 [INFO] gameserver.engine.empire_service: Empire 100: recalculated effects → {}
17:53:54 [INFO] gameserver.engine.empire_service: Empire registered: uid=2 name='Empire1'
17:53:54 [INFO] gameserver.engine.empire_service: Empire 2: recalculated effects → {'life_offset': 0.001, 'gold_offset': 0.2, 'culture_offset': 0.15000000000000002, 'culture_modifier': 0.1, 'gold_modifier': 0.1, 'build_speed_modifier': 0.1}
17:53:54 [INFO] __main__: Restored 2 empires from saved state
17:53:54 [INFO] __main__: Starting network server …
17:53:54 [INFO] gameserver.network.handlers: Registered 29 message handlers: summary_request, item_request, military_request, new_item, new_structure, delete_structure, upgrade_structure, citizen_upgrade, change_citizen, increase_life, new_army, new_attack_request, change_army, new_wave, change_wave, end_siege, battle_register, battle_unregister, battle_next_wave_request, notification_request, user_message, timeline_request, userinfo_request, hall_of_fame_request, preferences_request, change_preferences, auth_request, signup, create_empire
17:53:54 [INFO] websockets.server: server listening on 0.0.0.0:8765
17:53:54 [INFO] gameserver.network.server: WebSocket server listening on ws://0.0.0.0:8765
17:53:54 [INFO] __main__:   WebSocket server listening on 0.0.0.0:8765
17:53:54 [INFO] gameserver.debug.dashboard: Debug dashboard running at http://0.0.0.0:9000/
17:53:54 [INFO] __main__: Starting game loop …
17:53:54 [INFO] __main__:   game loop running (1 s tick)
17:53:55 [INFO] websockets.server: connection open
17:53:55 [INFO] gameserver.network.server: Session registered: uid=-1
17:53:55 [INFO] gameserver.network.server: Client connected: uid=-1 remote=('127.0.0.1', 48580)
17:53:55 [INFO] gameserver.network.auth: Login success: eem (uid=2)
17:53:55 [INFO] gameserver.network.server: Session registered: uid=2
17:53:55 [INFO] gameserver.network.server: Session upgraded: guest=-1 → uid=2
17:56:35 [INFO] gameserver.network.server: Client disconnected: uid=-1 code=CloseCode.ABNORMAL_CLOSURE
17:56:35 [INFO] gameserver.network.server: Session removed: uid=2
17:57:46 [INFO] __main__: Shutdown signal received — stopping …
17:57:46 [INFO] __main__: Shutting down …
17:57:46 [INFO] gameserver.persistence.state_save: Game state saved to state.yaml (2 empires, 0 attacks, 0 battles)
17:57:46 [INFO] websockets.server: server closing
17:57:46 [INFO] websockets.server: server closed
17:57:46 [INFO] gameserver.network.server: WebSocket server stopped
17:57:46 [INFO] __main__:   WebSocket server stopped
17:57:46 [INFO] __main__:   debug dashboard stopped
17:57:46 [INFO] __main__:   database closed
17:57:46 [INFO] __main__:   goodbye
17:57:48 [INFO] __main__: === Game Server starting ===
17:57:48 [INFO] __main__: Loading configuration …
17:57:48 [INFO] __main__:   items:        210 loaded from config
17:57:48 [INFO] __main__:   map:          4 paths, 23 build tiles from config/maps/default.yaml
17:57:48 [INFO] __main__:   ai_templates: 2 entries from config/ai_templates.yaml
17:57:49 [INFO] gameserver.loaders.game_config_loader: Loaded game config from config/game.yaml (29 keys)
17:57:49 [INFO] __main__:   game_config:  loaded
17:57:49 [INFO] __main__: Initializing persistence …
17:57:49 [INFO] gameserver.persistence.database: Database connected: gameserver.db
17:57:49 [INFO] __main__:   database:     connected (gameserver.db)
17:57:49 [INFO] gameserver.persistence.state_load: Restoring state from state.yaml (saved at 2026-02-08T17:57:46, version 1)
17:57:49 [INFO] gameserver.persistence.state_load: Restored 2 empires, 0 attacks, 0 battles
17:57:49 [INFO] __main__:   state:        restored from disk (2 empires, 0 attacks)
17:57:49 [INFO] __main__: Creating services …
17:57:49 [INFO] __main__:   upgrade_provider: 210 items registered
17:57:49 [INFO] __main__:   all services created
17:57:49 [INFO] __main__: Wiring event handlers …
17:57:49 [INFO] __main__:   event handlers registered
17:57:49 [INFO] gameserver.engine.empire_service: Empire registered: uid=100 name='TestImperium'
17:57:49 [INFO] gameserver.engine.empire_service: Empire 100: recalculated effects → {}
17:57:49 [INFO] gameserver.engine.empire_service: Empire registered: uid=2 name='Empire1'
17:57:49 [INFO] gameserver.engine.empire_service: Empire 2: recalculated effects → {'life_offset': 0.001, 'gold_offset': 0.2, 'culture_offset': 0.15000000000000002, 'culture_modifier': 0.1, 'gold_modifier': 0.1, 'build_speed_modifier': 0.1}
17:57:49 [INFO] __main__: Restored 2 empires from saved state
17:57:49 [INFO] __main__: Starting network server …
17:57:49 [INFO] gameserver.network.handlers: Registered 29 message handlers: summary_request, item_request, military_request, new_item, new_structure, delete_structure, upgrade_structure, citizen_upgrade, change_citizen, increase_life, new_army, new_attack_request, change_army, new_wave, change_wave, end_siege, battle_register, battle_unregister, battle_next_wave_request, notification_request, user_message, timeline_request, userinfo_request, hall_of_fame_request, preferences_request, change_preferences, auth_request, signup, create_empire
17:57:49 [INFO] websockets.server: server listening on 0.0.0.0:8765
17:57:49 [INFO] gameserver.network.server: WebSocket server listening on ws://0.0.0.0:8765
17:57:49 [INFO] __main__:   WebSocket server listening on 0.0.0.0:8765
17:57:49 [INFO] gameserver.debug.dashboard: Debug dashboard running at http://0.0.0.0:9000/
17:57:49 [INFO] __main__: Starting game loop …
17:57:49 [INFO] __main__:   game loop running (1 s tick)
17:58:53 [INFO] websockets.server: connection open
17:58:53 [INFO] gameserver.network.server: Session registered: uid=-1
17:58:53 [INFO] gameserver.network.server: Client connected: uid=-1 remote=('192.168.178.2', 51165)
17:58:57 [INFO] gameserver.network.auth: Login success: eem (uid=2)
17:58:57 [INFO] gameserver.network.server: Session registered: uid=2
17:58:57 [INFO] gameserver.network.server: Session upgraded: guest=-1 → uid=2
18:01:02 [INFO] gameserver.network.server: Session removed: uid=2
18:01:03 [INFO] websockets.server: connection open
18:01:03 [INFO] gameserver.network.server: Session registered: uid=-2
18:01:03 [INFO] gameserver.network.server: Client connected: uid=-2 remote=('192.168.178.2', 62795)
18:01:03 [INFO] gameserver.network.auth: Login success: eem (uid=2)
18:01:03 [INFO] gameserver.network.server: Session registered: uid=2
18:01:03 [INFO] gameserver.network.server: Session upgraded: guest=-2 → uid=2
18:01:24 [INFO] websockets.server: connection open
18:01:24 [INFO] gameserver.network.server: Session registered: uid=-3
18:01:24 [INFO] gameserver.network.server: Client connected: uid=-3 remote=('127.0.0.1', 48720)
18:01:24 [INFO] gameserver.network.auth: Login success: eem (uid=2)
18:01:24 [INFO] gameserver.network.server: Session registered: uid=2
18:01:24 [INFO] gameserver.network.server: Session upgraded: guest=-3 → uid=2
18:01:24 [INFO] gameserver.network.server: Client disconnected: uid=-2 code=1008
18:01:24 [INFO] gameserver.network.server: Session removed: uid=2
18:01:27 [INFO] websockets.server: connection open
18:01:27 [INFO] gameserver.network.server: Session registered: uid=-4
18:01:27 [INFO] gameserver.network.server: Client connected: uid=-4 remote=('192.168.178.2', 58121)
18:01:27 [INFO] gameserver.network.auth: Login success: eem (uid=2)
18:01:27 [INFO] gameserver.network.server: Session registered: uid=2
18:01:27 [INFO] gameserver.network.server: Session upgraded: guest=-4 → uid=2
18:03:20 [INFO] gameserver.network.server: Session removed: uid=2
18:04:47 [INFO] websockets.server: connection open
18:04:47 [INFO] gameserver.network.server: Session registered: uid=-5
18:04:47 [INFO] gameserver.network.server: Client connected: uid=-5 remote=('192.168.178.2', 63059)
18:04:47 [INFO] gameserver.network.auth: Login success: eem (uid=2)
18:04:47 [INFO] gameserver.network.server: Session registered: uid=2
18:04:47 [INFO] gameserver.network.server: Session upgraded: guest=-5 → uid=2
18:05:02 [INFO] gameserver.network.server: Session removed: uid=2
18:05:02 [INFO] websockets.server: connection open
18:05:02 [INFO] gameserver.network.server: Session registered: uid=-6
18:05:02 [INFO] gameserver.network.server: Client connected: uid=-6 remote=('192.168.178.2', 56149)
18:05:02 [INFO] gameserver.network.auth: Login success: eem (uid=2)
18:05:02 [INFO] gameserver.network.server: Session registered: uid=2
18:05:02 [INFO] gameserver.network.server: Session upgraded: guest=-6 → uid=2
18:05:38 [INFO] gameserver.network.server: Session removed: uid=2
18:05:39 [INFO] websockets.server: connection open
18:05:39 [INFO] gameserver.network.server: Session registered: uid=-7
18:05:39 [INFO] gameserver.network.server: Client connected: uid=-7 remote=('192.168.178.2', 56169)
18:05:39 [INFO] gameserver.network.auth: Login success: eem (uid=2)
18:05:39 [INFO] gameserver.network.server: Session registered: uid=2
18:05:39 [INFO] gameserver.network.server: Session upgraded: guest=-7 → uid=2
18:05:41 [INFO] gameserver.network.server: Session removed: uid=2
18:05:41 [INFO] websockets.server: connection open
18:05:41 [INFO] gameserver.network.server: Session registered: uid=-8
18:05:41 [INFO] gameserver.network.server: Client connected: uid=-8 remote=('192.168.178.2', 56172)
18:05:41 [INFO] gameserver.network.auth: Login success: eem (uid=2)
18:05:41 [INFO] gameserver.network.server: Session registered: uid=2
18:05:41 [INFO] gameserver.network.server: Session upgraded: guest=-8 → uid=2
18:06:18 [INFO] gameserver.network.server: Session removed: uid=2
18:06:18 [INFO] websockets.server: connection open
18:06:18 [INFO] gameserver.network.server: Session registered: uid=-9
18:06:18 [INFO] gameserver.network.server: Client connected: uid=-9 remote=('192.168.178.2', 50348)
18:06:18 [INFO] gameserver.network.auth: Login success: eem (uid=2)
18:06:18 [INFO] gameserver.network.server: Session registered: uid=2
18:06:18 [INFO] gameserver.network.server: Session upgraded: guest=-9 → uid=2
18:06:42 [INFO] gameserver.network.server: Session removed: uid=2
18:06:42 [INFO] websockets.server: connection open
18:06:42 [INFO] gameserver.network.server: Session registered: uid=-10
18:06:42 [INFO] gameserver.network.server: Client connected: uid=-10 remote=('192.168.178.2', 52321)
18:06:42 [INFO] gameserver.network.auth: Login success: eem (uid=2)
18:06:42 [INFO] gameserver.network.server: Session registered: uid=2
18:06:42 [INFO] gameserver.network.server: Session upgraded: guest=-10 → uid=2
18:08:34 [INFO] gameserver.network.server: Client disconnected: uid=-3 code=CloseCode.ABNORMAL_CLOSURE
18:08:34 [INFO] gameserver.network.server: Session removed: uid=2
18:09:11 [INFO] gameserver.network.server: Session removed: uid=2
18:09:11 [INFO] websockets.server: connection open
18:09:11 [INFO] gameserver.network.server: Session registered: uid=-11
18:09:11 [INFO] gameserver.network.server: Client connected: uid=-11 remote=('192.168.178.2', 49437)
18:09:11 [INFO] gameserver.network.auth: Login success: eem (uid=2)
18:09:11 [INFO] gameserver.network.server: Session registered: uid=2
18:09:11 [INFO] gameserver.network.server: Session upgraded: guest=-11 → uid=2
18:09:23 [INFO] __main__: Shutdown signal received — stopping …
18:09:24 [INFO] __main__: Shutting down …
18:09:24 [INFO] gameserver.persistence.state_save: Game state saved to state.yaml (2 empires, 0 attacks, 0 battles)
18:09:24 [INFO] websockets.server: server closing
18:09:24 [INFO] gameserver.network.server: Session removed: uid=2
18:09:24 [INFO] websockets.server: server closed
18:09:24 [INFO] gameserver.network.server: WebSocket server stopped
18:09:24 [INFO] __main__:   WebSocket server stopped
18:09:24 [INFO] __main__:   debug dashboard stopped
18:09:24 [INFO] __main__:   database closed
18:09:24 [INFO] __main__:   goodbye
18:09:25 [INFO] __main__: === Game Server starting ===
18:09:25 [INFO] __main__: Loading configuration …
18:09:26 [INFO] __main__:   items:        210 loaded from config
18:09:26 [INFO] __main__:   map:          4 paths, 23 build tiles from config/maps/default.yaml
18:09:26 [INFO] __main__:   ai_templates: 2 entries from config/ai_templates.yaml
18:09:26 [INFO] gameserver.loaders.game_config_loader: Loaded game config from config/game.yaml (29 keys)
18:09:26 [INFO] __main__:   game_config:  loaded
18:09:26 [INFO] __main__: Initializing persistence …
18:09:26 [INFO] gameserver.persistence.database: Database connected: gameserver.db
18:09:26 [INFO] __main__:   database:     connected (gameserver.db)
18:09:26 [INFO] gameserver.persistence.state_load: Restoring state from state.yaml (saved at 2026-02-08T18:09:24, version 1)
18:09:26 [INFO] gameserver.persistence.state_load: Restored 2 empires, 0 attacks, 0 battles
18:09:26 [INFO] __main__:   state:        restored from disk (2 empires, 0 attacks)
18:09:26 [INFO] __main__: Creating services …
18:09:26 [INFO] __main__:   upgrade_provider: 210 items registered
18:09:26 [INFO] __main__:   all services created
18:09:26 [INFO] __main__: Wiring event handlers …
18:09:26 [INFO] __main__:   event handlers registered
18:09:26 [INFO] gameserver.engine.empire_service: Empire registered: uid=100 name='TestImperium'
18:09:26 [INFO] gameserver.engine.empire_service: Empire 100: recalculated effects → {}
18:09:26 [INFO] gameserver.engine.empire_service: Empire registered: uid=2 name='Empire1'
18:09:26 [INFO] gameserver.engine.empire_service: Empire 2: recalculated effects → {'life_offset': 0.001, 'gold_offset': 0.2, 'culture_offset': 0.15000000000000002, 'culture_modifier': 0.1, 'gold_modifier': 0.1, 'build_speed_modifier': 0.1}
18:09:26 [INFO] __main__: Restored 2 empires from saved state
18:09:26 [INFO] __main__: Starting network server …
18:09:26 [INFO] gameserver.network.handlers: Registered 29 message handlers: summary_request, item_request, military_request, new_item, new_structure, delete_structure, upgrade_structure, citizen_upgrade, change_citizen, increase_life, new_army, new_attack_request, change_army, new_wave, change_wave, end_siege, battle_register, battle_unregister, battle_next_wave_request, notification_request, user_message, timeline_request, userinfo_request, hall_of_fame_request, preferences_request, change_preferences, auth_request, signup, create_empire
18:09:26 [INFO] websockets.server: server listening on 0.0.0.0:8765
18:09:26 [INFO] gameserver.network.server: WebSocket server listening on ws://0.0.0.0:8765
18:09:26 [INFO] __main__:   WebSocket server listening on 0.0.0.0:8765
18:09:26 [INFO] gameserver.debug.dashboard: Debug dashboard running at http://0.0.0.0:9000/
18:09:26 [INFO] __main__: Starting game loop …
18:09:26 [INFO] __main__:   game loop running (1 s tick)
18:09:27 [INFO] websockets.server: connection open
18:09:27 [INFO] gameserver.network.server: Session registered: uid=-1
18:09:27 [INFO] gameserver.network.server: Client connected: uid=-1 remote=('192.168.178.2', 49441)
18:09:27 [INFO] gameserver.network.auth: Login success: eem (uid=2)
18:09:27 [INFO] gameserver.network.server: Session registered: uid=2
18:09:27 [INFO] gameserver.network.server: Session upgraded: guest=-1 → uid=2
18:09:28 [INFO] gameserver.network.server: Session removed: uid=2
18:09:28 [INFO] websockets.server: connection open
18:09:28 [INFO] gameserver.network.server: Session registered: uid=-2
18:09:28 [INFO] gameserver.network.server: Client connected: uid=-2 remote=('192.168.178.2', 49450)
18:09:28 [INFO] gameserver.network.auth: Login success: eem (uid=2)
18:09:28 [INFO] gameserver.network.server: Session registered: uid=2
18:09:28 [INFO] gameserver.network.server: Session upgraded: guest=-2 → uid=2
18:12:44 [INFO] gameserver.network.server: Session removed: uid=2
18:12:44 [INFO] websockets.server: connection open
18:12:44 [INFO] gameserver.network.server: Session registered: uid=-3
18:12:44 [INFO] gameserver.network.server: Client connected: uid=-3 remote=('192.168.178.2', 64715)
18:12:44 [INFO] gameserver.network.auth: Login success: eem (uid=2)
18:12:44 [INFO] gameserver.network.server: Session registered: uid=2
18:12:44 [INFO] gameserver.network.server: Session upgraded: guest=-3 → uid=2
18:12:49 [INFO] __main__: Shutdown signal received — stopping …
18:12:49 [INFO] __main__: Shutting down …
18:12:49 [INFO] gameserver.persistence.state_save: Game state saved to state.yaml (2 empires, 0 attacks, 0 battles)
18:12:49 [INFO] websockets.server: server closing
18:12:49 [INFO] gameserver.network.server: Session removed: uid=2
18:12:49 [INFO] websockets.server: server closed
18:12:49 [INFO] gameserver.network.server: WebSocket server stopped
18:12:49 [INFO] __main__:   WebSocket server stopped
18:12:49 [INFO] __main__:   debug dashboard stopped
18:12:49 [INFO] __main__:   database closed
18:12:49 [INFO] __main__:   goodbye
18:12:51 [INFO] __main__: === Game Server starting ===
18:12:51 [INFO] __main__: Loading configuration …
18:12:52 [INFO] __main__:   items:        210 loaded from config
18:12:52 [INFO] __main__:   map:          4 paths, 23 build tiles from config/maps/default.yaml
18:12:52 [INFO] __main__:   ai_templates: 2 entries from config/ai_templates.yaml
18:12:52 [INFO] gameserver.loaders.game_config_loader: Loaded game config from config/game.yaml (29 keys)
18:12:52 [INFO] __main__:   game_config:  loaded
18:12:52 [INFO] __main__: Initializing persistence …
18:12:52 [INFO] gameserver.persistence.database: Database connected: gameserver.db
18:12:52 [INFO] __main__:   database:     connected (gameserver.db)
18:12:52 [INFO] gameserver.persistence.state_load: Restoring state from state.yaml (saved at 2026-02-08T18:12:49, version 1)
18:12:52 [INFO] gameserver.persistence.state_load: Restored 2 empires, 0 attacks, 0 battles
18:12:52 [INFO] __main__:   state:        restored from disk (2 empires, 0 attacks)
18:12:52 [INFO] __main__: Creating services …
18:12:52 [INFO] __main__:   upgrade_provider: 210 items registered
18:12:52 [INFO] __main__:   all services created
18:12:52 [INFO] __main__: Wiring event handlers …
18:12:52 [INFO] __main__:   event handlers registered
18:12:52 [INFO] gameserver.engine.empire_service: Empire registered: uid=100 name='TestImperium'
18:12:52 [INFO] gameserver.engine.empire_service: Empire 100: recalculated effects → {}
18:12:52 [INFO] gameserver.engine.empire_service: Empire registered: uid=2 name='Empire1'
18:12:52 [INFO] gameserver.engine.empire_service: Empire 2: recalculated effects → {'life_offset': 0.001, 'gold_offset': 0.2, 'culture_offset': 0.15000000000000002, 'culture_modifier': 0.1, 'gold_modifier': 0.1, 'build_speed_modifier': 0.1}
18:12:52 [INFO] __main__: Restored 2 empires from saved state
18:12:52 [INFO] __main__: Starting network server …
18:12:52 [INFO] gameserver.network.handlers: Registered 31 message handlers: summary_request, item_request, military_request, map_load_request, map_save_request, new_item, new_structure, delete_structure, upgrade_structure, citizen_upgrade, change_citizen, increase_life, new_army, new_attack_request, change_army, new_wave, change_wave, end_siege, battle_register, battle_unregister, battle_next_wave_request, notification_request, user_message, timeline_request, userinfo_request, hall_of_fame_request, preferences_request, change_preferences, auth_request, signup, create_empire
18:12:52 [INFO] websockets.server: server listening on 0.0.0.0:8765
18:12:52 [INFO] gameserver.network.server: WebSocket server listening on ws://0.0.0.0:8765
18:12:52 [INFO] __main__:   WebSocket server listening on 0.0.0.0:8765
18:12:52 [INFO] gameserver.debug.dashboard: Debug dashboard running at http://0.0.0.0:9000/
18:12:52 [INFO] __main__: Starting game loop …
18:12:52 [INFO] __main__:   game loop running (1 s tick)
18:12:52 [INFO] websockets.server: connection open
18:12:52 [INFO] gameserver.network.server: Session registered: uid=-1
18:12:52 [INFO] gameserver.network.server: Client connected: uid=-1 remote=('192.168.178.2', 59608)
18:12:52 [INFO] gameserver.network.auth: Login success: eem (uid=2)
18:12:52 [INFO] gameserver.network.server: Session registered: uid=2
18:12:52 [INFO] gameserver.network.server: Session upgraded: guest=-1 → uid=2
18:12:54 [INFO] gameserver.network.server: Session removed: uid=2
18:12:54 [INFO] websockets.server: connection open
18:12:54 [INFO] gameserver.network.server: Session registered: uid=-2
18:12:54 [INFO] gameserver.network.server: Client connected: uid=-2 remote=('192.168.178.2', 53051)
18:12:54 [INFO] gameserver.network.auth: Login success: eem (uid=2)
18:12:54 [INFO] gameserver.network.server: Session registered: uid=2
18:12:54 [INFO] gameserver.network.server: Session upgraded: guest=-2 → uid=2
18:12:57 [INFO] gameserver.network.server: Session removed: uid=2
18:12:58 [INFO] websockets.server: connection open
18:12:58 [INFO] gameserver.network.server: Session registered: uid=-3
18:12:58 [INFO] gameserver.network.server: Client connected: uid=-3 remote=('192.168.178.2', 53079)
18:12:58 [INFO] gameserver.network.auth: Login success: eem (uid=2)
18:12:58 [INFO] gameserver.network.server: Session registered: uid=2
18:12:58 [INFO] gameserver.network.server: Session upgraded: guest=-3 → uid=2
18:13:13 [ERROR] gameserver.network.server: Handler error: type=map_save_request uid=2
Traceback (most recent call last):
  File "/home/pi/e3/python_server/src/gameserver/network/server.py", line 196, in _handle_message
    response = await self._router.route(data, uid)
  File "/home/pi/e3/python_server/src/gameserver/network/router.py", line 65, in route
    return await handler(message, sender_uid)
  File "/home/pi/e3/python_server/src/gameserver/network/handlers.py", line 686, in handle_map_save_request
    svc.persistence.save_state()
AttributeError: 'Services' object has no attribute 'persistence'
18:13:21 [ERROR] gameserver.network.server: Handler error: type=map_save_request uid=2
Traceback (most recent call last):
  File "/home/pi/e3/python_server/src/gameserver/network/server.py", line 196, in _handle_message
    response = await self._router.route(data, uid)
  File "/home/pi/e3/python_server/src/gameserver/network/router.py", line 65, in route
    return await handler(message, sender_uid)
  File "/home/pi/e3/python_server/src/gameserver/network/handlers.py", line 686, in handle_map_save_request
    svc.persistence.save_state()
AttributeError: 'Services' object has no attribute 'persistence'
18:16:50 [ERROR] gameserver.network.server: Handler error: type=map_save_request uid=2
Traceback (most recent call last):
  File "/home/pi/e3/python_server/src/gameserver/network/server.py", line 196, in _handle_message
    response = await self._router.route(data, uid)
  File "/home/pi/e3/python_server/src/gameserver/network/router.py", line 65, in route
    return await handler(message, sender_uid)
  File "/home/pi/e3/python_server/src/gameserver/network/handlers.py", line 686, in handle_map_save_request
    svc.persistence.save_state()
AttributeError: 'Services' object has no attribute 'persistence'
18:16:54 [ERROR] gameserver.network.server: Handler error: type=map_save_request uid=2
Traceback (most recent call last):
  File "/home/pi/e3/python_server/src/gameserver/network/server.py", line 196, in _handle_message
    response = await self._router.route(data, uid)
  File "/home/pi/e3/python_server/src/gameserver/network/router.py", line 65, in route
    return await handler(message, sender_uid)
  File "/home/pi/e3/python_server/src/gameserver/network/handlers.py", line 686, in handle_map_save_request
    svc.persistence.save_state()
AttributeError: 'Services' object has no attribute 'persistence'
18:19:55 [INFO] __main__: Shutdown signal received — stopping …
18:19:55 [INFO] __main__: Shutting down …
18:19:55 [INFO] gameserver.persistence.state_save: Game state saved to state.yaml (2 empires, 0 attacks, 0 battles)
18:19:55 [INFO] websockets.server: server closing
18:19:55 [INFO] gameserver.network.server: Session removed: uid=2
18:19:55 [INFO] websockets.server: server closed
18:19:55 [INFO] gameserver.network.server: WebSocket server stopped
18:19:55 [INFO] __main__:   WebSocket server stopped
18:19:55 [INFO] __main__:   debug dashboard stopped
18:19:55 [INFO] __main__:   database closed
18:19:55 [INFO] __main__:   goodbye
18:19:57 [INFO] __main__: === Game Server starting ===
18:19:57 [INFO] __main__: Loading configuration …
18:19:58 [INFO] __main__:   items:        210 loaded from config
18:19:58 [INFO] __main__:   map:          4 paths, 23 build tiles from config/maps/default.yaml
18:19:58 [INFO] __main__:   ai_templates: 2 entries from config/ai_templates.yaml
18:19:58 [INFO] gameserver.loaders.game_config_loader: Loaded game config from config/game.yaml (29 keys)
18:19:58 [INFO] __main__:   game_config:  loaded
18:19:58 [INFO] __main__: Initializing persistence …
18:19:58 [INFO] gameserver.persistence.database: Database connected: gameserver.db
18:19:58 [INFO] __main__:   database:     connected (gameserver.db)
18:19:58 [INFO] gameserver.persistence.state_load: Restoring state from state.yaml (saved at 2026-02-08T18:19:55, version 1)
18:19:58 [INFO] gameserver.persistence.state_load: Restored 2 empires, 0 attacks, 0 battles
18:19:58 [INFO] __main__:   state:        restored from disk (2 empires, 0 attacks)
18:19:58 [INFO] __main__: Creating services …
18:19:58 [INFO] __main__:   upgrade_provider: 210 items registered
18:19:58 [INFO] __main__:   all services created
18:19:58 [INFO] __main__: Wiring event handlers …
18:19:58 [INFO] __main__:   event handlers registered
18:19:58 [INFO] gameserver.engine.empire_service: Empire registered: uid=100 name='TestImperium'
18:19:58 [INFO] gameserver.engine.empire_service: Empire 100: recalculated effects → {}
18:19:58 [INFO] gameserver.engine.empire_service: Empire registered: uid=2 name='Empire1'
18:19:58 [INFO] gameserver.engine.empire_service: Empire 2: recalculated effects → {'life_offset': 0.001, 'gold_offset': 0.2, 'culture_offset': 0.15000000000000002, 'culture_modifier': 0.1, 'gold_modifier': 0.1, 'build_speed_modifier': 0.1}
18:19:58 [INFO] __main__: Restored 2 empires from saved state
18:19:58 [INFO] __main__: Starting network server …
18:19:58 [INFO] gameserver.network.handlers: Registered 31 message handlers: summary_request, item_request, military_request, map_load_request, map_save_request, new_item, new_structure, delete_structure, upgrade_structure, citizen_upgrade, change_citizen, increase_life, new_army, new_attack_request, change_army, new_wave, change_wave, end_siege, battle_register, battle_unregister, battle_next_wave_request, notification_request, user_message, timeline_request, userinfo_request, hall_of_fame_request, preferences_request, change_preferences, auth_request, signup, create_empire
18:19:58 [INFO] websockets.server: server listening on 0.0.0.0:8765
18:19:58 [INFO] gameserver.network.server: WebSocket server listening on ws://0.0.0.0:8765
18:19:58 [INFO] __main__:   WebSocket server listening on 0.0.0.0:8765
18:19:58 [INFO] gameserver.debug.dashboard: Debug dashboard running at http://0.0.0.0:9000/
18:19:58 [INFO] __main__: Starting game loop …
18:19:58 [INFO] __main__:   game loop running (1 s tick)
18:19:58 [INFO] websockets.server: connection open
18:19:58 [INFO] gameserver.network.server: Session registered: uid=-1
18:19:58 [INFO] gameserver.network.server: Client connected: uid=-1 remote=('192.168.178.2', 50960)
18:19:59 [INFO] gameserver.network.auth: Login success: eem (uid=2)
18:19:59 [INFO] gameserver.network.server: Session registered: uid=2
18:19:59 [INFO] gameserver.network.server: Session upgraded: guest=-1 → uid=2
18:20:20 [INFO] gameserver.network.server: Session removed: uid=2
18:20:20 [INFO] websockets.server: connection open
18:20:20 [INFO] gameserver.network.server: Session registered: uid=-2
18:20:20 [INFO] gameserver.network.server: Client connected: uid=-2 remote=('192.168.178.2', 49190)
18:20:20 [INFO] gameserver.network.auth: Login success: eem (uid=2)
18:20:20 [INFO] gameserver.network.server: Session registered: uid=2
18:20:20 [INFO] gameserver.network.server: Session upgraded: guest=-2 → uid=2
18:20:36 [INFO] gameserver.network.server: Session removed: uid=2
18:20:36 [INFO] websockets.server: connection open
18:20:36 [INFO] gameserver.network.server: Session registered: uid=-3
18:20:36 [INFO] gameserver.network.server: Client connected: uid=-3 remote=('192.168.178.2', 56622)
18:20:36 [INFO] gameserver.network.auth: Login success: eem (uid=2)
18:20:36 [INFO] gameserver.network.server: Session registered: uid=2
18:20:36 [INFO] gameserver.network.server: Session upgraded: guest=-3 → uid=2
18:21:50 [ERROR] gameserver.network.server: Handler error: type=map_save_request uid=2
Traceback (most recent call last):
  File "/home/pi/e3/python_server/src/gameserver/network/server.py", line 196, in _handle_message
    response = await self._router.route(data, uid)
  File "/home/pi/e3/python_server/src/gameserver/network/router.py", line 65, in route
    return await handler(message, sender_uid)
  File "/home/pi/e3/python_server/src/gameserver/network/handlers.py", line 686, in handle_map_save_request
    svc.persistence.save_state()
AttributeError: 'Services' object has no attribute 'persistence'
18:21:51 [ERROR] gameserver.network.server: Handler error: type=map_save_request uid=2
Traceback (most recent call last):
  File "/home/pi/e3/python_server/src/gameserver/network/server.py", line 196, in _handle_message
    response = await self._router.route(data, uid)
  File "/home/pi/e3/python_server/src/gameserver/network/router.py", line 65, in route
    return await handler(message, sender_uid)
  File "/home/pi/e3/python_server/src/gameserver/network/handlers.py", line 686, in handle_map_save_request
    svc.persistence.save_state()
AttributeError: 'Services' object has no attribute 'persistence'
18:23:06 [INFO] __main__: Shutdown signal received — stopping …
18:23:07 [INFO] __main__: Shutting down …
18:23:07 [INFO] gameserver.persistence.state_save: Game state saved to state.yaml (2 empires, 0 attacks, 0 battles)
18:23:07 [INFO] websockets.server: server closing
18:23:07 [INFO] gameserver.network.server: Session removed: uid=2
18:23:07 [INFO] websockets.server: server closed
18:23:07 [INFO] gameserver.network.server: WebSocket server stopped
18:23:07 [INFO] __main__:   WebSocket server stopped
18:23:07 [INFO] __main__:   debug dashboard stopped
18:23:07 [INFO] __main__:   database closed
18:23:07 [INFO] __main__:   goodbye
18:23:28 [INFO] __main__: === Game Server starting ===
18:23:28 [INFO] __main__: Loading configuration …
18:23:29 [INFO] __main__:   items:        210 loaded from config
18:23:29 [INFO] __main__:   map:          4 paths, 23 build tiles from config/maps/default.yaml
18:23:29 [INFO] __main__:   ai_templates: 2 entries from config/ai_templates.yaml
18:23:29 [INFO] gameserver.loaders.game_config_loader: Loaded game config from config/game.yaml (29 keys)
18:23:29 [INFO] __main__:   game_config:  loaded
18:23:29 [INFO] __main__: Initializing persistence …
18:23:29 [INFO] gameserver.persistence.database: Database connected: gameserver.db
18:23:29 [INFO] __main__:   database:     connected (gameserver.db)
18:23:29 [INFO] gameserver.persistence.state_load: Restoring state from state.yaml (saved at 2026-02-08T18:23:27, version 1)
18:23:29 [INFO] gameserver.persistence.state_load: Restored 2 empires, 0 attacks, 0 battles
18:23:29 [INFO] __main__:   state:        restored from disk (2 empires, 0 attacks)
18:23:29 [INFO] __main__: Creating services …
18:23:29 [INFO] __main__:   upgrade_provider: 210 items registered
18:23:29 [INFO] __main__:   all services created
18:23:29 [INFO] __main__: Wiring event handlers …
18:23:29 [INFO] __main__:   event handlers registered
18:23:29 [INFO] gameserver.engine.empire_service: Empire registered: uid=100 name='TestImperium'
18:23:29 [INFO] gameserver.engine.empire_service: Empire 100: recalculated effects → {}
18:23:29 [INFO] gameserver.engine.empire_service: Empire registered: uid=2 name='Empire1'
18:23:29 [INFO] gameserver.engine.empire_service: Empire 2: recalculated effects → {'life_offset': 0.001, 'gold_offset': 0.2, 'culture_offset': 0.15000000000000002, 'culture_modifier': 0.1, 'gold_modifier': 0.1, 'build_speed_modifier': 0.1}
18:23:29 [INFO] __main__: Restored 2 empires from saved state
18:23:29 [INFO] __main__: Starting network server …
18:23:29 [INFO] gameserver.network.handlers: Registered 31 message handlers: summary_request, item_request, military_request, map_load_request, map_save_request, new_item, new_structure, delete_structure, upgrade_structure, citizen_upgrade, change_citizen, increase_life, new_army, new_attack_request, change_army, new_wave, change_wave, end_siege, battle_register, battle_unregister, battle_next_wave_request, notification_request, user_message, timeline_request, userinfo_request, hall_of_fame_request, preferences_request, change_preferences, auth_request, signup, create_empire
18:23:29 [INFO] websockets.server: server listening on 0.0.0.0:8765
18:23:29 [INFO] gameserver.network.server: WebSocket server listening on ws://0.0.0.0:8765
18:23:29 [INFO] __main__:   WebSocket server listening on 0.0.0.0:8765
18:23:29 [INFO] gameserver.debug.dashboard: Debug dashboard running at http://0.0.0.0:9000/
18:23:29 [INFO] __main__: Starting game loop …
18:23:29 [INFO] __main__:   game loop running (1 s tick)
18:23:30 [INFO] websockets.server: connection open
18:23:30 [INFO] gameserver.network.server: Session registered: uid=-1
18:23:30 [INFO] gameserver.network.server: Client connected: uid=-1 remote=('192.168.178.2', 56553)
18:23:30 [INFO] gameserver.network.auth: Login success: eem (uid=2)
18:23:30 [INFO] gameserver.network.server: Session registered: uid=2
18:23:30 [INFO] gameserver.network.server: Session upgraded: guest=-1 → uid=2
18:23:58 [INFO] gameserver.network.server: Session removed: uid=2
18:23:58 [INFO] websockets.server: connection open
18:23:58 [INFO] gameserver.network.server: Session registered: uid=-2
18:23:58 [INFO] gameserver.network.server: Client connected: uid=-2 remote=('192.168.178.2', 56568)
18:23:58 [INFO] gameserver.network.auth: Login success: eem (uid=2)
18:23:58 [INFO] gameserver.network.server: Session registered: uid=2
18:23:58 [INFO] gameserver.network.server: Session upgraded: guest=-2 → uid=2
18:24:08 [ERROR] gameserver.network.handlers: [Composer] save error: 'dict' object is not callable
18:24:08 [ERROR] gameserver.network.handlers: [Composer] save error: 'dict' object is not callable
18:24:20 [INFO] __main__: Shutdown signal received — stopping …
18:24:20 [INFO] __main__: Shutting down …
18:24:20 [INFO] gameserver.persistence.state_save: Game state saved to state.yaml (2 empires, 0 attacks, 0 battles)
18:24:20 [INFO] websockets.server: server closing
18:24:20 [INFO] gameserver.network.server: Session removed: uid=2
18:24:20 [INFO] websockets.server: server closed
18:24:20 [INFO] gameserver.network.server: WebSocket server stopped
18:24:20 [INFO] __main__:   WebSocket server stopped
18:24:20 [INFO] __main__:   debug dashboard stopped
18:24:20 [INFO] __main__:   database closed
18:24:20 [INFO] __main__:   goodbye
18:24:21 [INFO] __main__: === Game Server starting ===
18:24:21 [INFO] __main__: Loading configuration …
18:24:22 [INFO] __main__:   items:        210 loaded from config
18:24:22 [INFO] __main__:   map:          4 paths, 23 build tiles from config/maps/default.yaml
18:24:22 [INFO] __main__:   ai_templates: 2 entries from config/ai_templates.yaml
18:24:22 [INFO] gameserver.loaders.game_config_loader: Loaded game config from config/game.yaml (29 keys)
18:24:22 [INFO] __main__:   game_config:  loaded
18:24:22 [INFO] __main__: Initializing persistence …
18:24:22 [INFO] gameserver.persistence.database: Database connected: gameserver.db
18:24:22 [INFO] __main__:   database:     connected (gameserver.db)
18:24:22 [INFO] gameserver.persistence.state_load: Restoring state from state.yaml (saved at 2026-02-08T18:24:20, version 1)
18:24:22 [INFO] gameserver.persistence.state_load: Restored 2 empires, 0 attacks, 0 battles
18:24:22 [INFO] __main__:   state:        restored from disk (2 empires, 0 attacks)
18:24:22 [INFO] __main__: Creating services …
18:24:22 [INFO] __main__:   upgrade_provider: 210 items registered
18:24:22 [INFO] __main__:   all services created
18:24:22 [INFO] __main__: Wiring event handlers …
18:24:22 [INFO] __main__:   event handlers registered
18:24:22 [INFO] gameserver.engine.empire_service: Empire registered: uid=100 name='TestImperium'
18:24:22 [INFO] gameserver.engine.empire_service: Empire 100: recalculated effects → {}
18:24:22 [INFO] gameserver.engine.empire_service: Empire registered: uid=2 name='Empire1'
18:24:22 [INFO] gameserver.engine.empire_service: Empire 2: recalculated effects → {'life_offset': 0.001, 'gold_offset': 0.2, 'culture_offset': 0.15000000000000002, 'culture_modifier': 0.1, 'gold_modifier': 0.1, 'build_speed_modifier': 0.1}
18:24:22 [INFO] __main__: Restored 2 empires from saved state
18:24:22 [INFO] __main__: Starting network server …
18:24:22 [INFO] gameserver.network.handlers: Registered 31 message handlers: summary_request, item_request, military_request, map_load_request, map_save_request, new_item, new_structure, delete_structure, upgrade_structure, citizen_upgrade, change_citizen, increase_life, new_army, new_attack_request, change_army, new_wave, change_wave, end_siege, battle_register, battle_unregister, battle_next_wave_request, notification_request, user_message, timeline_request, userinfo_request, hall_of_fame_request, preferences_request, change_preferences, auth_request, signup, create_empire
18:24:22 [INFO] websockets.server: server listening on 0.0.0.0:8765
18:24:22 [INFO] gameserver.network.server: WebSocket server listening on ws://0.0.0.0:8765
18:24:22 [INFO] __main__:   WebSocket server listening on 0.0.0.0:8765
18:24:22 [INFO] gameserver.debug.dashboard: Debug dashboard running at http://0.0.0.0:9000/
18:24:22 [INFO] __main__: Starting game loop …
18:24:22 [INFO] __main__:   game loop running (1 s tick)
18:24:24 [INFO] websockets.server: connection open
18:24:24 [INFO] gameserver.network.server: Session registered: uid=-1
18:24:24 [INFO] gameserver.network.server: Client connected: uid=-1 remote=('192.168.178.2', 51204)
18:24:24 [INFO] gameserver.network.auth: Login success: eem (uid=2)
18:24:24 [INFO] gameserver.network.server: Session registered: uid=2
18:24:24 [INFO] gameserver.network.server: Session upgraded: guest=-1 → uid=2
18:26:07 [INFO] __main__: Shutdown signal received — stopping …
18:26:07 [INFO] __main__: Shutting down …
18:26:07 [INFO] gameserver.persistence.state_save: Game state saved to state.yaml (2 empires, 0 attacks, 0 battles)
18:26:07 [INFO] websockets.server: server closing
18:26:07 [INFO] gameserver.network.server: Session removed: uid=2
18:26:07 [INFO] websockets.server: server closed
18:26:07 [INFO] gameserver.network.server: WebSocket server stopped
18:26:07 [INFO] __main__:   WebSocket server stopped
18:26:07 [INFO] __main__:   debug dashboard stopped
18:26:07 [INFO] __main__:   database closed
18:26:07 [INFO] __main__:   goodbye
18:26:10 [INFO] __main__: === Game Server starting ===
18:26:10 [INFO] __main__: Loading configuration …
18:26:10 [INFO] __main__:   items:        210 loaded from config
18:26:10 [INFO] __main__:   map:          4 paths, 23 build tiles from config/maps/default.yaml
18:26:10 [INFO] __main__:   ai_templates: 2 entries from config/ai_templates.yaml
18:26:10 [INFO] gameserver.loaders.game_config_loader: Loaded game config from config/game.yaml (29 keys)
18:26:10 [INFO] __main__:   game_config:  loaded
18:26:10 [INFO] __main__: Initializing persistence …
18:26:10 [INFO] gameserver.persistence.database: Database connected: gameserver.db
18:26:10 [INFO] __main__:   database:     connected (gameserver.db)
18:26:10 [INFO] gameserver.persistence.state_load: Restoring state from state.yaml (saved at 2026-02-08T18:26:07, version 1)
18:26:10 [INFO] gameserver.persistence.state_load: Restored 2 empires, 0 attacks, 0 battles
18:26:10 [INFO] __main__:   state:        restored from disk (2 empires, 0 attacks)
18:26:10 [INFO] __main__: Creating services …
18:26:10 [INFO] __main__:   upgrade_provider: 210 items registered
18:26:10 [INFO] __main__:   all services created
18:26:10 [INFO] __main__: Wiring event handlers …
18:26:10 [INFO] __main__:   event handlers registered
18:26:10 [INFO] gameserver.engine.empire_service: Empire registered: uid=100 name='TestImperium'
18:26:10 [INFO] gameserver.engine.empire_service: Empire 100: recalculated effects → {}
18:26:10 [INFO] gameserver.engine.empire_service: Empire registered: uid=2 name='Empire1'
18:26:10 [INFO] gameserver.engine.empire_service: Empire 2: recalculated effects → {'life_offset': 0.001, 'gold_offset': 0.2, 'culture_offset': 0.15000000000000002, 'culture_modifier': 0.1, 'gold_modifier': 0.1, 'build_speed_modifier': 0.1}
18:26:10 [INFO] __main__: Restored 2 empires from saved state
18:26:10 [INFO] __main__: Starting network server …
18:26:10 [INFO] gameserver.network.handlers: Registered 31 message handlers: summary_request, item_request, military_request, map_load_request, map_save_request, new_item, new_structure, delete_structure, upgrade_structure, citizen_upgrade, change_citizen, increase_life, new_army, new_attack_request, change_army, new_wave, change_wave, end_siege, battle_register, battle_unregister, battle_next_wave_request, notification_request, user_message, timeline_request, userinfo_request, hall_of_fame_request, preferences_request, change_preferences, auth_request, signup, create_empire
18:26:10 [INFO] websockets.server: server listening on 0.0.0.0:8765
18:26:10 [INFO] gameserver.network.server: WebSocket server listening on ws://0.0.0.0:8765
18:26:10 [INFO] __main__:   WebSocket server listening on 0.0.0.0:8765
18:26:10 [INFO] gameserver.debug.dashboard: Debug dashboard running at http://0.0.0.0:9000/
18:26:10 [INFO] __main__: Starting game loop …
18:26:10 [INFO] __main__:   game loop running (1 s tick)
18:26:10 [INFO] websockets.server: connection open
18:26:10 [INFO] gameserver.network.server: Session registered: uid=-1
18:26:10 [INFO] gameserver.network.server: Client connected: uid=-1 remote=('192.168.178.2', 51251)
18:26:10 [INFO] gameserver.network.auth: Login success: eem (uid=2)
18:26:10 [INFO] gameserver.network.server: Session registered: uid=2
18:26:10 [INFO] gameserver.network.server: Session upgraded: guest=-1 → uid=2
18:26:18 [INFO] gameserver.network.server: Session removed: uid=2
18:26:18 [INFO] websockets.server: connection open
18:26:18 [INFO] gameserver.network.server: Session registered: uid=-2
18:26:18 [INFO] gameserver.network.server: Client connected: uid=-2 remote=('192.168.178.2', 51264)
18:26:18 [INFO] gameserver.network.auth: Login success: eem (uid=2)
18:26:18 [INFO] gameserver.network.server: Session registered: uid=2
18:26:18 [INFO] gameserver.network.server: Session upgraded: guest=-2 → uid=2
18:26:26 [INFO] gameserver.network.server: Session removed: uid=2
18:26:26 [INFO] websockets.server: connection open
18:26:26 [INFO] gameserver.network.server: Session registered: uid=-3
18:26:26 [INFO] gameserver.network.server: Client connected: uid=-3 remote=('192.168.178.2', 51267)
18:26:26 [INFO] gameserver.network.auth: Login success: eem (uid=2)
18:26:26 [INFO] gameserver.network.server: Session registered: uid=2
18:26:26 [INFO] gameserver.network.server: Session upgraded: guest=-3 → uid=2
18:26:28 [INFO] gameserver.network.server: Session removed: uid=2
18:26:28 [INFO] websockets.server: connection open
18:26:28 [INFO] gameserver.network.server: Session registered: uid=-4
18:26:28 [INFO] gameserver.network.server: Client connected: uid=-4 remote=('192.168.178.2', 51270)
18:26:28 [INFO] gameserver.network.auth: Login success: eem (uid=2)
18:26:28 [INFO] gameserver.network.server: Session registered: uid=2
18:26:28 [INFO] gameserver.network.server: Session upgraded: guest=-4 → uid=2
18:26:28 [INFO] gameserver.network.server: Session removed: uid=2
18:26:28 [INFO] websockets.server: connection open
18:26:28 [INFO] gameserver.network.server: Session registered: uid=-5
18:26:28 [INFO] gameserver.network.server: Client connected: uid=-5 remote=('192.168.178.2', 51272)
18:26:28 [INFO] gameserver.network.auth: Login success: eem (uid=2)
18:26:28 [INFO] gameserver.network.server: Session registered: uid=2
18:26:28 [INFO] gameserver.network.server: Session upgraded: guest=-5 → uid=2
18:26:29 [INFO] gameserver.network.server: Session removed: uid=2
18:26:29 [INFO] websockets.server: connection open
18:26:29 [INFO] gameserver.network.server: Session registered: uid=-6
18:26:29 [INFO] gameserver.network.server: Client connected: uid=-6 remote=('192.168.178.2', 51274)
18:26:29 [INFO] gameserver.network.auth: Login success: eem (uid=2)
18:26:29 [INFO] gameserver.network.server: Session registered: uid=2
18:26:29 [INFO] gameserver.network.server: Session upgraded: guest=-6 → uid=2
18:27:05 [INFO] gameserver.network.server: Session removed: uid=2
18:27:05 [INFO] websockets.server: connection open
18:27:05 [INFO] gameserver.network.server: Session registered: uid=-7
18:27:05 [INFO] gameserver.network.server: Client connected: uid=-7 remote=('192.168.178.2', 63613)
18:27:05 [INFO] gameserver.network.auth: Login success: eem (uid=2)
18:27:05 [INFO] gameserver.network.server: Session registered: uid=2
18:27:05 [INFO] gameserver.network.server: Session upgraded: guest=-7 → uid=2
18:27:05 [INFO] gameserver.network.server: Session removed: uid=2
18:27:05 [INFO] websockets.server: connection open
18:27:05 [INFO] gameserver.network.server: Session registered: uid=-8
18:27:05 [INFO] gameserver.network.server: Client connected: uid=-8 remote=('192.168.178.2', 63615)
18:27:05 [INFO] gameserver.network.auth: Login success: eem (uid=2)
18:27:05 [INFO] gameserver.network.server: Session registered: uid=2
18:27:05 [INFO] gameserver.network.server: Session upgraded: guest=-8 → uid=2
18:27:06 [INFO] gameserver.network.server: Session removed: uid=2
18:27:06 [INFO] websockets.server: connection open
18:27:06 [INFO] gameserver.network.server: Session registered: uid=-9
18:27:06 [INFO] gameserver.network.server: Client connected: uid=-9 remote=('192.168.178.2', 63617)
18:27:06 [INFO] gameserver.network.auth: Login success: eem (uid=2)
18:27:06 [INFO] gameserver.network.server: Session registered: uid=2
18:27:06 [INFO] gameserver.network.server: Session upgraded: guest=-9 → uid=2
18:27:06 [INFO] gameserver.network.server: Session removed: uid=2
18:27:06 [INFO] websockets.server: connection open
18:27:06 [INFO] gameserver.network.server: Session registered: uid=-10
18:27:06 [INFO] gameserver.network.server: Client connected: uid=-10 remote=('192.168.178.2', 63619)
18:27:06 [INFO] gameserver.network.auth: Login success: eem (uid=2)
18:27:06 [INFO] gameserver.network.server: Session registered: uid=2
18:27:06 [INFO] gameserver.network.server: Session upgraded: guest=-10 → uid=2
18:27:06 [INFO] gameserver.network.server: Session removed: uid=2
18:27:06 [INFO] websockets.server: connection open
18:27:06 [INFO] gameserver.network.server: Session registered: uid=-11
18:27:06 [INFO] gameserver.network.server: Client connected: uid=-11 remote=('192.168.178.2', 63621)
18:27:06 [INFO] gameserver.network.auth: Login success: eem (uid=2)
18:27:06 [INFO] gameserver.network.server: Session registered: uid=2
18:27:06 [INFO] gameserver.network.server: Session upgraded: guest=-11 → uid=2
18:27:06 [INFO] gameserver.network.server: Session removed: uid=2
18:27:06 [INFO] websockets.server: connection open
18:27:06 [INFO] gameserver.network.server: Session registered: uid=-12
18:27:06 [INFO] gameserver.network.server: Client connected: uid=-12 remote=('192.168.178.2', 63623)
18:27:06 [INFO] gameserver.network.auth: Login success: eem (uid=2)
18:27:06 [INFO] gameserver.network.server: Session registered: uid=2
18:27:06 [INFO] gameserver.network.server: Session upgraded: guest=-12 → uid=2
18:27:18 [INFO] gameserver.network.server: Session removed: uid=2
18:27:19 [INFO] websockets.server: connection open
18:27:19 [INFO] gameserver.network.server: Session registered: uid=-13
18:27:19 [INFO] gameserver.network.server: Client connected: uid=-13 remote=('192.168.178.2', 63628)
18:27:19 [INFO] gameserver.network.auth: Login success: eem (uid=2)
18:27:19 [INFO] gameserver.network.server: Session registered: uid=2
18:27:19 [INFO] gameserver.network.server: Session upgraded: guest=-13 → uid=2
18:27:19 [INFO] gameserver.network.server: Session removed: uid=2
18:27:19 [INFO] websockets.server: connection open
18:27:19 [INFO] gameserver.network.server: Session registered: uid=-14
18:27:19 [INFO] gameserver.network.server: Client connected: uid=-14 remote=('192.168.178.2', 63630)
18:27:19 [INFO] gameserver.network.auth: Login success: eem (uid=2)
18:27:19 [INFO] gameserver.network.server: Session registered: uid=2
18:27:19 [INFO] gameserver.network.server: Session upgraded: guest=-14 → uid=2
18:27:19 [INFO] gameserver.network.server: Session removed: uid=2
18:27:19 [INFO] websockets.server: connection open
18:27:19 [INFO] gameserver.network.server: Session registered: uid=-15
18:27:19 [INFO] gameserver.network.server: Client connected: uid=-15 remote=('192.168.178.2', 63632)
18:27:19 [INFO] gameserver.network.auth: Login success: eem (uid=2)
18:27:19 [INFO] gameserver.network.server: Session registered: uid=2
18:27:19 [INFO] gameserver.network.server: Session upgraded: guest=-15 → uid=2
18:27:19 [INFO] gameserver.network.server: Session removed: uid=2
18:27:19 [INFO] websockets.server: connection open
18:27:19 [INFO] gameserver.network.server: Session registered: uid=-16
18:27:19 [INFO] gameserver.network.server: Client connected: uid=-16 remote=('192.168.178.2', 63634)
18:27:19 [INFO] gameserver.network.auth: Login success: eem (uid=2)
18:27:19 [INFO] gameserver.network.server: Session registered: uid=2
18:27:19 [INFO] gameserver.network.server: Session upgraded: guest=-16 → uid=2
18:28:35 [INFO] gameserver.network.server: Session removed: uid=2
18:28:35 [INFO] websockets.server: connection open
18:28:35 [INFO] gameserver.network.server: Session registered: uid=-17
18:28:35 [INFO] gameserver.network.server: Client connected: uid=-17 remote=('192.168.178.2', 60347)
18:28:35 [INFO] gameserver.network.auth: Login success: eem (uid=2)
18:28:35 [INFO] gameserver.network.server: Session registered: uid=2
18:28:35 [INFO] gameserver.network.server: Session upgraded: guest=-17 → uid=2
18:28:37 [INFO] gameserver.network.server: Session removed: uid=2
18:28:37 [INFO] websockets.server: connection open
18:28:37 [INFO] gameserver.network.server: Session registered: uid=-18
18:28:37 [INFO] gameserver.network.server: Client connected: uid=-18 remote=('192.168.178.2', 60350)
18:28:37 [INFO] gameserver.network.auth: Login success: eem (uid=2)
18:28:37 [INFO] gameserver.network.server: Session registered: uid=2
18:28:37 [INFO] gameserver.network.server: Session upgraded: guest=-18 → uid=2
18:28:38 [INFO] gameserver.network.server: Session removed: uid=2
18:28:38 [INFO] websockets.server: connection open
18:28:38 [INFO] gameserver.network.server: Session registered: uid=-19
18:28:38 [INFO] gameserver.network.server: Client connected: uid=-19 remote=('192.168.178.2', 60373)
18:28:38 [INFO] gameserver.network.auth: Login success: eem (uid=2)
18:28:38 [INFO] gameserver.network.server: Session registered: uid=2
18:28:38 [INFO] gameserver.network.server: Session upgraded: guest=-19 → uid=2
18:28:48 [INFO] __main__: Shutdown signal received — stopping …
18:28:49 [INFO] __main__: Shutting down …
18:28:49 [INFO] gameserver.persistence.state_save: Game state saved to state.yaml (2 empires, 0 attacks, 0 battles)
18:28:49 [INFO] websockets.server: server closing
18:28:49 [INFO] gameserver.network.server: Session removed: uid=2
18:28:49 [INFO] websockets.server: server closed
18:28:49 [INFO] gameserver.network.server: WebSocket server stopped
18:28:49 [INFO] __main__:   WebSocket server stopped
18:28:49 [INFO] __main__:   debug dashboard stopped
18:28:49 [INFO] __main__:   database closed
18:28:49 [INFO] __main__:   goodbye
18:28:50 [INFO] __main__: === Game Server starting ===
18:28:50 [INFO] __main__: Loading configuration …
18:28:51 [INFO] __main__:   items:        210 loaded from config
18:28:51 [INFO] __main__:   map:          4 paths, 23 build tiles from config/maps/default.yaml
18:28:51 [INFO] __main__:   ai_templates: 2 entries from config/ai_templates.yaml
18:28:51 [INFO] gameserver.loaders.game_config_loader: Loaded game config from config/game.yaml (29 keys)
18:28:51 [INFO] __main__:   game_config:  loaded
18:28:51 [INFO] __main__: Initializing persistence …
18:28:51 [INFO] gameserver.persistence.database: Database connected: gameserver.db
18:28:51 [INFO] __main__:   database:     connected (gameserver.db)
18:28:51 [INFO] gameserver.persistence.state_load: Restoring state from state.yaml (saved at 2026-02-08T18:28:49, version 1)
18:28:51 [INFO] gameserver.persistence.state_load: Restored 2 empires, 0 attacks, 0 battles
18:28:51 [INFO] __main__:   state:        restored from disk (2 empires, 0 attacks)
18:28:51 [INFO] __main__: Creating services …
18:28:51 [INFO] __main__:   upgrade_provider: 210 items registered
18:28:51 [INFO] __main__:   all services created
18:28:51 [INFO] __main__: Wiring event handlers …
18:28:51 [INFO] __main__:   event handlers registered
18:28:51 [INFO] gameserver.engine.empire_service: Empire registered: uid=100 name='TestImperium'
18:28:51 [INFO] gameserver.engine.empire_service: Empire 100: recalculated effects → {}
18:28:51 [INFO] gameserver.engine.empire_service: Empire registered: uid=2 name='Empire1'
18:28:51 [INFO] gameserver.engine.empire_service: Empire 2: recalculated effects → {'life_offset': 0.001, 'gold_offset': 0.2, 'culture_offset': 0.15000000000000002, 'culture_modifier': 0.1, 'gold_modifier': 0.1, 'build_speed_modifier': 0.1}
18:28:51 [INFO] __main__: Restored 2 empires from saved state
18:28:51 [INFO] __main__: Starting network server …
18:28:51 [INFO] gameserver.network.handlers: Registered 31 message handlers: summary_request, item_request, military_request, map_load_request, map_save_request, new_item, new_structure, delete_structure, upgrade_structure, citizen_upgrade, change_citizen, increase_life, new_army, new_attack_request, change_army, new_wave, change_wave, end_siege, battle_register, battle_unregister, battle_next_wave_request, notification_request, user_message, timeline_request, userinfo_request, hall_of_fame_request, preferences_request, change_preferences, auth_request, signup, create_empire
18:28:51 [INFO] websockets.server: server listening on 0.0.0.0:8765
18:28:51 [INFO] gameserver.network.server: WebSocket server listening on ws://0.0.0.0:8765
18:28:51 [INFO] __main__:   WebSocket server listening on 0.0.0.0:8765
18:28:51 [INFO] gameserver.debug.dashboard: Debug dashboard running at http://0.0.0.0:9000/
18:28:51 [INFO] __main__: Starting game loop …
18:28:51 [INFO] __main__:   game loop running (1 s tick)
18:28:52 [INFO] websockets.server: connection open
18:28:52 [INFO] gameserver.network.server: Session registered: uid=-1
18:28:52 [INFO] gameserver.network.server: Client connected: uid=-1 remote=('192.168.178.2', 60384)
18:28:52 [INFO] gameserver.network.auth: Login success: eem (uid=2)
18:28:52 [INFO] gameserver.network.server: Session registered: uid=2
18:28:52 [INFO] gameserver.network.server: Session upgraded: guest=-1 → uid=2
18:32:04 [INFO] __main__: Shutdown signal received — stopping …
18:32:04 [INFO] __main__: Shutting down …
18:32:04 [INFO] gameserver.persistence.state_save: Game state saved to state.yaml (2 empires, 0 attacks, 0 battles)
18:32:04 [INFO] websockets.server: server closing
18:32:04 [INFO] gameserver.network.server: Session removed: uid=2
18:32:04 [INFO] websockets.server: server closed
18:32:04 [INFO] gameserver.network.server: WebSocket server stopped
18:32:04 [INFO] __main__:   WebSocket server stopped
18:32:04 [INFO] __main__:   debug dashboard stopped
18:32:04 [INFO] __main__:   database closed
18:32:04 [INFO] __main__:   goodbye
18:32:06 [INFO] __main__: === Game Server starting ===
18:32:06 [INFO] __main__: Loading configuration …
18:32:06 [INFO] __main__:   items:        210 loaded from config
18:32:07 [INFO] __main__:   map:          4 paths, 23 build tiles from config/maps/default.yaml
18:32:07 [INFO] __main__:   ai_templates: 2 entries from config/ai_templates.yaml
18:32:07 [INFO] gameserver.loaders.game_config_loader: Loaded game config from config/game.yaml (29 keys)
18:32:07 [INFO] __main__:   game_config:  loaded
18:32:07 [INFO] __main__: Initializing persistence …
18:32:07 [INFO] gameserver.persistence.database: Database connected: gameserver.db
18:32:07 [INFO] __main__:   database:     connected (gameserver.db)
18:32:07 [INFO] gameserver.persistence.state_load: Restoring state from state.yaml (saved at 2026-02-08T18:32:04, version 1)
18:32:07 [INFO] gameserver.persistence.state_load: Restored 2 empires, 0 attacks, 0 battles
18:32:07 [INFO] __main__:   state:        restored from disk (2 empires, 0 attacks)
18:32:07 [INFO] __main__: Creating services …
18:32:07 [INFO] __main__:   upgrade_provider: 210 items registered
18:32:07 [INFO] __main__:   all services created
18:32:07 [INFO] __main__: Wiring event handlers …
18:32:07 [INFO] __main__:   event handlers registered
18:32:07 [INFO] gameserver.engine.empire_service: Empire registered: uid=100 name='TestImperium'
18:32:07 [INFO] gameserver.engine.empire_service: Empire 100: recalculated effects → {}
18:32:07 [INFO] gameserver.engine.empire_service: Empire registered: uid=2 name='Empire1'
18:32:07 [INFO] gameserver.engine.empire_service: Empire 2: recalculated effects → {'life_offset': 0.001, 'gold_offset': 0.2, 'culture_offset': 0.15000000000000002, 'culture_modifier': 0.1, 'gold_modifier': 0.1, 'build_speed_modifier': 0.1}
18:32:07 [INFO] __main__: Restored 2 empires from saved state
18:32:07 [INFO] __main__: Starting network server …
18:32:07 [INFO] gameserver.network.handlers: Registered 31 message handlers: summary_request, item_request, military_request, map_load_request, map_save_request, new_item, new_structure, delete_structure, upgrade_structure, citizen_upgrade, change_citizen, increase_life, new_army, new_attack_request, change_army, new_wave, change_wave, end_siege, battle_register, battle_unregister, battle_next_wave_request, notification_request, user_message, timeline_request, userinfo_request, hall_of_fame_request, preferences_request, change_preferences, auth_request, signup, create_empire
18:32:07 [INFO] websockets.server: server listening on 0.0.0.0:8765
18:32:07 [INFO] gameserver.network.server: WebSocket server listening on ws://0.0.0.0:8765
18:32:07 [INFO] __main__:   WebSocket server listening on 0.0.0.0:8765
18:32:07 [INFO] gameserver.debug.dashboard: Debug dashboard running at http://0.0.0.0:9000/
18:32:07 [INFO] __main__: Starting game loop …
18:32:07 [INFO] __main__:   game loop running (1 s tick)
18:32:07 [INFO] websockets.server: connection open
18:32:07 [INFO] gameserver.network.server: Session registered: uid=-1
18:32:07 [INFO] gameserver.network.server: Client connected: uid=-1 remote=('192.168.178.2', 63856)
18:32:07 [INFO] gameserver.network.auth: Login success: eem (uid=2)
18:32:07 [INFO] gameserver.network.server: Session registered: uid=2
18:32:07 [INFO] gameserver.network.server: Session upgraded: guest=-1 → uid=2
18:32:11 [ERROR] websockets.server: opening handshake failed
Traceback (most recent call last):
  File "/home/pi/e3/.venv/lib/python3.9/site-packages/websockets/http11.py", line 138, in parse
    request_line = yield from parse_line(read_line)
  File "/home/pi/e3/.venv/lib/python3.9/site-packages/websockets/http11.py", line 309, in parse_line
    line = yield from read_line(MAX_LINE_LENGTH)
  File "/home/pi/e3/.venv/lib/python3.9/site-packages/websockets/streams.py", line 46, in read_line
    raise EOFError(f"stream ends after {p} bytes, before end of line")
EOFError: stream ends after 0 bytes, before end of line

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/pi/e3/.venv/lib/python3.9/site-packages/websockets/server.py", line 545, in parse
    request = yield from Request.parse(
  File "/home/pi/e3/.venv/lib/python3.9/site-packages/websockets/http11.py", line 140, in parse
    raise EOFError("connection closed while reading HTTP request line") from exc
EOFError: connection closed while reading HTTP request line

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/pi/e3/.venv/lib/python3.9/site-packages/websockets/asyncio/server.py", line 356, in conn_handler
    await connection.handshake(
  File "/home/pi/e3/.venv/lib/python3.9/site-packages/websockets/asyncio/server.py", line 207, in handshake
    raise self.protocol.handshake_exc
websockets.exceptions.InvalidMessage: did not receive a valid HTTP request
18:32:11 [INFO] gameserver.network.server: Session removed: uid=2
18:32:11 [INFO] websockets.server: connection open
18:32:11 [INFO] gameserver.network.server: Session registered: uid=-2
18:32:11 [INFO] gameserver.network.server: Client connected: uid=-2 remote=('192.168.178.2', 63881)
18:32:11 [INFO] gameserver.network.auth: Login success: eem (uid=2)
18:32:11 [INFO] gameserver.network.server: Session registered: uid=2
18:32:11 [INFO] gameserver.network.server: Session upgraded: guest=-2 → uid=2
18:32:30 [INFO] gameserver.network.server: Session removed: uid=2
18:32:30 [INFO] websockets.server: connection open
18:32:30 [INFO] gameserver.network.server: Session registered: uid=-3
18:32:30 [INFO] gameserver.network.server: Client connected: uid=-3 remote=('192.168.178.2', 63902)
18:32:30 [INFO] gameserver.network.auth: Login success: eem (uid=2)
18:32:30 [INFO] gameserver.network.server: Session registered: uid=2
18:32:30 [INFO] gameserver.network.server: Session upgraded: guest=-3 → uid=2
18:32:31 [INFO] gameserver.network.server: Session removed: uid=2
18:32:31 [INFO] websockets.server: connection open
18:32:31 [INFO] gameserver.network.server: Session registered: uid=-4
18:32:31 [INFO] gameserver.network.server: Client connected: uid=-4 remote=('192.168.178.2', 63906)
18:32:31 [INFO] gameserver.network.auth: Login success: eem (uid=2)
18:32:31 [INFO] gameserver.network.server: Session registered: uid=2
18:32:31 [INFO] gameserver.network.server: Session upgraded: guest=-4 → uid=2
18:32:31 [INFO] gameserver.network.server: Session removed: uid=2
18:32:31 [INFO] websockets.server: connection open
18:32:31 [INFO] gameserver.network.server: Session registered: uid=-5
18:32:31 [INFO] gameserver.network.server: Client connected: uid=-5 remote=('192.168.178.2', 63908)
18:32:32 [INFO] gameserver.network.auth: Login success: eem (uid=2)
18:32:32 [INFO] gameserver.network.server: Session registered: uid=2
18:32:32 [INFO] gameserver.network.server: Session upgraded: guest=-5 → uid=2
18:32:32 [INFO] gameserver.network.server: Session removed: uid=2
18:32:32 [INFO] websockets.server: connection open
18:32:32 [INFO] gameserver.network.server: Session registered: uid=-6
18:32:32 [INFO] gameserver.network.server: Client connected: uid=-6 remote=('192.168.178.2', 63910)
18:32:32 [INFO] gameserver.network.auth: Login success: eem (uid=2)
18:32:32 [INFO] gameserver.network.server: Session registered: uid=2
18:32:32 [INFO] gameserver.network.server: Session upgraded: guest=-6 → uid=2
18:32:32 [INFO] gameserver.network.server: Session removed: uid=2
18:32:32 [INFO] websockets.server: connection open
18:32:32 [INFO] gameserver.network.server: Session registered: uid=-7
18:32:32 [INFO] gameserver.network.server: Client connected: uid=-7 remote=('192.168.178.2', 63913)
18:32:32 [INFO] gameserver.network.auth: Login success: eem (uid=2)
18:32:32 [INFO] gameserver.network.server: Session registered: uid=2
18:32:32 [INFO] gameserver.network.server: Session upgraded: guest=-7 → uid=2
18:32:32 [INFO] gameserver.network.server: Session removed: uid=2
18:32:32 [INFO] websockets.server: connection open
18:32:32 [INFO] gameserver.network.server: Session registered: uid=-8
18:32:32 [INFO] gameserver.network.server: Client connected: uid=-8 remote=('192.168.178.2', 63915)
18:32:32 [INFO] gameserver.network.auth: Login success: eem (uid=2)
18:32:32 [INFO] gameserver.network.server: Session registered: uid=2
18:32:32 [INFO] gameserver.network.server: Session upgraded: guest=-8 → uid=2
18:32:33 [INFO] gameserver.network.server: Session removed: uid=2
18:32:33 [INFO] websockets.server: connection open
18:32:33 [INFO] gameserver.network.server: Session registered: uid=-9
18:32:33 [INFO] gameserver.network.server: Client connected: uid=-9 remote=('192.168.178.2', 63938)
18:32:33 [INFO] gameserver.network.auth: Login success: eem (uid=2)
18:32:33 [INFO] gameserver.network.server: Session registered: uid=2
18:32:33 [INFO] gameserver.network.server: Session upgraded: guest=-9 → uid=2
18:32:50 [INFO] websockets.server: connection open
18:32:50 [INFO] gameserver.network.server: Session registered: uid=-10
18:32:50 [INFO] gameserver.network.server: Client connected: uid=-10 remote=('192.168.178.2', 63958)
18:32:50 [INFO] gameserver.network.auth: Login success: eem (uid=2)
18:32:50 [INFO] gameserver.network.server: Session registered: uid=2
18:32:50 [INFO] gameserver.network.server: Session upgraded: guest=-10 → uid=2
18:32:50 [INFO] gameserver.network.server: Client disconnected: uid=-9 code=1008
18:32:50 [INFO] gameserver.network.server: Session removed: uid=2
18:32:51 [INFO] gameserver.network.server: Session removed: uid=2
18:32:53 [INFO] websockets.server: connection open
18:32:53 [INFO] gameserver.network.server: Session registered: uid=-11
18:32:53 [INFO] gameserver.network.server: Client connected: uid=-11 remote=('192.168.178.2', 63959)
18:32:53 [INFO] gameserver.network.auth: Login success: eem (uid=2)
18:32:53 [INFO] gameserver.network.server: Session registered: uid=2
18:32:53 [INFO] gameserver.network.server: Session upgraded: guest=-11 → uid=2
18:32:54 [INFO] gameserver.network.server: Session removed: uid=2
18:32:55 [INFO] websockets.server: connection open
18:32:55 [INFO] gameserver.network.server: Session registered: uid=-12
18:32:55 [INFO] gameserver.network.server: Client connected: uid=-12 remote=('192.168.178.2', 65006)
18:32:55 [INFO] gameserver.network.auth: Login success: eem (uid=2)
18:32:55 [INFO] gameserver.network.server: Session registered: uid=2
18:32:55 [INFO] gameserver.network.server: Session upgraded: guest=-12 → uid=2
18:32:56 [INFO] gameserver.network.server: Session removed: uid=2
18:32:56 [INFO] websockets.server: connection open
18:32:56 [INFO] gameserver.network.server: Session registered: uid=-13
18:32:56 [INFO] gameserver.network.server: Client connected: uid=-13 remote=('192.168.178.2', 65008)
18:32:56 [INFO] gameserver.network.auth: Login success: eem (uid=2)
18:32:56 [INFO] gameserver.network.server: Session registered: uid=2
18:32:56 [INFO] gameserver.network.server: Session upgraded: guest=-13 → uid=2
18:32:56 [INFO] gameserver.network.server: Session removed: uid=2
18:32:57 [INFO] websockets.server: connection open
18:32:57 [INFO] gameserver.network.server: Session registered: uid=-14
18:32:57 [INFO] gameserver.network.server: Client connected: uid=-14 remote=('192.168.178.2', 65010)
18:32:57 [INFO] gameserver.network.auth: Login success: eem (uid=2)
18:32:57 [INFO] gameserver.network.server: Session registered: uid=2
18:32:57 [INFO] gameserver.network.server: Session upgraded: guest=-14 → uid=2
18:33:45 [INFO] gameserver.network.server: Session removed: uid=2
18:33:45 [INFO] websockets.server: connection open
18:33:45 [INFO] gameserver.network.server: Session registered: uid=-15
18:33:45 [INFO] gameserver.network.server: Client connected: uid=-15 remote=('192.168.178.2', 57059)
18:33:45 [INFO] gameserver.network.auth: Login success: eem (uid=2)
18:33:45 [INFO] gameserver.network.server: Session registered: uid=2
18:33:45 [INFO] gameserver.network.server: Session upgraded: guest=-15 → uid=2
18:33:58 [INFO] __main__: Shutdown signal received — stopping …
18:33:59 [INFO] __main__: Shutting down …
18:33:59 [INFO] gameserver.persistence.state_save: Game state saved to state.yaml (2 empires, 0 attacks, 0 battles)
18:33:59 [INFO] websockets.server: server closing
18:33:59 [INFO] gameserver.network.server: Session removed: uid=2
18:33:59 [INFO] websockets.server: server closed
18:33:59 [INFO] gameserver.network.server: WebSocket server stopped
18:33:59 [INFO] __main__:   WebSocket server stopped
18:33:59 [INFO] __main__:   debug dashboard stopped
18:33:59 [INFO] __main__:   database closed
18:33:59 [INFO] __main__:   goodbye
18:34:01 [INFO] __main__: === Game Server starting ===
18:34:01 [INFO] __main__: Loading configuration …
18:34:02 [INFO] __main__:   items:        210 loaded from config
18:34:02 [INFO] __main__:   map:          4 paths, 23 build tiles from config/maps/default.yaml
18:34:02 [INFO] __main__:   ai_templates: 2 entries from config/ai_templates.yaml
18:34:02 [INFO] gameserver.loaders.game_config_loader: Loaded game config from config/game.yaml (29 keys)
18:34:02 [INFO] __main__:   game_config:  loaded
18:34:02 [INFO] __main__: Initializing persistence …
18:34:02 [INFO] gameserver.persistence.database: Database connected: gameserver.db
18:34:02 [INFO] __main__:   database:     connected (gameserver.db)
18:34:02 [INFO] gameserver.persistence.state_load: Restoring state from state.yaml (saved at 2026-02-08T18:33:59, version 1)
18:34:02 [INFO] gameserver.persistence.state_load: Restored 2 empires, 0 attacks, 0 battles
18:34:02 [INFO] __main__:   state:        restored from disk (2 empires, 0 attacks)
18:34:02 [INFO] __main__: Creating services …
18:34:02 [INFO] __main__:   upgrade_provider: 210 items registered
18:34:02 [INFO] __main__:   all services created
18:34:02 [INFO] __main__: Wiring event handlers …
18:34:02 [INFO] __main__:   event handlers registered
18:34:02 [INFO] gameserver.engine.empire_service: Empire registered: uid=100 name='TestImperium'
18:34:02 [INFO] gameserver.engine.empire_service: Empire 100: recalculated effects → {}
18:34:02 [INFO] gameserver.engine.empire_service: Empire registered: uid=2 name='Empire1'
18:34:02 [INFO] gameserver.engine.empire_service: Empire 2: recalculated effects → {'life_offset': 0.001, 'gold_offset': 0.2, 'culture_offset': 0.15000000000000002, 'culture_modifier': 0.1, 'gold_modifier': 0.1, 'build_speed_modifier': 0.1}
18:34:02 [INFO] __main__: Restored 2 empires from saved state
18:34:02 [INFO] __main__: Starting network server …
18:34:02 [INFO] gameserver.network.handlers: Registered 31 message handlers: summary_request, item_request, military_request, map_load_request, map_save_request, new_item, new_structure, delete_structure, upgrade_structure, citizen_upgrade, change_citizen, increase_life, new_army, new_attack_request, change_army, new_wave, change_wave, end_siege, battle_register, battle_unregister, battle_next_wave_request, notification_request, user_message, timeline_request, userinfo_request, hall_of_fame_request, preferences_request, change_preferences, auth_request, signup, create_empire
18:34:02 [INFO] websockets.server: server listening on 0.0.0.0:8765
18:34:02 [INFO] gameserver.network.server: WebSocket server listening on ws://0.0.0.0:8765
18:34:02 [INFO] __main__:   WebSocket server listening on 0.0.0.0:8765
18:34:02 [INFO] gameserver.debug.dashboard: Debug dashboard running at http://0.0.0.0:9000/
18:34:02 [INFO] __main__: Starting game loop …
18:34:02 [INFO] __main__:   game loop running (1 s tick)
18:34:02 [INFO] websockets.server: connection open
18:34:02 [INFO] gameserver.network.server: Session registered: uid=-1
18:34:02 [INFO] gameserver.network.server: Client connected: uid=-1 remote=('192.168.178.2', 50001)
18:34:02 [INFO] gameserver.network.server: Client disconnected: uid=-1 code=CloseCode.ABNORMAL_CLOSURE
18:34:02 [INFO] gameserver.network.server: Session removed: uid=-1
18:34:02 [INFO] websockets.server: connection open
18:34:02 [INFO] gameserver.network.server: Session registered: uid=-2
18:34:02 [INFO] gameserver.network.server: Client connected: uid=-2 remote=('192.168.178.2', 50004)
18:34:02 [INFO] gameserver.network.auth: Login success: eem (uid=2)
18:34:02 [INFO] gameserver.network.server: Session registered: uid=2
18:34:02 [INFO] gameserver.network.server: Session upgraded: guest=-2 → uid=2
18:34:03 [INFO] gameserver.network.server: Session removed: uid=2
18:34:03 [INFO] websockets.server: connection open
18:34:03 [INFO] gameserver.network.server: Session registered: uid=-3
18:34:03 [INFO] gameserver.network.server: Client connected: uid=-3 remote=('192.168.178.2', 50006)
18:34:03 [INFO] gameserver.network.auth: Login success: eem (uid=2)
18:34:03 [INFO] gameserver.network.server: Session registered: uid=2
18:34:03 [INFO] gameserver.network.server: Session upgraded: guest=-3 → uid=2
18:34:07 [ERROR] websockets.server: opening handshake failed
Traceback (most recent call last):
  File "/home/pi/e3/.venv/lib/python3.9/site-packages/websockets/http11.py", line 138, in parse
    request_line = yield from parse_line(read_line)
  File "/home/pi/e3/.venv/lib/python3.9/site-packages/websockets/http11.py", line 309, in parse_line
    line = yield from read_line(MAX_LINE_LENGTH)
  File "/home/pi/e3/.venv/lib/python3.9/site-packages/websockets/streams.py", line 46, in read_line
    raise EOFError(f"stream ends after {p} bytes, before end of line")
EOFError: stream ends after 0 bytes, before end of line

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/pi/e3/.venv/lib/python3.9/site-packages/websockets/server.py", line 545, in parse
    request = yield from Request.parse(
  File "/home/pi/e3/.venv/lib/python3.9/site-packages/websockets/http11.py", line 140, in parse
    raise EOFError("connection closed while reading HTTP request line") from exc
EOFError: connection closed while reading HTTP request line

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/pi/e3/.venv/lib/python3.9/site-packages/websockets/asyncio/server.py", line 356, in conn_handler
    await connection.handshake(
  File "/home/pi/e3/.venv/lib/python3.9/site-packages/websockets/asyncio/server.py", line 207, in handshake
    raise self.protocol.handshake_exc
websockets.exceptions.InvalidMessage: did not receive a valid HTTP request
18:34:27 [INFO] gameserver.engine.empire_service: Empire 2: started research HERBOLOGY (effort=800.0)
18:34:27 [INFO] gameserver.network.handlers: new_item success uid=2 iid=HERBOLOGY
18:35:06 [INFO] __main__: Shutdown signal received — stopping …
18:35:07 [INFO] __main__: Shutting down …
18:35:07 [INFO] gameserver.persistence.state_save: Game state saved to state.yaml (2 empires, 0 attacks, 0 battles)
18:35:07 [INFO] websockets.server: server closing
18:35:07 [INFO] gameserver.network.server: Session removed: uid=2
18:35:07 [INFO] websockets.server: server closed
18:35:07 [INFO] gameserver.network.server: WebSocket server stopped
18:35:07 [INFO] __main__:   WebSocket server stopped
18:35:07 [INFO] __main__:   debug dashboard stopped
18:35:07 [INFO] __main__:   database closed
18:35:07 [INFO] __main__:   goodbye
18:35:08 [INFO] __main__: === Game Server starting ===
18:35:08 [INFO] __main__: Loading configuration …
18:35:09 [INFO] __main__:   items:        210 loaded from config
18:35:09 [INFO] __main__:   map:          4 paths, 23 build tiles from config/maps/default.yaml
18:35:09 [INFO] __main__:   ai_templates: 2 entries from config/ai_templates.yaml
18:35:09 [INFO] gameserver.loaders.game_config_loader: Loaded game config from config/game.yaml (29 keys)
18:35:09 [INFO] __main__:   game_config:  loaded
18:35:09 [INFO] __main__: Initializing persistence …
18:35:09 [INFO] gameserver.persistence.database: Database connected: gameserver.db
18:35:09 [INFO] __main__:   database:     connected (gameserver.db)
18:35:09 [INFO] gameserver.persistence.state_load: Restoring state from state.yaml (saved at 2026-02-08T18:35:07, version 1)
18:35:09 [INFO] gameserver.persistence.state_load: Restored 2 empires, 0 attacks, 0 battles
18:35:09 [INFO] __main__:   state:        restored from disk (2 empires, 0 attacks)
18:35:09 [INFO] __main__: Creating services …
18:35:09 [INFO] __main__:   upgrade_provider: 210 items registered
18:35:09 [INFO] __main__:   all services created
18:35:09 [INFO] __main__: Wiring event handlers …
18:35:09 [INFO] __main__:   event handlers registered
18:35:09 [INFO] gameserver.engine.empire_service: Empire registered: uid=100 name='TestImperium'
18:35:09 [INFO] gameserver.engine.empire_service: Empire 100: recalculated effects → {}
18:35:09 [INFO] gameserver.engine.empire_service: Empire registered: uid=2 name='Empire1'
18:35:09 [INFO] gameserver.engine.empire_service: Empire 2: recalculated effects → {'life_offset': 0.001, 'gold_offset': 0.2, 'culture_offset': 0.15000000000000002, 'culture_modifier': 0.1, 'gold_modifier': 0.1, 'build_speed_modifier': 0.1}
18:35:09 [INFO] __main__: Restored 2 empires from saved state
18:35:09 [INFO] __main__: Starting network server …
18:35:09 [INFO] gameserver.network.handlers: Registered 31 message handlers: summary_request, item_request, military_request, map_load_request, map_save_request, new_item, new_structure, delete_structure, upgrade_structure, citizen_upgrade, change_citizen, increase_life, new_army, new_attack_request, change_army, new_wave, change_wave, end_siege, battle_register, battle_unregister, battle_next_wave_request, notification_request, user_message, timeline_request, userinfo_request, hall_of_fame_request, preferences_request, change_preferences, auth_request, signup, create_empire
18:35:09 [INFO] websockets.server: server listening on 0.0.0.0:8765
18:35:09 [INFO] gameserver.network.server: WebSocket server listening on ws://0.0.0.0:8765
18:35:09 [INFO] __main__:   WebSocket server listening on 0.0.0.0:8765
18:35:09 [INFO] gameserver.debug.dashboard: Debug dashboard running at http://0.0.0.0:9000/
18:35:09 [INFO] __main__: Starting game loop …
18:35:09 [INFO] __main__:   game loop running (1 s tick)
18:35:10 [INFO] websockets.server: connection open
18:35:10 [INFO] gameserver.network.server: Session registered: uid=-1
18:35:10 [INFO] gameserver.network.server: Client connected: uid=-1 remote=('192.168.178.2', 58743)
18:35:10 [INFO] gameserver.network.auth: Login success: eem (uid=2)
18:35:10 [INFO] gameserver.network.server: Session registered: uid=2
18:35:10 [INFO] gameserver.network.server: Session upgraded: guest=-1 → uid=2
18:40:06 [INFO] __main__: Shutdown signal received — stopping …
18:40:07 [INFO] __main__: Shutting down …
18:40:07 [INFO] gameserver.persistence.state_save: Game state saved to state.yaml (2 empires, 0 attacks, 0 battles)
18:40:07 [INFO] websockets.server: server closing
18:40:07 [INFO] gameserver.network.server: Session removed: uid=2
18:40:07 [INFO] websockets.server: server closed
18:40:07 [INFO] gameserver.network.server: WebSocket server stopped
18:40:07 [INFO] __main__:   WebSocket server stopped
18:40:07 [INFO] __main__:   debug dashboard stopped
18:40:07 [INFO] __main__:   database closed
18:40:07 [INFO] __main__:   goodbye
18:40:09 [INFO] __main__: === Game Server starting ===
18:40:09 [INFO] __main__: Loading configuration …
18:40:10 [INFO] __main__:   items:        210 loaded from config
18:40:10 [INFO] __main__:   map:          4 paths, 23 build tiles from config/maps/default.yaml
18:40:10 [INFO] __main__:   ai_templates: 2 entries from config/ai_templates.yaml
18:40:10 [INFO] gameserver.loaders.game_config_loader: Loaded game config from config/game.yaml (29 keys)
18:40:10 [INFO] __main__:   game_config:  loaded
18:40:10 [INFO] __main__: Initializing persistence …
18:40:10 [INFO] gameserver.persistence.database: Database connected: gameserver.db
18:40:10 [INFO] __main__:   database:     connected (gameserver.db)
18:40:10 [INFO] gameserver.persistence.state_load: Restoring state from state.yaml (saved at 2026-02-08T18:40:07, version 1)
18:40:10 [INFO] gameserver.persistence.state_load: Restored 2 empires, 0 attacks, 0 battles
18:40:10 [INFO] __main__:   state:        restored from disk (2 empires, 0 attacks)
18:40:10 [INFO] __main__: Creating services …
18:40:10 [INFO] __main__:   upgrade_provider: 210 items registered
18:40:10 [INFO] __main__:   all services created
18:40:10 [INFO] __main__: Wiring event handlers …
18:40:10 [INFO] __main__:   event handlers registered
18:40:10 [INFO] gameserver.engine.empire_service: Empire registered: uid=100 name='TestImperium'
18:40:10 [INFO] gameserver.engine.empire_service: Empire 100: recalculated effects → {}
18:40:10 [INFO] gameserver.engine.empire_service: Empire registered: uid=2 name='Empire1'
18:40:10 [INFO] gameserver.engine.empire_service: Empire 2: recalculated effects → {'life_offset': 0.001, 'gold_offset': 0.2, 'culture_offset': 0.15000000000000002, 'culture_modifier': 0.1, 'gold_modifier': 0.1, 'build_speed_modifier': 0.1}
18:40:10 [INFO] __main__: Restored 2 empires from saved state
18:40:10 [INFO] __main__: Starting network server …
18:40:10 [INFO] gameserver.network.handlers: Registered 31 message handlers: summary_request, item_request, military_request, map_load_request, map_save_request, new_item, new_structure, delete_structure, upgrade_structure, citizen_upgrade, change_citizen, increase_life, new_army, new_attack_request, change_army, new_wave, change_wave, end_siege, battle_register, battle_unregister, battle_next_wave_request, notification_request, user_message, timeline_request, userinfo_request, hall_of_fame_request, preferences_request, change_preferences, auth_request, signup, create_empire
18:40:10 [INFO] websockets.server: server listening on 0.0.0.0:8765
18:40:10 [INFO] gameserver.network.server: WebSocket server listening on ws://0.0.0.0:8765
18:40:10 [INFO] __main__:   WebSocket server listening on 0.0.0.0:8765
18:40:10 [INFO] gameserver.debug.dashboard: Debug dashboard running at http://0.0.0.0:9000/
18:40:10 [INFO] __main__: Starting game loop …
18:40:10 [INFO] __main__:   game loop running (1 s tick)
18:40:10 [INFO] websockets.server: connection open
18:40:10 [INFO] gameserver.network.server: Session registered: uid=-1
18:40:10 [INFO] gameserver.network.server: Client connected: uid=-1 remote=('192.168.178.2', 49370)
18:40:10 [INFO] gameserver.network.auth: Login success: eem (uid=2)
18:40:10 [INFO] gameserver.network.server: Session registered: uid=2
18:40:10 [INFO] gameserver.network.server: Session upgraded: guest=-1 → uid=2
18:40:28 [INFO] gameserver.network.server: Session removed: uid=2
18:40:28 [INFO] websockets.server: connection open
18:40:28 [INFO] gameserver.network.server: Session registered: uid=-2
18:40:28 [INFO] gameserver.network.server: Client connected: uid=-2 remote=('192.168.178.2', 49384)
18:40:28 [INFO] gameserver.network.auth: Login success: eem (uid=2)
18:40:28 [INFO] gameserver.network.server: Session registered: uid=2
18:40:28 [INFO] gameserver.network.server: Session upgraded: guest=-2 → uid=2
18:40:31 [INFO] gameserver.network.server: Session removed: uid=2
18:40:31 [INFO] websockets.server: connection open
18:40:31 [INFO] gameserver.network.server: Session registered: uid=-3
18:40:31 [INFO] gameserver.network.server: Client connected: uid=-3 remote=('192.168.178.2', 49388)
18:40:31 [INFO] gameserver.network.auth: Login success: eem (uid=2)
18:40:31 [INFO] gameserver.network.server: Session registered: uid=2
18:40:31 [INFO] gameserver.network.server: Session upgraded: guest=-3 → uid=2
18:40:31 [INFO] gameserver.network.server: Session removed: uid=2
18:40:31 [INFO] websockets.server: connection open
18:40:31 [INFO] gameserver.network.server: Session registered: uid=-4
18:40:31 [INFO] gameserver.network.server: Client connected: uid=-4 remote=('192.168.178.2', 49391)
18:40:31 [INFO] gameserver.network.auth: Login success: eem (uid=2)
18:40:31 [INFO] gameserver.network.server: Session registered: uid=2
18:40:31 [INFO] gameserver.network.server: Session upgraded: guest=-4 → uid=2
18:40:31 [INFO] gameserver.network.server: Session removed: uid=2
18:40:31 [INFO] websockets.server: connection open
18:40:31 [INFO] gameserver.network.server: Session registered: uid=-5
18:40:31 [INFO] gameserver.network.server: Client connected: uid=-5 remote=('192.168.178.2', 49394)
18:40:31 [INFO] gameserver.network.auth: Login success: eem (uid=2)
18:40:31 [INFO] gameserver.network.server: Session registered: uid=2
18:40:31 [INFO] gameserver.network.server: Session upgraded: guest=-5 → uid=2
18:40:31 [INFO] gameserver.network.server: Session removed: uid=2
18:40:31 [INFO] websockets.server: connection open
18:40:31 [INFO] gameserver.network.server: Session registered: uid=-6
18:40:31 [INFO] gameserver.network.server: Client connected: uid=-6 remote=('192.168.178.2', 49397)
18:40:31 [INFO] gameserver.network.auth: Login success: eem (uid=2)
18:40:31 [INFO] gameserver.network.server: Session registered: uid=2
18:40:31 [INFO] gameserver.network.server: Session upgraded: guest=-6 → uid=2
18:40:33 [INFO] gameserver.network.server: Session removed: uid=2
18:40:33 [INFO] websockets.server: connection open
18:40:33 [INFO] gameserver.network.server: Session registered: uid=-7
18:40:33 [INFO] gameserver.network.server: Client connected: uid=-7 remote=('192.168.178.2', 49420)
18:40:33 [INFO] gameserver.network.auth: Login success: eem (uid=2)
18:40:33 [INFO] gameserver.network.server: Session registered: uid=2
18:40:33 [INFO] gameserver.network.server: Session upgraded: guest=-7 → uid=2
18:40:34 [INFO] gameserver.network.server: Session removed: uid=2
18:40:34 [INFO] websockets.server: connection open
18:40:34 [INFO] gameserver.network.server: Session registered: uid=-8
18:40:34 [INFO] gameserver.network.server: Client connected: uid=-8 remote=('192.168.178.2', 49423)
18:40:34 [INFO] gameserver.network.auth: Login success: eem (uid=2)
18:40:34 [INFO] gameserver.network.server: Session registered: uid=2
18:40:34 [INFO] gameserver.network.server: Session upgraded: guest=-8 → uid=2
18:40:34 [INFO] gameserver.network.server: Session removed: uid=2
18:40:34 [INFO] websockets.server: connection open
18:40:34 [INFO] gameserver.network.server: Session registered: uid=-9
18:40:34 [INFO] gameserver.network.server: Client connected: uid=-9 remote=('192.168.178.2', 49426)
18:40:34 [INFO] gameserver.network.auth: Login success: eem (uid=2)
18:40:34 [INFO] gameserver.network.server: Session registered: uid=2
18:40:34 [INFO] gameserver.network.server: Session upgraded: guest=-9 → uid=2
18:40:34 [INFO] gameserver.network.server: Session removed: uid=2
18:40:35 [INFO] websockets.server: connection open
18:40:35 [INFO] gameserver.network.server: Session registered: uid=-10
18:40:35 [INFO] gameserver.network.server: Client connected: uid=-10 remote=('192.168.178.2', 49429)
18:40:35 [INFO] gameserver.network.auth: Login success: eem (uid=2)
18:40:35 [INFO] gameserver.network.server: Session registered: uid=2
18:40:35 [INFO] gameserver.network.server: Session upgraded: guest=-10 → uid=2
18:40:35 [INFO] gameserver.network.server: Session removed: uid=2
18:40:35 [INFO] websockets.server: connection open
18:40:35 [INFO] gameserver.network.server: Session registered: uid=-11
18:40:35 [INFO] gameserver.network.server: Client connected: uid=-11 remote=('192.168.178.2', 49434)
18:40:35 [INFO] gameserver.network.auth: Login success: eem (uid=2)
18:40:35 [INFO] gameserver.network.server: Session registered: uid=2
18:40:35 [INFO] gameserver.network.server: Session upgraded: guest=-11 → uid=2
18:40:38 [INFO] gameserver.network.handlers: Map saved for empire Empire1 (uid=2): 0 tiles
18:41:03 [INFO] __main__: Shutdown signal received — stopping …
18:41:03 [INFO] __main__: Shutting down …
18:41:03 [INFO] gameserver.persistence.state_save: Game state saved to state.yaml (2 empires, 0 attacks, 0 battles)
18:41:03 [INFO] websockets.server: server closing
18:41:03 [INFO] gameserver.network.server: Session removed: uid=2
18:41:03 [INFO] websockets.server: server closed
18:41:03 [INFO] gameserver.network.server: WebSocket server stopped
18:41:03 [INFO] __main__:   WebSocket server stopped
18:41:03 [INFO] __main__:   debug dashboard stopped
18:41:03 [INFO] __main__:   database closed
18:41:03 [INFO] __main__:   goodbye
18:41:30 [INFO] __main__: === Game Server starting ===
18:41:30 [INFO] __main__: Loading configuration …
18:41:31 [INFO] __main__:   items:        210 loaded from config
18:41:31 [INFO] __main__:   map:          4 paths, 23 build tiles from config/maps/default.yaml
18:41:31 [INFO] __main__:   ai_templates: 2 entries from config/ai_templates.yaml
18:41:31 [INFO] gameserver.loaders.game_config_loader: Loaded game config from config/game.yaml (29 keys)
18:41:31 [INFO] __main__:   game_config:  loaded
18:41:31 [INFO] __main__: Initializing persistence …
18:41:31 [INFO] gameserver.persistence.database: Database connected: gameserver.db
18:41:31 [INFO] __main__:   database:     connected (gameserver.db)
18:41:31 [INFO] gameserver.persistence.state_load: Restoring state from state.yaml (saved at 2026-02-08T18:41:03, version 1)
18:41:31 [INFO] gameserver.persistence.state_load: Restored 2 empires, 0 attacks, 0 battles
18:41:31 [INFO] __main__:   state:        restored from disk (2 empires, 0 attacks)
18:41:31 [INFO] __main__: Creating services …
18:41:31 [INFO] __main__:   upgrade_provider: 210 items registered
18:41:31 [INFO] __main__:   all services created
18:41:31 [INFO] __main__: Wiring event handlers …
18:41:31 [INFO] __main__:   event handlers registered
18:41:31 [INFO] gameserver.engine.empire_service: Empire registered: uid=100 name='TestImperium'
18:41:31 [INFO] gameserver.engine.empire_service: Empire 100: recalculated effects → {}
18:41:31 [INFO] gameserver.engine.empire_service: Empire registered: uid=2 name='Empire1'
18:41:31 [INFO] gameserver.engine.empire_service: Empire 2: recalculated effects → {'life_offset': 0.001, 'gold_offset': 0.2, 'culture_offset': 0.15000000000000002, 'culture_modifier': 0.1, 'gold_modifier': 0.1, 'build_speed_modifier': 0.1}
18:41:31 [INFO] __main__: Restored 2 empires from saved state
18:41:31 [INFO] __main__: Starting network server …
18:41:31 [INFO] gameserver.network.handlers: Registered 31 message handlers: summary_request, item_request, military_request, map_load_request, map_save_request, new_item, new_structure, delete_structure, upgrade_structure, citizen_upgrade, change_citizen, increase_life, new_army, new_attack_request, change_army, new_wave, change_wave, end_siege, battle_register, battle_unregister, battle_next_wave_request, notification_request, user_message, timeline_request, userinfo_request, hall_of_fame_request, preferences_request, change_preferences, auth_request, signup, create_empire
18:41:31 [INFO] websockets.server: server listening on 0.0.0.0:8765
18:41:31 [INFO] gameserver.network.server: WebSocket server listening on ws://0.0.0.0:8765
18:41:31 [INFO] __main__:   WebSocket server listening on 0.0.0.0:8765
18:41:31 [INFO] gameserver.debug.dashboard: Debug dashboard running at http://0.0.0.0:9000/
18:41:31 [INFO] __main__: Starting game loop …
18:41:31 [INFO] __main__:   game loop running (1 s tick)
18:41:32 [INFO] websockets.server: connection open
18:41:32 [INFO] gameserver.network.server: Session registered: uid=-1
18:41:32 [INFO] gameserver.network.server: Client connected: uid=-1 remote=('192.168.178.2', 58532)
18:41:32 [INFO] gameserver.network.auth: Login success: eem (uid=2)
18:41:32 [INFO] gameserver.network.server: Session registered: uid=2
18:41:32 [INFO] gameserver.network.server: Session upgraded: guest=-1 → uid=2
18:41:43 [INFO] gameserver.network.server: Session removed: uid=2
18:41:43 [INFO] websockets.server: connection open
18:41:43 [INFO] gameserver.network.server: Session registered: uid=-2
18:41:43 [INFO] gameserver.network.server: Client connected: uid=-2 remote=('192.168.178.2', 58538)
18:41:43 [INFO] gameserver.network.auth: Login success: eem (uid=2)
18:41:43 [INFO] gameserver.network.server: Session registered: uid=2
18:41:43 [INFO] gameserver.network.server: Session upgraded: guest=-2 → uid=2
18:41:50 [INFO] gameserver.network.handlers: Map saved for empire Empire1 (uid=2): 0 tiles
18:41:51 [INFO] gameserver.network.handlers: Map saved for empire Empire1 (uid=2): 0 tiles
18:41:51 [INFO] gameserver.network.handlers: Map saved for empire Empire1 (uid=2): 0 tiles
18:41:59 [INFO] __main__: Shutdown signal received — stopping …
18:42:00 [INFO] __main__: Shutting down …
18:42:00 [INFO] gameserver.persistence.state_save: Game state saved to state.yaml (2 empires, 0 attacks, 0 battles)
18:42:00 [INFO] websockets.server: server closing
18:42:00 [INFO] gameserver.network.server: Session removed: uid=2
18:42:00 [INFO] websockets.server: server closed
18:42:00 [INFO] gameserver.network.server: WebSocket server stopped
18:42:00 [INFO] __main__:   WebSocket server stopped
18:42:00 [INFO] __main__:   debug dashboard stopped
18:42:00 [INFO] __main__:   database closed
18:42:00 [INFO] __main__:   goodbye
18:42:01 [INFO] __main__: === Game Server starting ===
18:42:01 [INFO] __main__: Loading configuration …
18:42:02 [INFO] __main__:   items:        210 loaded from config
18:42:02 [INFO] __main__:   map:          4 paths, 23 build tiles from config/maps/default.yaml
18:42:02 [INFO] __main__:   ai_templates: 2 entries from config/ai_templates.yaml
18:42:02 [INFO] gameserver.loaders.game_config_loader: Loaded game config from config/game.yaml (29 keys)
18:42:02 [INFO] __main__:   game_config:  loaded
18:42:02 [INFO] __main__: Initializing persistence …
18:42:02 [INFO] gameserver.persistence.database: Database connected: gameserver.db
18:42:02 [INFO] __main__:   database:     connected (gameserver.db)
18:42:02 [INFO] gameserver.persistence.state_load: Restoring state from state.yaml (saved at 2026-02-08T18:42:00, version 1)
18:42:02 [INFO] gameserver.persistence.state_load: Restored 2 empires, 0 attacks, 0 battles
18:42:02 [INFO] __main__:   state:        restored from disk (2 empires, 0 attacks)
18:42:02 [INFO] __main__: Creating services …
18:42:02 [INFO] __main__:   upgrade_provider: 210 items registered
18:42:02 [INFO] __main__:   all services created
18:42:02 [INFO] __main__: Wiring event handlers …
18:42:02 [INFO] __main__:   event handlers registered
18:42:02 [INFO] gameserver.engine.empire_service: Empire registered: uid=100 name='TestImperium'
18:42:02 [INFO] gameserver.engine.empire_service: Empire 100: recalculated effects → {}
18:42:02 [INFO] gameserver.engine.empire_service: Empire registered: uid=2 name='Empire1'
18:42:02 [INFO] gameserver.engine.empire_service: Empire 2: recalculated effects → {'life_offset': 0.001, 'gold_offset': 0.2, 'culture_offset': 0.15000000000000002, 'culture_modifier': 0.1, 'gold_modifier': 0.1, 'build_speed_modifier': 0.1}
18:42:02 [INFO] __main__: Restored 2 empires from saved state
18:42:02 [INFO] __main__: Starting network server …
18:42:02 [INFO] gameserver.network.handlers: Registered 31 message handlers: summary_request, item_request, military_request, map_load_request, map_save_request, new_item, new_structure, delete_structure, upgrade_structure, citizen_upgrade, change_citizen, increase_life, new_army, new_attack_request, change_army, new_wave, change_wave, end_siege, battle_register, battle_unregister, battle_next_wave_request, notification_request, user_message, timeline_request, userinfo_request, hall_of_fame_request, preferences_request, change_preferences, auth_request, signup, create_empire
18:42:02 [INFO] websockets.server: server listening on 0.0.0.0:8765
18:42:02 [INFO] gameserver.network.server: WebSocket server listening on ws://0.0.0.0:8765
18:42:02 [INFO] __main__:   WebSocket server listening on 0.0.0.0:8765
18:42:02 [INFO] gameserver.debug.dashboard: Debug dashboard running at http://0.0.0.0:9000/
18:42:02 [INFO] __main__: Starting game loop …
18:42:02 [INFO] __main__:   game loop running (1 s tick)
18:42:03 [INFO] websockets.server: connection open
18:42:03 [INFO] gameserver.network.server: Session registered: uid=-1
18:42:03 [INFO] gameserver.network.server: Client connected: uid=-1 remote=('192.168.178.2', 57199)
18:42:03 [INFO] gameserver.network.auth: Login success: eem (uid=2)
18:42:03 [INFO] gameserver.network.server: Session registered: uid=2
18:42:03 [INFO] gameserver.network.server: Session upgraded: guest=-1 → uid=2
18:43:14 [INFO] gameserver.network.handlers: Map saved for empire Empire1 (uid=2): 0 tiles
18:45:44 [INFO] __main__: Shutdown signal received — stopping …
18:45:45 [INFO] __main__: Shutting down …
18:45:45 [INFO] gameserver.persistence.state_save: Game state saved to state.yaml (2 empires, 0 attacks, 0 battles)
18:45:45 [INFO] websockets.server: server closing
18:45:45 [INFO] gameserver.network.server: Session removed: uid=2
18:45:45 [INFO] websockets.server: server closed
18:45:45 [INFO] gameserver.network.server: WebSocket server stopped
18:45:45 [INFO] __main__:   WebSocket server stopped
18:45:45 [INFO] __main__:   debug dashboard stopped
18:45:45 [INFO] __main__:   database closed
18:45:45 [INFO] __main__:   goodbye
18:45:46 [INFO] __main__: === Game Server starting ===
18:45:46 [INFO] __main__: Loading configuration …
18:45:46 [INFO] __main__:   items:        210 loaded from config
18:45:46 [INFO] __main__:   map:          4 paths, 23 build tiles from config/maps/default.yaml
18:45:46 [INFO] __main__:   ai_templates: 2 entries from config/ai_templates.yaml
18:45:46 [INFO] gameserver.loaders.game_config_loader: Loaded game config from config/game.yaml (29 keys)
18:45:46 [INFO] __main__:   game_config:  loaded
18:45:46 [INFO] __main__: Initializing persistence …
18:45:46 [INFO] gameserver.persistence.database: Database connected: gameserver.db
18:45:46 [INFO] __main__:   database:     connected (gameserver.db)
18:45:47 [INFO] gameserver.persistence.state_load: Restoring state from state.yaml (saved at 2026-02-08T18:45:44, version 1)
18:45:47 [INFO] gameserver.persistence.state_load: Restored 2 empires, 0 attacks, 0 battles
18:45:47 [INFO] __main__:   state:        restored from disk (2 empires, 0 attacks)
18:45:47 [INFO] __main__: Creating services …
18:45:47 [INFO] __main__:   upgrade_provider: 210 items registered
18:45:47 [INFO] __main__:   all services created
18:45:47 [INFO] __main__: Wiring event handlers …
18:45:47 [INFO] __main__:   event handlers registered
18:45:47 [INFO] gameserver.engine.empire_service: Empire registered: uid=100 name='TestImperium'
18:45:47 [INFO] gameserver.engine.empire_service: Empire 100: recalculated effects → {}
18:45:47 [INFO] gameserver.engine.empire_service: Empire registered: uid=2 name='Empire1'
18:45:47 [INFO] gameserver.engine.empire_service: Empire 2: recalculated effects → {'life_offset': 0.001, 'gold_offset': 0.2, 'culture_offset': 0.15000000000000002, 'culture_modifier': 0.1, 'gold_modifier': 0.1, 'build_speed_modifier': 0.1}
18:45:47 [INFO] __main__: Restored 2 empires from saved state
18:45:47 [INFO] __main__: Starting network server …
18:45:47 [INFO] gameserver.network.handlers: Registered 31 message handlers: summary_request, item_request, military_request, map_load_request, map_save_request, new_item, new_structure, delete_structure, upgrade_structure, citizen_upgrade, change_citizen, increase_life, new_army, new_attack_request, change_army, new_wave, change_wave, end_siege, battle_register, battle_unregister, battle_next_wave_request, notification_request, user_message, timeline_request, userinfo_request, hall_of_fame_request, preferences_request, change_preferences, auth_request, signup, create_empire
18:45:47 [INFO] websockets.server: server listening on 0.0.0.0:8765
18:45:47 [INFO] gameserver.network.server: WebSocket server listening on ws://0.0.0.0:8765
18:45:47 [INFO] __main__:   WebSocket server listening on 0.0.0.0:8765
18:45:47 [INFO] gameserver.debug.dashboard: Debug dashboard running at http://0.0.0.0:9000/
18:45:47 [INFO] __main__: Starting game loop …
18:45:47 [INFO] __main__:   game loop running (1 s tick)
18:45:48 [INFO] websockets.server: connection open
18:45:48 [INFO] gameserver.network.server: Session registered: uid=-1
18:45:48 [INFO] gameserver.network.server: Client connected: uid=-1 remote=('192.168.178.2', 61182)
18:45:48 [INFO] gameserver.network.auth: Login success: eem (uid=2)
18:45:48 [INFO] gameserver.network.server: Session registered: uid=2
18:45:48 [INFO] gameserver.network.server: Session upgraded: guest=-1 → uid=2
18:46:32 [INFO] __main__: Shutdown signal received — stopping …
18:46:33 [INFO] __main__: Shutting down …
18:46:33 [INFO] gameserver.persistence.state_save: Game state saved to state.yaml (2 empires, 0 attacks, 0 battles)
18:46:33 [INFO] websockets.server: server closing
18:46:33 [INFO] gameserver.network.server: Session removed: uid=2
18:46:33 [INFO] websockets.server: server closed
18:46:33 [INFO] gameserver.network.server: WebSocket server stopped
18:46:33 [INFO] __main__:   WebSocket server stopped
18:46:33 [INFO] __main__:   debug dashboard stopped
18:46:33 [INFO] __main__:   database closed
18:46:33 [INFO] __main__:   goodbye
18:46:34 [INFO] __main__: === Game Server starting ===
18:46:34 [INFO] __main__: Loading configuration …
18:46:35 [INFO] __main__:   items:        210 loaded from config
18:46:35 [INFO] __main__:   map:          4 paths, 23 build tiles from config/maps/default.yaml
18:46:35 [INFO] __main__:   ai_templates: 2 entries from config/ai_templates.yaml
18:46:35 [INFO] gameserver.loaders.game_config_loader: Loaded game config from config/game.yaml (29 keys)
18:46:35 [INFO] __main__:   game_config:  loaded
18:46:35 [INFO] __main__: Initializing persistence …
18:46:35 [INFO] gameserver.persistence.database: Database connected: gameserver.db
18:46:35 [INFO] __main__:   database:     connected (gameserver.db)
18:46:35 [INFO] gameserver.persistence.state_load: Restoring state from state.yaml (saved at 2026-02-08T18:46:33, version 1)
18:46:35 [INFO] gameserver.persistence.state_load: Restored 2 empires, 0 attacks, 0 battles
18:46:35 [INFO] __main__:   state:        restored from disk (2 empires, 0 attacks)
18:46:35 [INFO] __main__: Creating services …
18:46:35 [INFO] __main__:   upgrade_provider: 210 items registered
18:46:35 [INFO] __main__:   all services created
18:46:35 [INFO] __main__: Wiring event handlers …
18:46:35 [INFO] __main__:   event handlers registered
18:46:35 [INFO] gameserver.engine.empire_service: Empire registered: uid=100 name='TestImperium'
18:46:35 [INFO] gameserver.engine.empire_service: Empire 100: recalculated effects → {}
18:46:35 [INFO] gameserver.engine.empire_service: Empire registered: uid=2 name='Empire1'
18:46:35 [INFO] gameserver.engine.empire_service: Empire 2: recalculated effects → {'life_offset': 0.001, 'gold_offset': 0.2, 'culture_offset': 0.15000000000000002, 'culture_modifier': 0.1, 'gold_modifier': 0.1, 'build_speed_modifier': 0.1}
18:46:35 [INFO] __main__: Restored 2 empires from saved state
18:46:35 [INFO] __main__: Starting network server …
18:46:35 [INFO] gameserver.network.handlers: Registered 31 message handlers: summary_request, item_request, military_request, map_load_request, map_save_request, new_item, new_structure, delete_structure, upgrade_structure, citizen_upgrade, change_citizen, increase_life, new_army, new_attack_request, change_army, new_wave, change_wave, end_siege, battle_register, battle_unregister, battle_next_wave_request, notification_request, user_message, timeline_request, userinfo_request, hall_of_fame_request, preferences_request, change_preferences, auth_request, signup, create_empire
18:46:35 [INFO] websockets.server: server listening on 0.0.0.0:8765
18:46:35 [INFO] gameserver.network.server: WebSocket server listening on ws://0.0.0.0:8765
18:46:35 [INFO] __main__:   WebSocket server listening on 0.0.0.0:8765
18:46:35 [INFO] gameserver.debug.dashboard: Debug dashboard running at http://0.0.0.0:9000/
18:46:35 [INFO] __main__: Starting game loop …
18:46:35 [INFO] __main__:   game loop running (1 s tick)
18:46:36 [INFO] websockets.server: connection open
18:46:36 [INFO] gameserver.network.server: Session registered: uid=-1
18:46:36 [INFO] gameserver.network.server: Client connected: uid=-1 remote=('192.168.178.2', 54399)
18:46:36 [INFO] gameserver.network.auth: Login success: eem (uid=2)
18:46:36 [INFO] gameserver.network.server: Session registered: uid=2
18:46:36 [INFO] gameserver.network.server: Session upgraded: guest=-1 → uid=2
18:46:36 [INFO] gameserver.network.server: Session removed: uid=2
18:46:36 [INFO] websockets.server: connection open
18:46:36 [INFO] gameserver.network.server: Session registered: uid=-2
18:46:36 [INFO] gameserver.network.server: Client connected: uid=-2 remote=('192.168.178.2', 54402)
18:46:36 [INFO] gameserver.network.auth: Login success: eem (uid=2)
18:46:36 [INFO] gameserver.network.server: Session registered: uid=2
18:46:36 [INFO] gameserver.network.server: Session upgraded: guest=-2 → uid=2
18:46:37 [INFO] gameserver.network.server: Session removed: uid=2
18:46:37 [ERROR] websockets.server: opening handshake failed
Traceback (most recent call last):
  File "/home/pi/e3/.venv/lib/python3.9/site-packages/websockets/http11.py", line 138, in parse
    request_line = yield from parse_line(read_line)
  File "/home/pi/e3/.venv/lib/python3.9/site-packages/websockets/http11.py", line 309, in parse_line
    line = yield from read_line(MAX_LINE_LENGTH)
  File "/home/pi/e3/.venv/lib/python3.9/site-packages/websockets/streams.py", line 46, in read_line
    raise EOFError(f"stream ends after {p} bytes, before end of line")
EOFError: stream ends after 0 bytes, before end of line

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/pi/e3/.venv/lib/python3.9/site-packages/websockets/server.py", line 545, in parse
    request = yield from Request.parse(
  File "/home/pi/e3/.venv/lib/python3.9/site-packages/websockets/http11.py", line 140, in parse
    raise EOFError("connection closed while reading HTTP request line") from exc
EOFError: connection closed while reading HTTP request line

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/pi/e3/.venv/lib/python3.9/site-packages/websockets/asyncio/server.py", line 356, in conn_handler
    await connection.handshake(
  File "/home/pi/e3/.venv/lib/python3.9/site-packages/websockets/asyncio/server.py", line 207, in handshake
    raise self.protocol.handshake_exc
websockets.exceptions.InvalidMessage: did not receive a valid HTTP request
18:46:37 [INFO] websockets.server: connection open
18:46:37 [INFO] gameserver.network.server: Session registered: uid=-3
18:46:37 [INFO] gameserver.network.server: Client connected: uid=-3 remote=('192.168.178.2', 54425)
18:46:37 [INFO] gameserver.network.auth: Login success: eem (uid=2)
18:46:37 [INFO] gameserver.network.server: Session registered: uid=2
18:46:37 [INFO] gameserver.network.server: Session upgraded: guest=-3 → uid=2
18:46:38 [INFO] gameserver.network.server: Session removed: uid=2
18:46:38 [INFO] websockets.server: connection open
18:46:38 [INFO] gameserver.network.server: Session registered: uid=-4
18:46:38 [INFO] gameserver.network.server: Client connected: uid=-4 remote=('192.168.178.2', 54449)
18:46:38 [INFO] gameserver.network.auth: Login success: eem (uid=2)
18:46:38 [INFO] gameserver.network.server: Session registered: uid=2
18:46:38 [INFO] gameserver.network.server: Session upgraded: guest=-4 → uid=2
18:46:38 [INFO] gameserver.network.server: Session removed: uid=2
18:46:38 [INFO] websockets.server: connection open
18:46:38 [INFO] gameserver.network.server: Session registered: uid=-5
18:46:38 [INFO] gameserver.network.server: Client connected: uid=-5 remote=('192.168.178.2', 54472)
18:46:38 [INFO] gameserver.network.auth: Login success: eem (uid=2)
18:46:38 [INFO] gameserver.network.server: Session registered: uid=2
18:46:38 [INFO] gameserver.network.server: Session upgraded: guest=-5 → uid=2
18:46:38 [INFO] gameserver.network.server: Session removed: uid=2
18:46:38 [INFO] websockets.server: connection open
18:46:38 [INFO] gameserver.network.server: Session registered: uid=-6
18:46:38 [INFO] gameserver.network.server: Client connected: uid=-6 remote=('192.168.178.2', 54495)
18:46:38 [INFO] gameserver.network.auth: Login success: eem (uid=2)
18:46:38 [INFO] gameserver.network.server: Session registered: uid=2
18:46:38 [INFO] gameserver.network.server: Session upgraded: guest=-6 → uid=2
18:46:49 [INFO] gameserver.network.auth: Login success: eem (uid=2)
18:46:49 [INFO] gameserver.network.server: Session registered: uid=2
18:46:49 [INFO] gameserver.network.server: Session upgraded: guest=2 → uid=2
18:47:26 [INFO] gameserver.engine.empire_service: Empire 2: knowledge HERBOLOGY completed
18:47:45 [INFO] __main__: Shutdown signal received — stopping …
18:47:45 [INFO] __main__: Shutting down …
18:47:45 [INFO] gameserver.persistence.state_save: Game state saved to state.yaml (2 empires, 0 attacks, 0 battles)
18:47:45 [INFO] websockets.server: server closing
18:47:45 [INFO] gameserver.network.server: Session removed: uid=2
18:47:45 [INFO] websockets.server: server closed
18:47:45 [INFO] gameserver.network.server: WebSocket server stopped
18:47:45 [INFO] __main__:   WebSocket server stopped
18:47:45 [INFO] __main__:   debug dashboard stopped
18:47:45 [INFO] __main__:   database closed
18:47:45 [INFO] __main__:   goodbye
18:47:47 [INFO] __main__: === Game Server starting ===
18:47:47 [INFO] __main__: Loading configuration …
18:47:48 [INFO] __main__:   items:        210 loaded from config
18:47:48 [INFO] __main__:   map:          4 paths, 23 build tiles from config/maps/default.yaml
18:47:48 [INFO] __main__:   ai_templates: 2 entries from config/ai_templates.yaml
18:47:48 [INFO] gameserver.loaders.game_config_loader: Loaded game config from config/game.yaml (29 keys)
18:47:48 [INFO] __main__:   game_config:  loaded
18:47:48 [INFO] __main__: Initializing persistence …
18:47:48 [INFO] gameserver.persistence.database: Database connected: gameserver.db
18:47:48 [INFO] __main__:   database:     connected (gameserver.db)
18:47:48 [INFO] gameserver.persistence.state_load: Restoring state from state.yaml (saved at 2026-02-08T18:47:45, version 1)
18:47:48 [INFO] gameserver.persistence.state_load: Restored 2 empires, 0 attacks, 0 battles
18:47:48 [INFO] __main__:   state:        restored from disk (2 empires, 0 attacks)
18:47:48 [INFO] __main__: Creating services …
18:47:48 [INFO] __main__:   upgrade_provider: 210 items registered
18:47:48 [INFO] __main__:   all services created
18:47:48 [INFO] __main__: Wiring event handlers …
18:47:48 [INFO] __main__:   event handlers registered
18:47:48 [INFO] gameserver.engine.empire_service: Empire registered: uid=100 name='TestImperium'
18:47:48 [INFO] gameserver.engine.empire_service: Empire 100: recalculated effects → {}
18:47:48 [INFO] gameserver.engine.empire_service: Empire registered: uid=2 name='Empire1'
18:47:48 [INFO] gameserver.engine.empire_service: Empire 2: recalculated effects → {'life_offset': 0.001, 'gold_offset': 0.2, 'culture_offset': 0.15000000000000002, 'culture_modifier': 0.1, 'gold_modifier': 0.1, 'build_speed_modifier': 0.1}
18:47:48 [INFO] __main__: Restored 2 empires from saved state
18:47:48 [INFO] __main__: Starting network server …
18:47:48 [INFO] gameserver.network.handlers: Registered 31 message handlers: summary_request, item_request, military_request, map_load_request, map_save_request, new_item, new_structure, delete_structure, upgrade_structure, citizen_upgrade, change_citizen, increase_life, new_army, new_attack_request, change_army, new_wave, change_wave, end_siege, battle_register, battle_unregister, battle_next_wave_request, notification_request, user_message, timeline_request, userinfo_request, hall_of_fame_request, preferences_request, change_preferences, auth_request, signup, create_empire
18:47:48 [INFO] websockets.server: server listening on 0.0.0.0:8765
18:47:48 [INFO] gameserver.network.server: WebSocket server listening on ws://0.0.0.0:8765
18:47:48 [INFO] __main__:   WebSocket server listening on 0.0.0.0:8765
18:47:48 [INFO] gameserver.debug.dashboard: Debug dashboard running at http://0.0.0.0:9000/
18:47:48 [INFO] __main__: Starting game loop …
18:47:48 [INFO] __main__:   game loop running (1 s tick)
18:47:48 [INFO] websockets.server: connection open
18:47:48 [INFO] gameserver.network.server: Session registered: uid=-1
18:47:48 [INFO] gameserver.network.server: Client connected: uid=-1 remote=('192.168.178.2', 55140)
18:47:48 [INFO] gameserver.network.auth: Login success: eem (uid=2)
18:47:48 [INFO] gameserver.network.server: Session registered: uid=2
18:47:48 [INFO] gameserver.network.server: Session upgraded: guest=-1 → uid=2
18:47:55 [INFO] gameserver.network.server: Session removed: uid=2
18:47:55 [INFO] websockets.server: connection open
18:47:55 [INFO] gameserver.network.server: Session registered: uid=-2
18:47:55 [INFO] gameserver.network.server: Client connected: uid=-2 remote=('192.168.178.2', 60394)
18:47:55 [INFO] gameserver.network.auth: Login success: eem (uid=2)
18:47:55 [INFO] gameserver.network.server: Session registered: uid=2
18:47:55 [INFO] gameserver.network.server: Session upgraded: guest=-2 → uid=2
18:47:57 [INFO] gameserver.network.server: Session removed: uid=2
18:47:57 [INFO] websockets.server: connection open
18:47:57 [INFO] gameserver.network.server: Session registered: uid=-3
18:47:57 [INFO] gameserver.network.server: Client connected: uid=-3 remote=('192.168.178.2', 60418)
18:47:57 [INFO] gameserver.network.auth: Login success: eem (uid=2)
18:47:57 [INFO] gameserver.network.server: Session registered: uid=2
18:47:57 [INFO] gameserver.network.server: Session upgraded: guest=-3 → uid=2
18:48:05 [INFO] __main__: Shutdown signal received — stopping …
18:48:06 [INFO] __main__: Shutting down …
18:48:06 [INFO] gameserver.persistence.state_save: Game state saved to state.yaml (2 empires, 0 attacks, 0 battles)
18:48:06 [INFO] websockets.server: server closing
18:48:06 [INFO] gameserver.network.server: Session removed: uid=2
18:48:06 [INFO] websockets.server: server closed
18:48:06 [INFO] gameserver.network.server: WebSocket server stopped
18:48:06 [INFO] __main__:   WebSocket server stopped
18:48:06 [INFO] __main__:   debug dashboard stopped
18:48:06 [INFO] __main__:   database closed
18:48:06 [INFO] __main__:   goodbye
18:48:21 [INFO] __main__: === Game Server starting ===
18:48:21 [INFO] __main__: Loading configuration …
18:48:22 [INFO] __main__:   items:        210 loaded from config
18:48:22 [INFO] __main__:   map:          4 paths, 23 build tiles from config/maps/default.yaml
18:48:22 [INFO] __main__:   ai_templates: 2 entries from config/ai_templates.yaml
18:48:22 [INFO] gameserver.loaders.game_config_loader: Loaded game config from config/game.yaml (29 keys)
18:48:22 [INFO] __main__:   game_config:  loaded
18:48:22 [INFO] __main__: Initializing persistence …
18:48:22 [INFO] gameserver.persistence.database: Database connected: gameserver.db
18:48:22 [INFO] __main__:   database:     connected (gameserver.db)
18:48:22 [INFO] gameserver.persistence.state_load: Restoring state from state.yaml (saved at 2026-02-08T18:46:33, version 1)
18:48:22 [INFO] gameserver.persistence.state_load: Restored 2 empires, 0 attacks, 0 battles
18:48:22 [INFO] __main__:   state:        restored from disk (2 empires, 0 attacks)
18:48:22 [INFO] __main__: Creating services …
18:48:22 [INFO] __main__:   upgrade_provider: 210 items registered
18:48:22 [INFO] __main__:   all services created
18:48:22 [INFO] __main__: Wiring event handlers …
18:48:22 [INFO] __main__:   event handlers registered
18:48:22 [INFO] gameserver.engine.empire_service: Empire registered: uid=100 name='TestImperium'
18:48:22 [INFO] gameserver.engine.empire_service: Empire 100: recalculated effects → {}
18:48:22 [INFO] gameserver.engine.empire_service: Empire registered: uid=2 name='Empire1'
18:48:22 [INFO] gameserver.engine.empire_service: Empire 2: recalculated effects → {'life_offset': 0.001, 'gold_offset': 0.2, 'culture_offset': 0.15000000000000002, 'culture_modifier': 0.1, 'gold_modifier': 0.1, 'build_speed_modifier': 0.1}
18:48:22 [INFO] __main__: Restored 2 empires from saved state
18:48:22 [INFO] __main__: Starting network server …
18:48:22 [INFO] gameserver.network.handlers: Registered 31 message handlers: summary_request, item_request, military_request, map_load_request, map_save_request, new_item, new_structure, delete_structure, upgrade_structure, citizen_upgrade, change_citizen, increase_life, new_army, new_attack_request, change_army, new_wave, change_wave, end_siege, battle_register, battle_unregister, battle_next_wave_request, notification_request, user_message, timeline_request, userinfo_request, hall_of_fame_request, preferences_request, change_preferences, auth_request, signup, create_empire
18:48:22 [INFO] websockets.server: server listening on 0.0.0.0:8765
18:48:22 [INFO] gameserver.network.server: WebSocket server listening on ws://0.0.0.0:8765
18:48:22 [INFO] __main__:   WebSocket server listening on 0.0.0.0:8765
18:48:22 [INFO] gameserver.debug.dashboard: Debug dashboard running at http://0.0.0.0:9000/
18:48:22 [INFO] __main__: Starting game loop …
18:48:22 [INFO] __main__:   game loop running (1 s tick)
18:48:24 [INFO] websockets.server: connection open
18:48:24 [INFO] gameserver.network.server: Session registered: uid=-1
18:48:24 [INFO] gameserver.network.server: Client connected: uid=-1 remote=('192.168.178.2', 60443)
18:48:24 [INFO] gameserver.network.auth: Login success: eem (uid=2)
18:48:24 [INFO] gameserver.network.server: Session registered: uid=2
18:48:24 [INFO] gameserver.network.server: Session upgraded: guest=-1 → uid=2
18:48:24 [INFO] gameserver.network.server: Session removed: uid=2
18:48:24 [INFO] websockets.server: connection open
18:48:24 [INFO] gameserver.network.server: Session registered: uid=-2
18:48:24 [INFO] gameserver.network.server: Client connected: uid=-2 remote=('192.168.178.2', 60447)
18:48:24 [INFO] gameserver.network.auth: Login success: eem (uid=2)
18:48:24 [INFO] gameserver.network.server: Session registered: uid=2
18:48:24 [INFO] gameserver.network.server: Session upgraded: guest=-2 → uid=2
18:48:25 [INFO] gameserver.network.server: Session removed: uid=2
18:48:26 [INFO] websockets.server: connection open
18:48:26 [INFO] gameserver.network.server: Session registered: uid=-3
18:48:26 [INFO] gameserver.network.server: Client connected: uid=-3 remote=('192.168.178.2', 60472)
18:48:26 [INFO] gameserver.network.auth: Login success: eem (uid=2)
18:48:26 [INFO] gameserver.network.server: Session registered: uid=2
18:48:26 [INFO] gameserver.network.server: Session upgraded: guest=-3 → uid=2
18:49:13 [INFO] gameserver.engine.empire_service: Empire 2: knowledge HERBOLOGY completed
18:54:49 [INFO] gameserver.network.server: Session removed: uid=2
18:54:49 [INFO] websockets.server: connection open
18:54:49 [INFO] gameserver.network.server: Session registered: uid=-4
18:54:49 [INFO] gameserver.network.server: Client connected: uid=-4 remote=('192.168.178.2', 64371)
18:54:49 [INFO] gameserver.network.auth: Login success: eem (uid=2)
18:54:49 [INFO] gameserver.network.server: Session registered: uid=2
18:54:49 [INFO] gameserver.network.server: Session upgraded: guest=-4 → uid=2
18:54:52 [INFO] gameserver.network.server: Session removed: uid=2
18:54:52 [INFO] websockets.server: connection open
18:54:52 [INFO] gameserver.network.server: Session registered: uid=-5
18:54:52 [INFO] gameserver.network.server: Client connected: uid=-5 remote=('192.168.178.2', 64394)
18:54:52 [INFO] gameserver.network.auth: Login success: eem (uid=2)
18:54:52 [INFO] gameserver.network.server: Session registered: uid=2
18:54:52 [INFO] gameserver.network.server: Session upgraded: guest=-5 → uid=2
18:55:35 [INFO] gameserver.network.server: Session removed: uid=2
18:55:35 [INFO] websockets.server: connection open
18:55:35 [INFO] gameserver.network.server: Session registered: uid=-6
18:55:35 [INFO] gameserver.network.server: Client connected: uid=-6 remote=('192.168.178.2', 52752)
18:55:35 [INFO] gameserver.network.auth: Login success: eem (uid=2)
18:55:35 [INFO] gameserver.network.server: Session registered: uid=2
18:55:35 [INFO] gameserver.network.server: Session upgraded: guest=-6 → uid=2
18:55:39 [INFO] __main__: Shutdown signal received — stopping …
18:55:40 [INFO] __main__: Shutting down …
18:55:40 [INFO] gameserver.persistence.state_save: Game state saved to state.yaml (2 empires, 0 attacks, 0 battles)
18:55:40 [INFO] websockets.server: server closing
18:55:40 [INFO] gameserver.network.server: Session removed: uid=2
18:55:40 [INFO] websockets.server: server closed
18:55:40 [INFO] gameserver.network.server: WebSocket server stopped
18:55:40 [INFO] __main__:   WebSocket server stopped
18:55:40 [INFO] __main__:   debug dashboard stopped
18:55:40 [INFO] __main__:   database closed
18:55:40 [INFO] __main__:   goodbye
18:55:42 [INFO] __main__: === Game Server starting ===
18:55:42 [INFO] __main__: Loading configuration …
18:55:43 [INFO] __main__:   items:        210 loaded from config
18:55:43 [INFO] __main__:   map:          4 paths, 23 build tiles from config/maps/default.yaml
18:55:43 [INFO] __main__:   ai_templates: 2 entries from config/ai_templates.yaml
18:55:43 [INFO] gameserver.loaders.game_config_loader: Loaded game config from config/game.yaml (29 keys)
18:55:43 [INFO] __main__:   game_config:  loaded
18:55:43 [INFO] __main__: Initializing persistence …
18:55:43 [INFO] gameserver.persistence.database: Database connected: gameserver.db
18:55:43 [INFO] __main__:   database:     connected (gameserver.db)
18:55:43 [INFO] gameserver.persistence.state_load: Restoring state from state.yaml (saved at 2026-02-08T18:55:40, version 1)
18:55:43 [INFO] gameserver.persistence.state_load: Restored 2 empires, 0 attacks, 0 battles
18:55:43 [INFO] __main__:   state:        restored from disk (2 empires, 0 attacks)
18:55:43 [INFO] __main__: Creating services …
18:55:43 [INFO] __main__:   upgrade_provider: 210 items registered
18:55:43 [INFO] __main__:   all services created
18:55:43 [INFO] __main__: Wiring event handlers …
18:55:43 [INFO] __main__:   event handlers registered
18:55:43 [INFO] gameserver.engine.empire_service: Empire registered: uid=100 name='TestImperium'
18:55:43 [INFO] gameserver.engine.empire_service: Empire 100: recalculated effects → {}
18:55:43 [INFO] gameserver.engine.empire_service: Empire registered: uid=2 name='Empire1'
18:55:43 [INFO] gameserver.engine.empire_service: Empire 2: recalculated effects → {'life_offset': 0.001, 'gold_offset': 0.2, 'culture_offset': 0.15000000000000002, 'culture_modifier': 0.1, 'gold_modifier': 0.1, 'build_speed_modifier': 0.1}
18:55:43 [INFO] __main__: Restored 2 empires from saved state
18:55:43 [INFO] __main__: Starting network server …
18:55:43 [INFO] gameserver.network.handlers: Registered 31 message handlers: summary_request, item_request, military_request, map_load_request, map_save_request, new_item, new_structure, delete_structure, upgrade_structure, citizen_upgrade, change_citizen, increase_life, new_army, new_attack_request, change_army, new_wave, change_wave, end_siege, battle_register, battle_unregister, battle_next_wave_request, notification_request, user_message, timeline_request, userinfo_request, hall_of_fame_request, preferences_request, change_preferences, auth_request, signup, create_empire
18:55:43 [INFO] websockets.server: server listening on 0.0.0.0:8765
18:55:43 [INFO] gameserver.network.server: WebSocket server listening on ws://0.0.0.0:8765
18:55:43 [INFO] __main__:   WebSocket server listening on 0.0.0.0:8765
18:55:43 [INFO] gameserver.debug.dashboard: Debug dashboard running at http://0.0.0.0:9000/
18:55:43 [INFO] __main__: Starting game loop …
18:55:43 [INFO] __main__:   game loop running (1 s tick)
18:55:43 [INFO] websockets.server: connection open
18:55:43 [INFO] gameserver.network.server: Session registered: uid=-1
18:55:43 [INFO] gameserver.network.server: Client connected: uid=-1 remote=('192.168.178.2', 49155)
18:55:43 [INFO] gameserver.network.auth: Login success: eem (uid=2)
18:55:43 [INFO] gameserver.network.server: Session registered: uid=2
18:55:43 [INFO] gameserver.network.server: Session upgraded: guest=-1 → uid=2
18:55:51 [INFO] __main__: Shutdown signal received — stopping …
18:55:51 [INFO] __main__: Shutting down …
18:55:51 [INFO] gameserver.persistence.state_save: Game state saved to state.yaml (2 empires, 0 attacks, 0 battles)
18:55:51 [INFO] websockets.server: server closing
18:55:51 [INFO] gameserver.network.server: Session removed: uid=2
18:55:51 [INFO] websockets.server: server closed
18:55:51 [INFO] gameserver.network.server: WebSocket server stopped
18:55:51 [INFO] __main__:   WebSocket server stopped
18:55:51 [INFO] __main__:   debug dashboard stopped
18:55:51 [INFO] __main__:   database closed
18:55:51 [INFO] __main__:   goodbye
18:55:53 [INFO] __main__: === Game Server starting ===
18:55:53 [INFO] __main__: Loading configuration …
18:55:54 [INFO] __main__:   items:        210 loaded from config
18:55:54 [INFO] __main__:   map:          4 paths, 23 build tiles from config/maps/default.yaml
18:55:54 [INFO] __main__:   ai_templates: 2 entries from config/ai_templates.yaml
18:55:54 [INFO] gameserver.loaders.game_config_loader: Loaded game config from config/game.yaml (29 keys)
18:55:54 [INFO] __main__:   game_config:  loaded
18:55:54 [INFO] __main__: Initializing persistence …
18:55:54 [INFO] gameserver.persistence.database: Database connected: gameserver.db
18:55:54 [INFO] __main__:   database:     connected (gameserver.db)
18:55:54 [INFO] gameserver.persistence.state_load: Restoring state from state.yaml (saved at 2026-02-08T18:55:51, version 1)
18:55:54 [INFO] gameserver.persistence.state_load: Restored 2 empires, 0 attacks, 0 battles
18:55:54 [INFO] __main__:   state:        restored from disk (2 empires, 0 attacks)
18:55:54 [INFO] __main__: Creating services …
18:55:54 [INFO] __main__:   upgrade_provider: 210 items registered
18:55:54 [INFO] __main__:   all services created
18:55:54 [INFO] __main__: Wiring event handlers …
18:55:54 [INFO] __main__:   event handlers registered
18:55:54 [INFO] gameserver.engine.empire_service: Empire registered: uid=100 name='TestImperium'
18:55:54 [INFO] gameserver.engine.empire_service: Empire 100: recalculated effects → {}
18:55:54 [INFO] gameserver.engine.empire_service: Empire registered: uid=2 name='Empire1'
18:55:54 [INFO] gameserver.engine.empire_service: Empire 2: recalculated effects → {'life_offset': 0.001, 'gold_offset': 0.2, 'culture_offset': 0.15000000000000002, 'culture_modifier': 0.1, 'gold_modifier': 0.1, 'build_speed_modifier': 0.1}
18:55:54 [INFO] __main__: Restored 2 empires from saved state
18:55:54 [INFO] __main__: Starting network server …
18:55:54 [INFO] gameserver.network.handlers: Registered 31 message handlers: summary_request, item_request, military_request, map_load_request, map_save_request, new_item, new_structure, delete_structure, upgrade_structure, citizen_upgrade, change_citizen, increase_life, new_army, new_attack_request, change_army, new_wave, change_wave, end_siege, battle_register, battle_unregister, battle_next_wave_request, notification_request, user_message, timeline_request, userinfo_request, hall_of_fame_request, preferences_request, change_preferences, auth_request, signup, create_empire
18:55:54 [INFO] websockets.server: server listening on 0.0.0.0:8765
18:55:54 [INFO] gameserver.network.server: WebSocket server listening on ws://0.0.0.0:8765
18:55:54 [INFO] __main__:   WebSocket server listening on 0.0.0.0:8765
18:55:54 [INFO] gameserver.debug.dashboard: Debug dashboard running at http://0.0.0.0:9000/
18:55:54 [INFO] __main__: Starting game loop …
18:55:54 [INFO] __main__:   game loop running (1 s tick)
18:55:54 [INFO] websockets.server: connection open
18:55:54 [INFO] gameserver.network.server: Session registered: uid=-1
18:55:54 [INFO] gameserver.network.server: Client connected: uid=-1 remote=('192.168.178.2', 49159)
18:55:54 [INFO] gameserver.network.auth: Login success: eem (uid=2)
18:55:54 [INFO] gameserver.network.server: Session registered: uid=2
18:55:54 [INFO] gameserver.network.server: Session upgraded: guest=-1 → uid=2
18:55:57 [INFO] gameserver.network.server: Session removed: uid=2
18:55:57 [INFO] websockets.server: connection open
18:55:57 [INFO] gameserver.network.server: Session registered: uid=-2
18:55:57 [INFO] gameserver.network.server: Client connected: uid=-2 remote=('192.168.178.2', 49164)
18:55:57 [INFO] gameserver.network.auth: Login success: eem (uid=2)
18:55:57 [INFO] gameserver.network.server: Session registered: uid=2
18:55:57 [INFO] gameserver.network.server: Session upgraded: guest=-2 → uid=2
18:57:52 [INFO] gameserver.network.server: Session removed: uid=2
18:57:52 [INFO] websockets.server: connection open
18:57:52 [INFO] gameserver.network.server: Session registered: uid=-3
18:57:52 [INFO] gameserver.network.server: Client connected: uid=-3 remote=('192.168.178.2', 56156)
18:57:52 [INFO] gameserver.network.auth: Login success: eem (uid=2)
18:57:52 [INFO] gameserver.network.server: Session registered: uid=2
18:57:52 [INFO] gameserver.network.server: Session upgraded: guest=-3 → uid=2
18:57:54 [INFO] gameserver.network.server: Session removed: uid=2
18:57:54 [INFO] websockets.server: connection open
18:57:54 [INFO] gameserver.network.server: Session registered: uid=-4
18:57:54 [INFO] gameserver.network.server: Client connected: uid=-4 remote=('192.168.178.2', 60752)
18:57:54 [INFO] gameserver.network.auth: Login success: eem (uid=2)
18:57:54 [INFO] gameserver.network.server: Session registered: uid=2
18:57:54 [INFO] gameserver.network.server: Session upgraded: guest=-4 → uid=2
18:57:55 [INFO] gameserver.network.server: Session removed: uid=2
18:57:55 [INFO] websockets.server: connection open
18:57:55 [INFO] gameserver.network.server: Session registered: uid=-5
18:57:55 [INFO] gameserver.network.server: Client connected: uid=-5 remote=('192.168.178.2', 60756)
18:57:55 [INFO] gameserver.network.auth: Login success: eem (uid=2)
18:57:55 [INFO] gameserver.network.server: Session registered: uid=2
18:57:55 [INFO] gameserver.network.server: Session upgraded: guest=-5 → uid=2
18:57:55 [INFO] gameserver.network.server: Session removed: uid=2
18:57:55 [INFO] websockets.server: connection open
18:57:55 [INFO] gameserver.network.server: Session registered: uid=-6
18:57:55 [INFO] gameserver.network.server: Client connected: uid=-6 remote=('192.168.178.2', 63885)
18:57:55 [INFO] gameserver.network.auth: Login success: eem (uid=2)
18:57:55 [INFO] gameserver.network.server: Session registered: uid=2
18:57:55 [INFO] gameserver.network.server: Session upgraded: guest=-6 → uid=2
18:58:57 [INFO] gameserver.network.server: Session removed: uid=2
18:58:57 [INFO] websockets.server: connection open
18:58:57 [INFO] gameserver.network.server: Session registered: uid=-7
18:58:57 [INFO] gameserver.network.server: Client connected: uid=-7 remote=('192.168.178.2', 61432)
18:58:57 [INFO] gameserver.network.auth: Login success: eem (uid=2)
18:58:57 [INFO] gameserver.network.server: Session registered: uid=2
18:58:57 [INFO] gameserver.network.server: Session upgraded: guest=-7 → uid=2
18:59:24 [INFO] gameserver.network.server: Session removed: uid=2
18:59:24 [INFO] websockets.server: connection open
18:59:24 [INFO] gameserver.network.server: Session registered: uid=-8
18:59:24 [INFO] gameserver.network.server: Client connected: uid=-8 remote=('192.168.178.2', 60883)
18:59:24 [INFO] gameserver.network.auth: Login success: eem (uid=2)
18:59:24 [INFO] gameserver.network.server: Session registered: uid=2
18:59:24 [INFO] gameserver.network.server: Session upgraded: guest=-8 → uid=2
18:59:28 [INFO] gameserver.network.handlers: Map saved for empire Empire1 (uid=2): 0 tiles
18:59:30 [INFO] gameserver.network.handlers: Map saved for empire Empire1 (uid=2): 0 tiles
18:59:31 [INFO] gameserver.network.handlers: Map saved for empire Empire1 (uid=2): 0 tiles
18:59:36 [INFO] __main__: Shutdown signal received — stopping …
18:59:36 [INFO] __main__: Shutting down …
18:59:36 [INFO] gameserver.persistence.state_save: Game state saved to state.yaml (2 empires, 0 attacks, 0 battles)
18:59:36 [INFO] websockets.server: server closing
18:59:36 [INFO] gameserver.network.server: Session removed: uid=2
18:59:36 [INFO] websockets.server: server closed
18:59:36 [INFO] gameserver.network.server: WebSocket server stopped
18:59:36 [INFO] __main__:   WebSocket server stopped
18:59:36 [INFO] __main__:   debug dashboard stopped
18:59:36 [INFO] __main__:   database closed
18:59:36 [INFO] __main__:   goodbye
18:59:38 [INFO] __main__: === Game Server starting ===
18:59:38 [INFO] __main__: Loading configuration …
18:59:38 [INFO] __main__:   items:        210 loaded from config
18:59:38 [INFO] __main__:   map:          4 paths, 23 build tiles from config/maps/default.yaml
18:59:38 [INFO] __main__:   ai_templates: 2 entries from config/ai_templates.yaml
18:59:38 [INFO] gameserver.loaders.game_config_loader: Loaded game config from config/game.yaml (29 keys)
18:59:38 [INFO] __main__:   game_config:  loaded
18:59:38 [INFO] __main__: Initializing persistence …
18:59:38 [INFO] gameserver.persistence.database: Database connected: gameserver.db
18:59:38 [INFO] __main__:   database:     connected (gameserver.db)
18:59:39 [INFO] gameserver.persistence.state_load: Restoring state from state.yaml (saved at 2026-02-08T18:59:36, version 1)
18:59:39 [INFO] gameserver.persistence.state_load: Restored 2 empires, 0 attacks, 0 battles
18:59:39 [INFO] __main__:   state:        restored from disk (2 empires, 0 attacks)
18:59:39 [INFO] __main__: Creating services …
18:59:39 [INFO] __main__:   upgrade_provider: 210 items registered
18:59:39 [INFO] __main__:   all services created
18:59:39 [INFO] __main__: Wiring event handlers …
18:59:39 [INFO] __main__:   event handlers registered
18:59:39 [INFO] gameserver.engine.empire_service: Empire registered: uid=100 name='TestImperium'
18:59:39 [INFO] gameserver.engine.empire_service: Empire 100: recalculated effects → {}
18:59:39 [INFO] gameserver.engine.empire_service: Empire registered: uid=2 name='Empire1'
18:59:39 [INFO] gameserver.engine.empire_service: Empire 2: recalculated effects → {'life_offset': 0.001, 'gold_offset': 0.2, 'culture_offset': 0.15000000000000002, 'culture_modifier': 0.1, 'gold_modifier': 0.1, 'build_speed_modifier': 0.1}
18:59:39 [INFO] __main__: Restored 2 empires from saved state
18:59:39 [INFO] __main__: Starting network server …
18:59:39 [INFO] gameserver.network.handlers: Registered 31 message handlers: summary_request, item_request, military_request, map_load_request, map_save_request, new_item, new_structure, delete_structure, upgrade_structure, citizen_upgrade, change_citizen, increase_life, new_army, new_attack_request, change_army, new_wave, change_wave, end_siege, battle_register, battle_unregister, battle_next_wave_request, notification_request, user_message, timeline_request, userinfo_request, hall_of_fame_request, preferences_request, change_preferences, auth_request, signup, create_empire
18:59:39 [INFO] websockets.server: server listening on 0.0.0.0:8765
18:59:39 [INFO] gameserver.network.server: WebSocket server listening on ws://0.0.0.0:8765
18:59:39 [INFO] __main__:   WebSocket server listening on 0.0.0.0:8765
18:59:39 [INFO] gameserver.debug.dashboard: Debug dashboard running at http://0.0.0.0:9000/
18:59:39 [INFO] __main__: Starting game loop …
18:59:39 [INFO] __main__:   game loop running (1 s tick)
18:59:39 [INFO] websockets.server: connection open
18:59:39 [INFO] gameserver.network.server: Session registered: uid=-1
18:59:39 [INFO] gameserver.network.server: Client connected: uid=-1 remote=('192.168.178.2', 60890)
18:59:39 [INFO] gameserver.network.auth: Login success: eem (uid=2)
18:59:39 [INFO] gameserver.network.server: Session registered: uid=2
18:59:39 [INFO] gameserver.network.server: Session upgraded: guest=-1 → uid=2
18:59:50 [INFO] __main__: Shutdown signal received — stopping …
18:59:51 [INFO] __main__: Shutting down …
18:59:51 [INFO] gameserver.persistence.state_save: Game state saved to state.yaml (2 empires, 0 attacks, 0 battles)
18:59:51 [INFO] websockets.server: server closing
18:59:51 [INFO] gameserver.network.server: Session removed: uid=2
18:59:51 [INFO] websockets.server: server closed
18:59:51 [INFO] gameserver.network.server: WebSocket server stopped
18:59:51 [INFO] __main__:   WebSocket server stopped
18:59:51 [INFO] __main__:   debug dashboard stopped
18:59:51 [INFO] __main__:   database closed
18:59:51 [INFO] __main__:   goodbye
18:59:53 [INFO] __main__: === Game Server starting ===
18:59:53 [INFO] __main__: Loading configuration …
18:59:53 [INFO] __main__:   items:        210 loaded from config
18:59:53 [INFO] __main__:   map:          4 paths, 23 build tiles from config/maps/default.yaml
18:59:53 [INFO] __main__:   ai_templates: 2 entries from config/ai_templates.yaml
18:59:53 [INFO] gameserver.loaders.game_config_loader: Loaded game config from config/game.yaml (29 keys)
18:59:53 [INFO] __main__:   game_config:  loaded
18:59:53 [INFO] __main__: Initializing persistence …
18:59:53 [INFO] gameserver.persistence.database: Database connected: gameserver.db
18:59:53 [INFO] __main__:   database:     connected (gameserver.db)
18:59:53 [INFO] gameserver.persistence.state_load: Restoring state from state.yaml (saved at 2026-02-08T18:59:51, version 1)
18:59:53 [INFO] gameserver.persistence.state_load: Restored 2 empires, 0 attacks, 0 battles
18:59:53 [INFO] __main__:   state:        restored from disk (2 empires, 0 attacks)
18:59:53 [INFO] __main__: Creating services …
18:59:53 [INFO] __main__:   upgrade_provider: 210 items registered
18:59:53 [INFO] __main__:   all services created
18:59:53 [INFO] __main__: Wiring event handlers …
18:59:53 [INFO] __main__:   event handlers registered
18:59:53 [INFO] gameserver.engine.empire_service: Empire registered: uid=100 name='TestImperium'
18:59:53 [INFO] gameserver.engine.empire_service: Empire 100: recalculated effects → {}
18:59:53 [INFO] gameserver.engine.empire_service: Empire registered: uid=2 name='Empire1'
18:59:53 [INFO] gameserver.engine.empire_service: Empire 2: recalculated effects → {'life_offset': 0.001, 'gold_offset': 0.2, 'culture_offset': 0.15000000000000002, 'culture_modifier': 0.1, 'gold_modifier': 0.1, 'build_speed_modifier': 0.1}
18:59:53 [INFO] __main__: Restored 2 empires from saved state
18:59:53 [INFO] __main__: Starting network server …
18:59:53 [INFO] gameserver.network.handlers: Registered 31 message handlers: summary_request, item_request, military_request, map_load_request, map_save_request, new_item, new_structure, delete_structure, upgrade_structure, citizen_upgrade, change_citizen, increase_life, new_army, new_attack_request, change_army, new_wave, change_wave, end_siege, battle_register, battle_unregister, battle_next_wave_request, notification_request, user_message, timeline_request, userinfo_request, hall_of_fame_request, preferences_request, change_preferences, auth_request, signup, create_empire
18:59:53 [INFO] websockets.server: server listening on 0.0.0.0:8765
18:59:53 [INFO] gameserver.network.server: WebSocket server listening on ws://0.0.0.0:8765
18:59:53 [INFO] __main__:   WebSocket server listening on 0.0.0.0:8765
18:59:53 [INFO] gameserver.debug.dashboard: Debug dashboard running at http://0.0.0.0:9000/
18:59:53 [INFO] __main__: Starting game loop …
18:59:53 [INFO] __main__:   game loop running (1 s tick)
18:59:54 [INFO] websockets.server: connection open
18:59:54 [INFO] gameserver.network.server: Session registered: uid=-1
18:59:54 [INFO] gameserver.network.server: Client connected: uid=-1 remote=('192.168.178.2', 60897)
18:59:54 [INFO] gameserver.network.auth: Login success: eem (uid=2)
18:59:54 [INFO] gameserver.network.server: Session registered: uid=2
18:59:54 [INFO] gameserver.network.server: Session upgraded: guest=-1 → uid=2
18:59:54 [INFO] gameserver.network.server: Session removed: uid=2
18:59:55 [INFO] websockets.server: connection open
18:59:55 [INFO] gameserver.network.server: Session registered: uid=-2
18:59:55 [INFO] gameserver.network.server: Client connected: uid=-2 remote=('192.168.178.2', 60902)
18:59:55 [INFO] gameserver.network.auth: Login success: eem (uid=2)
18:59:55 [INFO] gameserver.network.server: Session registered: uid=2
18:59:55 [INFO] gameserver.network.server: Session upgraded: guest=-2 → uid=2
18:59:57 [INFO] gameserver.network.server: Session removed: uid=2
18:59:57 [INFO] websockets.server: connection open
18:59:57 [INFO] gameserver.network.server: Session registered: uid=-3
18:59:57 [INFO] gameserver.network.server: Client connected: uid=-3 remote=('192.168.178.2', 60906)
18:59:57 [INFO] gameserver.network.auth: Login success: eem (uid=2)
18:59:57 [INFO] gameserver.network.server: Session registered: uid=2
18:59:57 [INFO] gameserver.network.server: Session upgraded: guest=-3 → uid=2
19:01:46 [INFO] __main__: Shutdown signal received — stopping …
19:01:47 [INFO] __main__: Shutting down …
19:01:47 [INFO] gameserver.persistence.state_save: Game state saved to state.yaml (2 empires, 0 attacks, 0 battles)
19:01:47 [INFO] websockets.server: server closing
19:01:47 [INFO] gameserver.network.server: Session removed: uid=2
19:01:47 [INFO] websockets.server: server closed
19:01:47 [INFO] gameserver.network.server: WebSocket server stopped
19:01:47 [INFO] __main__:   WebSocket server stopped
19:01:47 [INFO] __main__:   debug dashboard stopped
19:01:47 [INFO] __main__:   database closed
19:01:47 [INFO] __main__:   goodbye
19:01:48 [INFO] __main__: === Game Server starting ===
19:01:48 [INFO] __main__: Loading configuration …
19:01:49 [INFO] __main__:   items:        210 loaded from config
19:01:49 [INFO] __main__:   map:          4 paths, 23 build tiles from config/maps/default.yaml
19:01:49 [INFO] __main__:   ai_templates: 2 entries from config/ai_templates.yaml
19:01:49 [INFO] gameserver.loaders.game_config_loader: Loaded game config from config/game.yaml (29 keys)
19:01:49 [INFO] __main__:   game_config:  loaded
19:01:49 [INFO] __main__: Initializing persistence …
19:01:49 [INFO] gameserver.persistence.database: Database connected: gameserver.db
19:01:49 [INFO] __main__:   database:     connected (gameserver.db)
19:01:49 [INFO] gameserver.persistence.state_load: Restoring state from state.yaml (saved at 2026-02-08T19:01:46, version 1)
19:01:49 [INFO] gameserver.persistence.state_load: Restored 2 empires, 0 attacks, 0 battles
19:01:49 [INFO] __main__:   state:        restored from disk (2 empires, 0 attacks)
19:01:49 [INFO] __main__: Creating services …
19:01:49 [INFO] __main__:   upgrade_provider: 210 items registered
19:01:49 [INFO] __main__:   all services created
19:01:49 [INFO] __main__: Wiring event handlers …
19:01:49 [INFO] __main__:   event handlers registered
19:01:49 [INFO] gameserver.engine.empire_service: Empire registered: uid=100 name='TestImperium'
19:01:49 [INFO] gameserver.engine.empire_service: Empire 100: recalculated effects → {}
19:01:49 [INFO] gameserver.engine.empire_service: Empire registered: uid=2 name='Empire1'
19:01:49 [INFO] gameserver.engine.empire_service: Empire 2: recalculated effects → {'life_offset': 0.001, 'gold_offset': 0.2, 'culture_offset': 0.15000000000000002, 'culture_modifier': 0.1, 'gold_modifier': 0.1, 'build_speed_modifier': 0.1}
19:01:49 [INFO] __main__: Restored 2 empires from saved state
19:01:49 [INFO] __main__: Starting network server …
19:01:49 [INFO] gameserver.network.handlers: Registered 31 message handlers: summary_request, item_request, military_request, map_load_request, map_save_request, new_item, new_structure, delete_structure, upgrade_structure, citizen_upgrade, change_citizen, increase_life, new_army, new_attack_request, change_army, new_wave, change_wave, end_siege, battle_register, battle_unregister, battle_next_wave_request, notification_request, user_message, timeline_request, userinfo_request, hall_of_fame_request, preferences_request, change_preferences, auth_request, signup, create_empire
19:01:49 [INFO] websockets.server: server listening on 0.0.0.0:8765
19:01:49 [INFO] gameserver.network.server: WebSocket server listening on ws://0.0.0.0:8765
19:01:49 [INFO] __main__:   WebSocket server listening on 0.0.0.0:8765
19:01:49 [INFO] gameserver.debug.dashboard: Debug dashboard running at http://0.0.0.0:9000/
19:01:49 [INFO] __main__: Starting game loop …
19:01:49 [INFO] __main__:   game loop running (1 s tick)
19:01:50 [INFO] websockets.server: connection open
19:01:50 [INFO] gameserver.network.server: Session registered: uid=-1
19:01:50 [INFO] gameserver.network.server: Client connected: uid=-1 remote=('192.168.178.2', 60949)
19:01:50 [INFO] gameserver.network.auth: Login success: eem (uid=2)
19:01:50 [INFO] gameserver.network.server: Session registered: uid=2
19:01:50 [INFO] gameserver.network.server: Session upgraded: guest=-1 → uid=2
19:02:06 [INFO] gameserver.network.server: Session removed: uid=2
19:02:06 [INFO] websockets.server: connection open
19:02:06 [INFO] gameserver.network.server: Session registered: uid=-2
19:02:06 [INFO] gameserver.network.server: Client connected: uid=-2 remote=('192.168.178.2', 60959)
19:02:06 [INFO] gameserver.network.auth: Login success: eem (uid=2)
19:02:06 [INFO] gameserver.network.server: Session registered: uid=2
19:02:06 [INFO] gameserver.network.server: Session upgraded: guest=-2 → uid=2
19:02:08 [INFO] gameserver.network.server: Session removed: uid=2
19:02:08 [INFO] websockets.server: connection open
19:02:08 [INFO] gameserver.network.server: Session registered: uid=-3
19:02:08 [INFO] gameserver.network.server: Client connected: uid=-3 remote=('192.168.178.2', 60968)
19:02:08 [INFO] gameserver.network.auth: Login success: eem (uid=2)
19:02:08 [INFO] gameserver.network.server: Session registered: uid=2
19:02:08 [INFO] gameserver.network.server: Session upgraded: guest=-3 → uid=2
19:02:10 [INFO] gameserver.network.server: Session removed: uid=2
19:02:10 [INFO] websockets.server: connection open
19:02:10 [INFO] gameserver.network.server: Session registered: uid=-4
19:02:10 [INFO] gameserver.network.server: Client connected: uid=-4 remote=('192.168.178.2', 60991)
19:02:10 [INFO] gameserver.network.auth: Login success: eem (uid=2)
19:02:10 [INFO] gameserver.network.server: Session registered: uid=2
19:02:10 [INFO] gameserver.network.server: Session upgraded: guest=-4 → uid=2
19:02:35 [INFO] __main__: Shutdown signal received — stopping …
19:02:36 [INFO] __main__: Shutting down …
19:02:36 [INFO] gameserver.persistence.state_save: Game state saved to state.yaml (2 empires, 0 attacks, 0 battles)
19:02:36 [INFO] websockets.server: server closing
19:02:36 [INFO] gameserver.network.server: Session removed: uid=2
19:02:36 [INFO] websockets.server: server closed
19:02:36 [INFO] gameserver.network.server: WebSocket server stopped
19:02:36 [INFO] __main__:   WebSocket server stopped
19:02:36 [INFO] __main__:   debug dashboard stopped
19:02:36 [INFO] __main__:   database closed
19:02:36 [INFO] __main__:   goodbye
19:02:43 [INFO] __main__: === Game Server starting ===
19:02:43 [INFO] __main__: Loading configuration …
19:02:44 [INFO] __main__:   items:        210 loaded from config
19:02:44 [INFO] __main__:   map:          4 paths, 23 build tiles from config/maps/default.yaml
19:02:44 [INFO] __main__:   ai_templates: 2 entries from config/ai_templates.yaml
19:02:44 [INFO] gameserver.loaders.game_config_loader: Loaded game config from config/game.yaml (29 keys)
19:02:44 [INFO] __main__:   game_config:  loaded
19:02:44 [INFO] __main__: Initializing persistence …
19:02:44 [INFO] gameserver.persistence.database: Database connected: gameserver.db
19:02:44 [INFO] __main__:   database:     connected (gameserver.db)
19:02:44 [INFO] gameserver.persistence.state_load: Restoring state from state.yaml (saved at 2026-02-08T19:02:36, version 1)
19:02:44 [INFO] gameserver.persistence.state_load: Restored 2 empires, 0 attacks, 0 battles
19:02:44 [INFO] __main__:   state:        restored from disk (2 empires, 0 attacks)
19:02:44 [INFO] __main__: Creating services …
19:02:44 [INFO] __main__:   upgrade_provider: 210 items registered
19:02:44 [INFO] __main__:   all services created
19:02:44 [INFO] __main__: Wiring event handlers …
19:02:44 [INFO] __main__:   event handlers registered
19:02:44 [INFO] gameserver.engine.empire_service: Empire registered: uid=100 name='TestImperium'
19:02:44 [INFO] gameserver.engine.empire_service: Empire 100: recalculated effects → {}
19:02:44 [INFO] gameserver.engine.empire_service: Empire registered: uid=2 name='Empire1'
19:02:44 [INFO] gameserver.engine.empire_service: Empire 2: recalculated effects → {'life_offset': 0.001, 'gold_offset': 0.2, 'culture_offset': 0.15000000000000002, 'culture_modifier': 0.1, 'gold_modifier': 0.1, 'build_speed_modifier': 0.1}
19:02:44 [INFO] __main__: Restored 2 empires from saved state
19:02:44 [INFO] __main__: Starting network server …
19:02:44 [INFO] gameserver.network.handlers: Registered 31 message handlers: summary_request, item_request, military_request, map_load_request, map_save_request, new_item, new_structure, delete_structure, upgrade_structure, citizen_upgrade, change_citizen, increase_life, new_army, new_attack_request, change_army, new_wave, change_wave, end_siege, battle_register, battle_unregister, battle_next_wave_request, notification_request, user_message, timeline_request, userinfo_request, hall_of_fame_request, preferences_request, change_preferences, auth_request, signup, create_empire
19:02:44 [INFO] websockets.server: server listening on 0.0.0.0:8765
19:02:44 [INFO] gameserver.network.server: WebSocket server listening on ws://0.0.0.0:8765
19:02:44 [INFO] __main__:   WebSocket server listening on 0.0.0.0:8765
19:02:44 [INFO] gameserver.debug.dashboard: Debug dashboard running at http://0.0.0.0:9000/
19:02:44 [INFO] __main__: Starting game loop …
19:02:44 [INFO] __main__:   game loop running (1 s tick)
19:02:44 [INFO] websockets.server: connection open
19:02:44 [INFO] gameserver.network.server: Session registered: uid=-1
19:02:44 [INFO] gameserver.network.server: Client connected: uid=-1 remote=('192.168.178.2', 58629)
19:02:44 [INFO] gameserver.network.auth: Login success: eem (uid=2)
19:02:44 [INFO] gameserver.network.server: Session registered: uid=2
19:02:44 [INFO] gameserver.network.server: Session upgraded: guest=-1 → uid=2
19:02:47 [INFO] __main__: Shutdown signal received — stopping …
19:02:48 [INFO] __main__: Shutting down …
19:02:48 [INFO] gameserver.persistence.state_save: Game state saved to state.yaml (2 empires, 0 attacks, 0 battles)
19:02:48 [INFO] websockets.server: server closing
19:02:48 [INFO] gameserver.network.server: Session removed: uid=2
19:02:49 [ERROR] websockets.server: opening handshake failed
Traceback (most recent call last):
  File "/home/pi/e3/.venv/lib/python3.9/site-packages/websockets/http11.py", line 138, in parse
    request_line = yield from parse_line(read_line)
  File "/home/pi/e3/.venv/lib/python3.9/site-packages/websockets/http11.py", line 309, in parse_line
    line = yield from read_line(MAX_LINE_LENGTH)
  File "/home/pi/e3/.venv/lib/python3.9/site-packages/websockets/streams.py", line 46, in read_line
    raise EOFError(f"stream ends after {p} bytes, before end of line")
EOFError: stream ends after 0 bytes, before end of line

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/pi/e3/.venv/lib/python3.9/site-packages/websockets/server.py", line 545, in parse
    request = yield from Request.parse(
  File "/home/pi/e3/.venv/lib/python3.9/site-packages/websockets/http11.py", line 140, in parse
    raise EOFError("connection closed while reading HTTP request line") from exc
EOFError: connection closed while reading HTTP request line

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/pi/e3/.venv/lib/python3.9/site-packages/websockets/asyncio/server.py", line 356, in conn_handler
    await connection.handshake(
  File "/home/pi/e3/.venv/lib/python3.9/site-packages/websockets/asyncio/server.py", line 207, in handshake
    raise self.protocol.handshake_exc
websockets.exceptions.InvalidMessage: did not receive a valid HTTP request
19:02:49 [INFO] websockets.server: server closed
19:02:49 [INFO] gameserver.network.server: WebSocket server stopped
19:02:49 [INFO] __main__:   WebSocket server stopped
19:02:49 [INFO] __main__:   debug dashboard stopped
19:02:49 [INFO] __main__:   database closed
19:02:49 [INFO] __main__:   goodbye
19:02:54 [INFO] __main__: === Game Server starting ===
19:02:54 [INFO] __main__: Loading configuration …
19:02:55 [INFO] __main__:   items:        210 loaded from config
19:02:55 [INFO] __main__:   map:          4 paths, 23 build tiles from config/maps/default.yaml
19:02:55 [INFO] __main__:   ai_templates: 2 entries from config/ai_templates.yaml
19:02:55 [INFO] gameserver.loaders.game_config_loader: Loaded game config from config/game.yaml (29 keys)
19:02:55 [INFO] __main__:   game_config:  loaded
19:02:55 [INFO] __main__: Initializing persistence …
19:02:55 [INFO] gameserver.persistence.database: Database connected: gameserver.db
19:02:55 [INFO] __main__:   database:     connected (gameserver.db)
19:02:55 [INFO] gameserver.persistence.state_load: Restoring state from state.yaml (saved at 2026-02-08T19:02:48, version 1)
19:02:55 [INFO] gameserver.persistence.state_load: Restored 2 empires, 0 attacks, 0 battles
19:02:55 [INFO] __main__:   state:        restored from disk (2 empires, 0 attacks)
19:02:55 [INFO] __main__: Creating services …
19:02:55 [INFO] __main__:   upgrade_provider: 210 items registered
19:02:55 [INFO] __main__:   all services created
19:02:55 [INFO] __main__: Wiring event handlers …
19:02:55 [INFO] __main__:   event handlers registered
19:02:55 [INFO] gameserver.engine.empire_service: Empire registered: uid=100 name='TestImperium'
19:02:55 [INFO] gameserver.engine.empire_service: Empire 100: recalculated effects → {}
19:02:55 [INFO] gameserver.engine.empire_service: Empire registered: uid=2 name='Empire1'
19:02:55 [INFO] gameserver.engine.empire_service: Empire 2: recalculated effects → {'life_offset': 0.001, 'gold_offset': 0.2, 'culture_offset': 0.15000000000000002, 'culture_modifier': 0.1, 'gold_modifier': 0.1, 'build_speed_modifier': 0.1}
19:02:55 [INFO] __main__: Restored 2 empires from saved state
19:02:55 [INFO] __main__: Starting network server …
19:02:55 [INFO] gameserver.network.handlers: Registered 31 message handlers: summary_request, item_request, military_request, map_load_request, map_save_request, new_item, new_structure, delete_structure, upgrade_structure, citizen_upgrade, change_citizen, increase_life, new_army, new_attack_request, change_army, new_wave, change_wave, end_siege, battle_register, battle_unregister, battle_next_wave_request, notification_request, user_message, timeline_request, userinfo_request, hall_of_fame_request, preferences_request, change_preferences, auth_request, signup, create_empire
19:02:55 [INFO] websockets.server: server listening on 0.0.0.0:8765
19:02:55 [INFO] gameserver.network.server: WebSocket server listening on ws://0.0.0.0:8765
19:02:55 [INFO] __main__:   WebSocket server listening on 0.0.0.0:8765
19:02:55 [INFO] gameserver.debug.dashboard: Debug dashboard running at http://0.0.0.0:9000/
19:02:55 [INFO] __main__: Starting game loop …
19:02:55 [INFO] __main__:   game loop running (1 s tick)
19:02:55 [INFO] websockets.server: connection open
19:02:55 [INFO] gameserver.network.server: Session registered: uid=-1
19:02:55 [INFO] gameserver.network.server: Client connected: uid=-1 remote=('192.168.178.2', 61614)
19:02:55 [INFO] gameserver.network.auth: Login success: eem (uid=2)
19:02:55 [INFO] gameserver.network.server: Session registered: uid=2
19:02:55 [INFO] gameserver.network.server: Session upgraded: guest=-1 → uid=2
19:02:55 [INFO] gameserver.network.server: Session removed: uid=2
19:02:55 [INFO] websockets.server: connection open
19:02:55 [INFO] gameserver.network.server: Session registered: uid=-2
19:02:55 [INFO] gameserver.network.server: Client connected: uid=-2 remote=('192.168.178.2', 61617)
19:02:55 [INFO] gameserver.network.auth: Login success: eem (uid=2)
19:02:55 [INFO] gameserver.network.server: Session registered: uid=2
19:02:55 [INFO] gameserver.network.server: Session upgraded: guest=-2 → uid=2
19:03:04 [INFO] gameserver.network.handlers: Map saved for empire Empire1 (uid=2): 0 tiles
19:03:05 [INFO] gameserver.network.handlers: Map saved for empire Empire1 (uid=2): 0 tiles
19:03:05 [INFO] gameserver.network.handlers: Map saved for empire Empire1 (uid=2): 0 tiles
19:03:08 [INFO] __main__: Shutdown signal received — stopping …
19:03:09 [INFO] __main__: Shutting down …
19:03:09 [INFO] gameserver.persistence.state_save: Game state saved to state.yaml (2 empires, 0 attacks, 0 battles)
19:03:09 [INFO] websockets.server: server closing
19:03:09 [INFO] gameserver.network.server: Session removed: uid=2
19:03:09 [INFO] websockets.server: server closed
19:03:09 [INFO] gameserver.network.server: WebSocket server stopped
19:03:09 [INFO] __main__:   WebSocket server stopped
19:03:09 [INFO] __main__:   debug dashboard stopped
19:03:09 [INFO] __main__:   database closed
19:03:09 [INFO] __main__:   goodbye
19:03:34 [INFO] __main__: === Game Server starting ===
19:03:34 [INFO] __main__: Loading configuration …
19:03:35 [INFO] __main__:   items:        210 loaded from config
19:03:35 [INFO] __main__:   map:          4 paths, 23 build tiles from config/maps/default.yaml
19:03:35 [INFO] __main__:   ai_templates: 2 entries from config/ai_templates.yaml
19:03:35 [INFO] gameserver.loaders.game_config_loader: Loaded game config from config/game.yaml (29 keys)
19:03:35 [INFO] __main__:   game_config:  loaded
19:03:35 [INFO] __main__: Initializing persistence …
19:03:35 [INFO] gameserver.persistence.database: Database connected: gameserver.db
19:03:35 [INFO] __main__:   database:     connected (gameserver.db)
19:03:35 [INFO] gameserver.persistence.state_load: Restoring state from state.yaml (saved at 2026-02-08T19:03:09, version 1)
19:03:35 [INFO] gameserver.persistence.state_load: Restored 2 empires, 0 attacks, 0 battles
19:03:35 [INFO] __main__:   state:        restored from disk (2 empires, 0 attacks)
19:03:35 [INFO] __main__: Creating services …
19:03:35 [INFO] __main__:   upgrade_provider: 210 items registered
19:03:35 [INFO] __main__:   all services created
19:03:35 [INFO] __main__: Wiring event handlers …
19:03:35 [INFO] __main__:   event handlers registered
19:03:35 [INFO] gameserver.engine.empire_service: Empire registered: uid=100 name='TestImperium'
19:03:35 [INFO] gameserver.engine.empire_service: Empire 100: recalculated effects → {}
19:03:35 [INFO] gameserver.engine.empire_service: Empire registered: uid=2 name='Empire1'
19:03:35 [INFO] gameserver.engine.empire_service: Empire 2: recalculated effects → {'life_offset': 0.001, 'gold_offset': 0.2, 'culture_offset': 0.15000000000000002, 'culture_modifier': 0.1, 'gold_modifier': 0.1, 'build_speed_modifier': 0.1}
19:03:35 [INFO] __main__: Restored 2 empires from saved state
19:03:35 [INFO] __main__: Starting network server …
19:03:35 [INFO] gameserver.network.handlers: Registered 31 message handlers: summary_request, item_request, military_request, map_load_request, map_save_request, new_item, new_structure, delete_structure, upgrade_structure, citizen_upgrade, change_citizen, increase_life, new_army, new_attack_request, change_army, new_wave, change_wave, end_siege, battle_register, battle_unregister, battle_next_wave_request, notification_request, user_message, timeline_request, userinfo_request, hall_of_fame_request, preferences_request, change_preferences, auth_request, signup, create_empire
19:03:35 [INFO] websockets.server: server listening on 0.0.0.0:8765
19:03:35 [INFO] gameserver.network.server: WebSocket server listening on ws://0.0.0.0:8765
19:03:35 [INFO] __main__:   WebSocket server listening on 0.0.0.0:8765
19:03:35 [INFO] gameserver.debug.dashboard: Debug dashboard running at http://0.0.0.0:9000/
19:03:35 [INFO] __main__: Starting game loop …
19:03:35 [INFO] __main__:   game loop running (1 s tick)
19:03:35 [INFO] websockets.server: connection open
19:03:35 [INFO] gameserver.network.server: Session registered: uid=-1
19:03:35 [INFO] gameserver.network.server: Client connected: uid=-1 remote=('192.168.178.2', 61663)
19:03:35 [INFO] websockets.server: connection open
19:03:35 [INFO] gameserver.network.server: Session registered: uid=-2
19:03:35 [INFO] gameserver.network.server: Client connected: uid=-2 remote=('192.168.178.2', 61657)
19:03:35 [INFO] gameserver.network.auth: Login success: eem (uid=2)
19:03:35 [INFO] gameserver.network.server: Session registered: uid=2
19:03:35 [INFO] gameserver.network.server: Session upgraded: guest=-1 → uid=2
19:03:35 [INFO] gameserver.network.server: Client disconnected: uid=-2 code=CloseCode.ABNORMAL_CLOSURE
19:03:35 [INFO] gameserver.network.server: Session removed: uid=-2
19:03:41 [ERROR] websockets.server: opening handshake failed
Traceback (most recent call last):
  File "/home/pi/e3/.venv/lib/python3.9/site-packages/websockets/http11.py", line 138, in parse
    request_line = yield from parse_line(read_line)
  File "/home/pi/e3/.venv/lib/python3.9/site-packages/websockets/http11.py", line 309, in parse_line
    line = yield from read_line(MAX_LINE_LENGTH)
  File "/home/pi/e3/.venv/lib/python3.9/site-packages/websockets/streams.py", line 46, in read_line
    raise EOFError(f"stream ends after {p} bytes, before end of line")
EOFError: stream ends after 0 bytes, before end of line

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/pi/e3/.venv/lib/python3.9/site-packages/websockets/server.py", line 545, in parse
    request = yield from Request.parse(
  File "/home/pi/e3/.venv/lib/python3.9/site-packages/websockets/http11.py", line 140, in parse
    raise EOFError("connection closed while reading HTTP request line") from exc
EOFError: connection closed while reading HTTP request line

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/pi/e3/.venv/lib/python3.9/site-packages/websockets/asyncio/server.py", line 356, in conn_handler
    await connection.handshake(
  File "/home/pi/e3/.venv/lib/python3.9/site-packages/websockets/asyncio/server.py", line 207, in handshake
    raise self.protocol.handshake_exc
websockets.exceptions.InvalidMessage: did not receive a valid HTTP request
19:03:43 [INFO] gameserver.debug.dashboard: Signal sent (handled): type=summary_request sender=100
19:04:44 [INFO] __main__: Shutdown signal received — stopping …
19:04:45 [INFO] __main__: Shutting down …
19:04:45 [INFO] gameserver.persistence.state_save: Game state saved to state.yaml (2 empires, 0 attacks, 0 battles)
19:04:45 [INFO] websockets.server: server closing
19:04:45 [INFO] gameserver.network.server: Session removed: uid=2
19:04:45 [INFO] websockets.server: server closed
19:04:45 [INFO] gameserver.network.server: WebSocket server stopped
19:04:45 [INFO] __main__:   WebSocket server stopped
19:04:45 [INFO] __main__:   debug dashboard stopped
19:04:45 [INFO] __main__:   database closed
19:04:45 [INFO] __main__:   goodbye
19:04:55 [INFO] __main__: === Game Server starting ===
19:04:55 [INFO] __main__: Loading configuration …
19:04:55 [INFO] __main__:   items:        210 loaded from config
19:04:55 [INFO] __main__:   map:          4 paths, 23 build tiles from config/maps/default.yaml
19:04:55 [INFO] __main__:   ai_templates: 2 entries from config/ai_templates.yaml
19:04:55 [INFO] gameserver.loaders.game_config_loader: Loaded game config from config/game.yaml (29 keys)
19:04:55 [INFO] __main__:   game_config:  loaded
19:04:55 [INFO] __main__: Initializing persistence …
19:04:55 [INFO] gameserver.persistence.database: Database connected: gameserver.db
19:04:55 [INFO] __main__:   database:     connected (gameserver.db)
19:04:55 [INFO] gameserver.persistence.state_load: Restoring state from state.yaml (saved at 2026-02-08T19:04:45, version 1)
19:04:55 [INFO] gameserver.persistence.state_load: Restored 2 empires, 0 attacks, 0 battles
19:04:55 [INFO] __main__:   state:        restored from disk (2 empires, 0 attacks)
19:04:55 [INFO] __main__: Creating services …
19:04:55 [INFO] __main__:   upgrade_provider: 210 items registered
19:04:55 [INFO] __main__:   all services created
19:04:55 [INFO] __main__: Wiring event handlers …
19:04:55 [INFO] __main__:   event handlers registered
19:04:55 [INFO] gameserver.engine.empire_service: Empire registered: uid=100 name='TestImperium'
19:04:55 [INFO] gameserver.engine.empire_service: Empire 100: recalculated effects → {}
19:04:55 [INFO] gameserver.engine.empire_service: Empire registered: uid=2 name='Empire1'
19:04:55 [INFO] gameserver.engine.empire_service: Empire 2: recalculated effects → {'life_offset': 0.001, 'gold_offset': 0.2, 'culture_offset': 0.15000000000000002, 'culture_modifier': 0.1, 'gold_modifier': 0.1, 'build_speed_modifier': 0.1}
19:04:55 [INFO] __main__: Restored 2 empires from saved state
19:04:55 [INFO] __main__: Starting network server …
19:04:55 [INFO] gameserver.network.handlers: Registered 31 message handlers: summary_request, item_request, military_request, map_load_request, map_save_request, new_item, new_structure, delete_structure, upgrade_structure, citizen_upgrade, change_citizen, increase_life, new_army, new_attack_request, change_army, new_wave, change_wave, end_siege, battle_register, battle_unregister, battle_next_wave_request, notification_request, user_message, timeline_request, userinfo_request, hall_of_fame_request, preferences_request, change_preferences, auth_request, signup, create_empire
19:04:55 [INFO] websockets.server: server listening on 0.0.0.0:8765
19:04:55 [INFO] gameserver.network.server: WebSocket server listening on ws://0.0.0.0:8765
19:04:55 [INFO] __main__:   WebSocket server listening on 0.0.0.0:8765
19:04:55 [INFO] gameserver.debug.dashboard: Debug dashboard running at http://0.0.0.0:9000/
19:04:55 [INFO] __main__: Starting game loop …
19:04:55 [INFO] __main__:   game loop running (1 s tick)
19:04:56 [INFO] websockets.server: connection open
19:04:56 [INFO] gameserver.network.server: Session registered: uid=-1
19:04:56 [INFO] gameserver.network.server: Client connected: uid=-1 remote=('192.168.178.2', 63894)
19:04:56 [INFO] gameserver.network.auth: Login success: eem (uid=2)
19:04:56 [INFO] gameserver.network.server: Session registered: uid=2
19:04:56 [INFO] gameserver.network.server: Session upgraded: guest=-1 → uid=2
19:04:58 [INFO] gameserver.network.server: Session removed: uid=2
19:04:58 [INFO] websockets.server: connection open
19:04:58 [INFO] gameserver.network.server: Session registered: uid=-2
19:04:58 [INFO] gameserver.network.server: Client connected: uid=-2 remote=('192.168.178.2', 63905)
19:04:58 [INFO] gameserver.network.auth: Login success: eem (uid=2)
19:04:58 [INFO] gameserver.network.server: Session registered: uid=2
19:04:58 [INFO] gameserver.network.server: Session upgraded: guest=-2 → uid=2
19:05:02 [INFO] __main__: Shutdown signal received — stopping …
19:05:02 [ERROR] websockets.server: opening handshake failed
Traceback (most recent call last):
  File "/home/pi/e3/.venv/lib/python3.9/site-packages/websockets/http11.py", line 138, in parse
    request_line = yield from parse_line(read_line)
  File "/home/pi/e3/.venv/lib/python3.9/site-packages/websockets/http11.py", line 309, in parse_line
    line = yield from read_line(MAX_LINE_LENGTH)
  File "/home/pi/e3/.venv/lib/python3.9/site-packages/websockets/streams.py", line 46, in read_line
    raise EOFError(f"stream ends after {p} bytes, before end of line")
EOFError: stream ends after 0 bytes, before end of line

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/pi/e3/.venv/lib/python3.9/site-packages/websockets/server.py", line 545, in parse
    request = yield from Request.parse(
  File "/home/pi/e3/.venv/lib/python3.9/site-packages/websockets/http11.py", line 140, in parse
    raise EOFError("connection closed while reading HTTP request line") from exc
EOFError: connection closed while reading HTTP request line

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/pi/e3/.venv/lib/python3.9/site-packages/websockets/asyncio/server.py", line 356, in conn_handler
    await connection.handshake(
  File "/home/pi/e3/.venv/lib/python3.9/site-packages/websockets/asyncio/server.py", line 207, in handshake
    raise self.protocol.handshake_exc
websockets.exceptions.InvalidMessage: did not receive a valid HTTP request
19:05:02 [INFO] __main__: Shutting down …
19:05:02 [INFO] gameserver.persistence.state_save: Game state saved to state.yaml (2 empires, 0 attacks, 0 battles)
19:05:02 [INFO] websockets.server: server closing
19:05:02 [INFO] gameserver.network.server: Session removed: uid=2
19:05:02 [INFO] websockets.server: server closed
19:05:02 [INFO] gameserver.network.server: WebSocket server stopped
19:05:02 [INFO] __main__:   WebSocket server stopped
19:05:02 [INFO] __main__:   debug dashboard stopped
19:05:02 [INFO] __main__:   database closed
19:05:02 [INFO] __main__:   goodbye
19:05:24 [INFO] __main__: === Game Server starting ===
19:05:24 [INFO] __main__: Loading configuration …
19:05:25 [INFO] __main__:   items:        210 loaded from config
19:05:25 [INFO] __main__:   map:          4 paths, 23 build tiles from config/maps/default.yaml
19:05:25 [INFO] __main__:   ai_templates: 2 entries from config/ai_templates.yaml
19:05:25 [INFO] gameserver.loaders.game_config_loader: Loaded game config from config/game.yaml (29 keys)
19:05:25 [INFO] __main__:   game_config:  loaded
19:05:25 [INFO] __main__: Initializing persistence …
19:05:25 [INFO] gameserver.persistence.database: Database connected: gameserver.db
19:05:25 [INFO] __main__:   database:     connected (gameserver.db)
19:05:25 [INFO] gameserver.persistence.state_load: Restoring state from state.yaml (saved at 2026-02-08T19:05:02, version 1)
19:05:25 [INFO] gameserver.persistence.state_load: Restored 2 empires, 0 attacks, 0 battles
19:05:25 [INFO] __main__:   state:        restored from disk (2 empires, 0 attacks)
19:05:25 [INFO] __main__: Creating services …
19:05:25 [INFO] __main__:   upgrade_provider: 210 items registered
19:05:25 [INFO] __main__:   all services created
19:05:25 [INFO] __main__: Wiring event handlers …
19:05:25 [INFO] __main__:   event handlers registered
19:05:25 [INFO] gameserver.engine.empire_service: Empire registered: uid=100 name='TestImperium'
19:05:25 [INFO] gameserver.engine.empire_service: Empire 100: recalculated effects → {}
19:05:25 [INFO] gameserver.engine.empire_service: Empire registered: uid=2 name='Empire1'
19:05:25 [INFO] gameserver.engine.empire_service: Empire 2: recalculated effects → {'life_offset': 0.001, 'gold_offset': 0.2, 'culture_offset': 0.15000000000000002, 'culture_modifier': 0.1, 'gold_modifier': 0.1, 'build_speed_modifier': 0.1}
19:05:25 [INFO] __main__: Restored 2 empires from saved state
19:05:25 [INFO] __main__: Starting network server …
19:05:25 [INFO] gameserver.network.handlers: Registered 31 message handlers: summary_request, item_request, military_request, map_load_request, map_save_request, new_item, new_structure, delete_structure, upgrade_structure, citizen_upgrade, change_citizen, increase_life, new_army, new_attack_request, change_army, new_wave, change_wave, end_siege, battle_register, battle_unregister, battle_next_wave_request, notification_request, user_message, timeline_request, userinfo_request, hall_of_fame_request, preferences_request, change_preferences, auth_request, signup, create_empire
19:05:25 [INFO] websockets.server: server listening on 0.0.0.0:8765
19:05:25 [INFO] gameserver.network.server: WebSocket server listening on ws://0.0.0.0:8765
19:05:25 [INFO] __main__:   WebSocket server listening on 0.0.0.0:8765
19:05:25 [INFO] gameserver.debug.dashboard: Debug dashboard running at http://0.0.0.0:9000/
19:05:25 [INFO] __main__: Starting game loop …
19:05:25 [INFO] __main__:   game loop running (1 s tick)
19:05:26 [INFO] websockets.server: connection open
19:05:26 [INFO] gameserver.network.server: Session registered: uid=-1
19:05:26 [INFO] gameserver.network.server: Client connected: uid=-1 remote=('192.168.178.2', 57857)
19:05:26 [INFO] gameserver.network.auth: Login success: eem (uid=2)
19:05:26 [INFO] gameserver.network.server: Session registered: uid=2
19:05:26 [INFO] gameserver.network.server: Session upgraded: guest=-1 → uid=2
19:05:32 [INFO] gameserver.network.handlers: Map saved for empire Empire1 (uid=2): 0 tiles
19:05:32 [INFO] gameserver.network.handlers: Map saved for empire Empire1 (uid=2): 0 tiles
19:05:38 [INFO] __main__: Shutdown signal received — stopping …
19:05:38 [INFO] __main__: Shutting down …
19:05:38 [INFO] gameserver.persistence.state_save: Game state saved to state.yaml (2 empires, 0 attacks, 0 battles)
19:05:38 [INFO] websockets.server: server closing
19:05:38 [INFO] gameserver.network.server: Session removed: uid=2
19:05:38 [INFO] websockets.server: server closed
19:05:38 [INFO] gameserver.network.server: WebSocket server stopped
19:05:38 [INFO] __main__:   WebSocket server stopped
19:05:38 [INFO] __main__:   debug dashboard stopped
19:05:38 [INFO] __main__:   database closed
19:05:38 [INFO] __main__:   goodbye
19:06:42 [INFO] __main__: === Game Server starting ===
19:06:42 [INFO] __main__: Loading configuration …
19:06:43 [INFO] __main__:   items:        210 loaded from config
19:06:43 [INFO] __main__:   map:          4 paths, 23 build tiles from config/maps/default.yaml
19:06:43 [INFO] __main__:   ai_templates: 2 entries from config/ai_templates.yaml
19:06:43 [INFO] gameserver.loaders.game_config_loader: Loaded game config from config/game.yaml (29 keys)
19:06:43 [INFO] __main__:   game_config:  loaded
19:06:43 [INFO] __main__: Initializing persistence …
19:06:43 [INFO] gameserver.persistence.database: Database connected: gameserver.db
19:06:43 [INFO] __main__:   database:     connected (gameserver.db)
19:06:43 [INFO] gameserver.persistence.state_load: Restoring state from state.yaml (saved at 2026-02-08T19:05:38, version 1)
19:06:43 [INFO] gameserver.persistence.state_load: Restored 2 empires, 0 attacks, 0 battles
19:06:43 [INFO] __main__:   state:        restored from disk (2 empires, 0 attacks)
19:06:43 [INFO] __main__: Creating services …
19:06:43 [INFO] __main__:   upgrade_provider: 210 items registered
19:06:43 [INFO] __main__:   all services created
19:06:43 [INFO] __main__: Wiring event handlers …
19:06:43 [INFO] __main__:   event handlers registered
19:06:43 [INFO] gameserver.engine.empire_service: Empire registered: uid=100 name='TestImperium'
19:06:43 [INFO] gameserver.engine.empire_service: Empire 100: recalculated effects → {}
19:06:43 [INFO] gameserver.engine.empire_service: Empire registered: uid=2 name='Empire1'
19:06:43 [INFO] gameserver.engine.empire_service: Empire 2: recalculated effects → {'life_offset': 0.001, 'gold_offset': 0.2, 'culture_offset': 0.15000000000000002, 'culture_modifier': 0.1, 'gold_modifier': 0.1, 'build_speed_modifier': 0.1}
19:06:43 [INFO] __main__: Restored 2 empires from saved state
19:06:43 [INFO] __main__: Starting network server …
19:06:43 [INFO] gameserver.network.handlers: Registered 31 message handlers: summary_request, item_request, military_request, map_load_request, map_save_request, new_item, new_structure, delete_structure, upgrade_structure, citizen_upgrade, change_citizen, increase_life, new_army, new_attack_request, change_army, new_wave, change_wave, end_siege, battle_register, battle_unregister, battle_next_wave_request, notification_request, user_message, timeline_request, userinfo_request, hall_of_fame_request, preferences_request, change_preferences, auth_request, signup, create_empire
19:06:43 [INFO] websockets.server: server listening on 0.0.0.0:8765
19:06:43 [INFO] gameserver.network.server: WebSocket server listening on ws://0.0.0.0:8765
19:06:43 [INFO] __main__:   WebSocket server listening on 0.0.0.0:8765
19:06:43 [INFO] gameserver.debug.dashboard: Debug dashboard running at http://0.0.0.0:9000/
19:06:43 [INFO] __main__: Starting game loop …
19:06:43 [INFO] __main__:   game loop running (1 s tick)
19:06:43 [INFO] websockets.server: connection open
19:06:43 [INFO] gameserver.network.server: Session registered: uid=-1
19:06:43 [INFO] gameserver.network.server: Client connected: uid=-1 remote=('192.168.178.2', 51742)
19:06:43 [INFO] gameserver.network.auth: Login success: eem (uid=2)
19:06:43 [INFO] gameserver.network.server: Session registered: uid=2
19:06:43 [INFO] gameserver.network.server: Session upgraded: guest=-1 → uid=2
19:07:10 [INFO] __main__: Shutdown signal received — stopping …
19:07:10 [INFO] __main__: Shutting down …
19:07:10 [INFO] gameserver.persistence.state_save: Game state saved to state.yaml (2 empires, 0 attacks, 0 battles)
19:07:10 [INFO] websockets.server: server closing
19:07:10 [INFO] gameserver.network.server: Session removed: uid=2
19:07:10 [INFO] websockets.server: server closed
19:07:10 [INFO] gameserver.network.server: WebSocket server stopped
19:07:10 [INFO] __main__:   WebSocket server stopped
19:07:10 [INFO] __main__:   debug dashboard stopped
19:07:10 [INFO] __main__:   database closed
19:07:10 [INFO] __main__:   goodbye
19:07:16 [INFO] __main__: === Game Server starting ===
19:07:16 [INFO] __main__: Loading configuration …
19:07:16 [INFO] __main__:   items:        210 loaded from config
19:07:16 [INFO] __main__:   map:          4 paths, 23 build tiles from config/maps/default.yaml
19:07:16 [INFO] __main__:   ai_templates: 2 entries from config/ai_templates.yaml
19:07:16 [INFO] gameserver.loaders.game_config_loader: Loaded game config from config/game.yaml (29 keys)
19:07:16 [INFO] __main__:   game_config:  loaded
19:07:16 [INFO] __main__: Initializing persistence …
19:07:16 [INFO] gameserver.persistence.database: Database connected: gameserver.db
19:07:16 [INFO] __main__:   database:     connected (gameserver.db)
19:07:16 [INFO] gameserver.persistence.state_load: Restoring state from state.yaml (saved at 2026-02-08T19:07:10, version 1)
19:07:16 [INFO] gameserver.persistence.state_load: Restored 2 empires, 0 attacks, 0 battles
19:07:16 [INFO] __main__:   state:        restored from disk (2 empires, 0 attacks)
19:07:16 [INFO] __main__: Creating services …
19:07:16 [INFO] __main__:   upgrade_provider: 210 items registered
19:07:16 [INFO] __main__:   all services created
19:07:16 [INFO] __main__: Wiring event handlers …
19:07:16 [INFO] __main__:   event handlers registered
19:07:16 [INFO] gameserver.engine.empire_service: Empire registered: uid=100 name='TestImperium'
19:07:16 [INFO] gameserver.engine.empire_service: Empire 100: recalculated effects → {}
19:07:16 [INFO] gameserver.engine.empire_service: Empire registered: uid=2 name='Empire1'
19:07:16 [INFO] gameserver.engine.empire_service: Empire 2: recalculated effects → {'life_offset': 0.001, 'gold_offset': 0.2, 'culture_offset': 0.15000000000000002, 'culture_modifier': 0.1, 'gold_modifier': 0.1, 'build_speed_modifier': 0.1}
19:07:16 [INFO] __main__: Restored 2 empires from saved state
19:07:16 [INFO] __main__: Starting network server …
19:07:16 [INFO] gameserver.network.handlers: Registered 31 message handlers: summary_request, item_request, military_request, map_load_request, map_save_request, new_item, new_structure, delete_structure, upgrade_structure, citizen_upgrade, change_citizen, increase_life, new_army, new_attack_request, change_army, new_wave, change_wave, end_siege, battle_register, battle_unregister, battle_next_wave_request, notification_request, user_message, timeline_request, userinfo_request, hall_of_fame_request, preferences_request, change_preferences, auth_request, signup, create_empire
19:07:16 [INFO] websockets.server: server listening on 0.0.0.0:8765
19:07:16 [INFO] gameserver.network.server: WebSocket server listening on ws://0.0.0.0:8765
19:07:16 [INFO] __main__:   WebSocket server listening on 0.0.0.0:8765
19:07:16 [INFO] gameserver.debug.dashboard: Debug dashboard running at http://0.0.0.0:9000/
19:07:16 [INFO] __main__: Starting game loop …
19:07:16 [INFO] __main__:   game loop running (1 s tick)
19:07:17 [INFO] websockets.server: connection open
19:07:17 [INFO] gameserver.network.server: Session registered: uid=-1
19:07:17 [INFO] gameserver.network.server: Client connected: uid=-1 remote=('192.168.178.2', 51765)
19:07:17 [INFO] gameserver.network.auth: Login success: eem (uid=2)
19:07:17 [INFO] gameserver.network.server: Session registered: uid=2
19:07:17 [INFO] gameserver.network.server: Session upgraded: guest=-1 → uid=2
19:07:17 [INFO] gameserver.network.server: Session removed: uid=2
19:07:17 [INFO] websockets.server: connection open
19:07:17 [INFO] gameserver.network.server: Session registered: uid=-2
19:07:17 [INFO] gameserver.network.server: Client connected: uid=-2 remote=('192.168.178.2', 51772)
19:07:17 [INFO] gameserver.network.auth: Login success: eem (uid=2)
19:07:17 [INFO] gameserver.network.server: Session registered: uid=2
19:07:17 [INFO] gameserver.network.server: Session upgraded: guest=-2 → uid=2
19:07:22 [ERROR] websockets.server: opening handshake failed
Traceback (most recent call last):
  File "/home/pi/e3/.venv/lib/python3.9/site-packages/websockets/http11.py", line 138, in parse
    request_line = yield from parse_line(read_line)
  File "/home/pi/e3/.venv/lib/python3.9/site-packages/websockets/http11.py", line 309, in parse_line
    line = yield from read_line(MAX_LINE_LENGTH)
  File "/home/pi/e3/.venv/lib/python3.9/site-packages/websockets/streams.py", line 46, in read_line
    raise EOFError(f"stream ends after {p} bytes, before end of line")
EOFError: stream ends after 0 bytes, before end of line

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/pi/e3/.venv/lib/python3.9/site-packages/websockets/server.py", line 545, in parse
    request = yield from Request.parse(
  File "/home/pi/e3/.venv/lib/python3.9/site-packages/websockets/http11.py", line 140, in parse
    raise EOFError("connection closed while reading HTTP request line") from exc
EOFError: connection closed while reading HTTP request line

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/pi/e3/.venv/lib/python3.9/site-packages/websockets/asyncio/server.py", line 356, in conn_handler
    await connection.handshake(
  File "/home/pi/e3/.venv/lib/python3.9/site-packages/websockets/asyncio/server.py", line 207, in handshake
    raise self.protocol.handshake_exc
websockets.exceptions.InvalidMessage: did not receive a valid HTTP request
19:11:35 [INFO] gameserver.network.server: Session removed: uid=2
19:11:35 [INFO] websockets.server: connection open
19:11:35 [INFO] gameserver.network.server: Session registered: uid=-3
19:11:35 [INFO] gameserver.network.server: Client connected: uid=-3 remote=('192.168.178.2', 60175)
19:11:35 [INFO] gameserver.network.auth: Login success: eem (uid=2)
19:11:35 [INFO] gameserver.network.server: Session registered: uid=2
19:11:35 [INFO] gameserver.network.server: Session upgraded: guest=-3 → uid=2
19:11:43 [INFO] __main__: Shutdown signal received — stopping …
19:11:44 [INFO] __main__: Shutting down …
19:11:44 [INFO] gameserver.persistence.state_save: Game state saved to state.yaml (2 empires, 0 attacks, 0 battles)
19:11:44 [INFO] websockets.server: server closing
19:11:44 [INFO] gameserver.network.server: Session removed: uid=2
19:11:44 [INFO] websockets.server: server closed
19:11:44 [INFO] gameserver.network.server: WebSocket server stopped
19:11:44 [INFO] __main__:   WebSocket server stopped
19:11:44 [INFO] __main__:   debug dashboard stopped
19:11:44 [INFO] __main__:   database closed
19:11:44 [INFO] __main__:   goodbye
19:11:51 [INFO] __main__: === Game Server starting ===
19:11:51 [INFO] __main__: Loading configuration …
19:11:52 [INFO] __main__:   items:        210 loaded from config
19:11:52 [INFO] __main__:   map:          4 paths, 23 build tiles from config/maps/default.yaml
19:11:52 [INFO] __main__:   ai_templates: 2 entries from config/ai_templates.yaml
19:11:52 [INFO] gameserver.loaders.game_config_loader: Loaded game config from config/game.yaml (29 keys)
19:11:52 [INFO] __main__:   game_config:  loaded
19:11:52 [INFO] __main__: Initializing persistence …
19:11:52 [INFO] gameserver.persistence.database: Database connected: gameserver.db
19:11:52 [INFO] __main__:   database:     connected (gameserver.db)
19:11:52 [INFO] gameserver.persistence.state_load: Restoring state from state.yaml (saved at 2026-02-08T19:11:44, version 1)
19:11:52 [INFO] gameserver.persistence.state_load: Restored 2 empires, 0 attacks, 0 battles
19:11:52 [INFO] __main__:   state:        restored from disk (2 empires, 0 attacks)
19:11:52 [INFO] __main__: Creating services …
19:11:52 [INFO] __main__:   upgrade_provider: 210 items registered
19:11:52 [INFO] __main__:   all services created
19:11:52 [INFO] __main__: Wiring event handlers …
19:11:52 [INFO] __main__:   event handlers registered
19:11:52 [INFO] gameserver.engine.empire_service: Empire registered: uid=100 name='TestImperium'
19:11:52 [INFO] gameserver.engine.empire_service: Empire 100: recalculated effects → {}
19:11:52 [INFO] gameserver.engine.empire_service: Empire registered: uid=2 name='Empire1'
19:11:52 [INFO] gameserver.engine.empire_service: Empire 2: recalculated effects → {'life_offset': 0.001, 'gold_offset': 0.2, 'culture_offset': 0.15000000000000002, 'culture_modifier': 0.1, 'gold_modifier': 0.1, 'build_speed_modifier': 0.1}
19:11:52 [INFO] __main__: Restored 2 empires from saved state
19:11:52 [INFO] __main__: Starting network server …
19:11:52 [INFO] gameserver.network.handlers: Registered 31 message handlers: summary_request, item_request, military_request, map_load_request, map_save_request, new_item, new_structure, delete_structure, upgrade_structure, citizen_upgrade, change_citizen, increase_life, new_army, new_attack_request, change_army, new_wave, change_wave, end_siege, battle_register, battle_unregister, battle_next_wave_request, notification_request, user_message, timeline_request, userinfo_request, hall_of_fame_request, preferences_request, change_preferences, auth_request, signup, create_empire
19:11:52 [INFO] websockets.server: server listening on 0.0.0.0:8765
19:11:52 [INFO] gameserver.network.server: WebSocket server listening on ws://0.0.0.0:8765
19:11:52 [INFO] __main__:   WebSocket server listening on 0.0.0.0:8765
19:11:52 [INFO] gameserver.debug.dashboard: Debug dashboard running at http://0.0.0.0:9000/
19:11:52 [INFO] __main__: Starting game loop …
19:11:52 [INFO] __main__:   game loop running (1 s tick)
19:11:52 [INFO] websockets.server: connection open
19:11:52 [INFO] gameserver.network.server: Session registered: uid=-1
19:11:52 [INFO] gameserver.network.server: Client connected: uid=-1 remote=('192.168.178.2', 57816)
19:11:52 [INFO] gameserver.network.auth: Login success: eem (uid=2)
19:11:52 [INFO] gameserver.network.server: Session registered: uid=2
19:11:52 [INFO] gameserver.network.server: Session upgraded: guest=-1 → uid=2
19:11:54 [INFO] gameserver.network.server: Session removed: uid=2
19:11:54 [INFO] websockets.server: connection open
19:11:54 [INFO] gameserver.network.server: Session registered: uid=-2
19:11:54 [INFO] gameserver.network.server: Client connected: uid=-2 remote=('192.168.178.2', 57820)
19:11:54 [INFO] gameserver.network.auth: Login success: eem (uid=2)
19:11:54 [INFO] gameserver.network.server: Session registered: uid=2
19:11:54 [INFO] gameserver.network.server: Session upgraded: guest=-2 → uid=2
19:11:56 [INFO] gameserver.network.handlers: Map saved for empire Empire1 (uid=2): 3 tiles
19:11:58 [ERROR] websockets.server: opening handshake failed
Traceback (most recent call last):
  File "/home/pi/e3/.venv/lib/python3.9/site-packages/websockets/http11.py", line 138, in parse
    request_line = yield from parse_line(read_line)
  File "/home/pi/e3/.venv/lib/python3.9/site-packages/websockets/http11.py", line 309, in parse_line
    line = yield from read_line(MAX_LINE_LENGTH)
  File "/home/pi/e3/.venv/lib/python3.9/site-packages/websockets/streams.py", line 46, in read_line
    raise EOFError(f"stream ends after {p} bytes, before end of line")
EOFError: stream ends after 0 bytes, before end of line

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/pi/e3/.venv/lib/python3.9/site-packages/websockets/server.py", line 545, in parse
    request = yield from Request.parse(
  File "/home/pi/e3/.venv/lib/python3.9/site-packages/websockets/http11.py", line 140, in parse
    raise EOFError("connection closed while reading HTTP request line") from exc
EOFError: connection closed while reading HTTP request line

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/pi/e3/.venv/lib/python3.9/site-packages/websockets/asyncio/server.py", line 356, in conn_handler
    await connection.handshake(
  File "/home/pi/e3/.venv/lib/python3.9/site-packages/websockets/asyncio/server.py", line 207, in handshake
    raise self.protocol.handshake_exc
websockets.exceptions.InvalidMessage: did not receive a valid HTTP request
19:11:58 [INFO] __main__: Shutdown signal received — stopping …
19:11:59 [INFO] __main__: Shutting down …
19:11:59 [INFO] gameserver.persistence.state_save: Game state saved to state.yaml (2 empires, 0 attacks, 0 battles)
19:11:59 [INFO] websockets.server: server closing
19:11:59 [INFO] gameserver.network.server: Client disconnected: uid=-2 code=1001
19:11:59 [INFO] gameserver.network.server: Session removed: uid=2
19:11:59 [INFO] websockets.server: server closed
19:11:59 [INFO] gameserver.network.server: WebSocket server stopped
19:11:59 [INFO] __main__:   WebSocket server stopped
19:11:59 [INFO] __main__:   debug dashboard stopped
19:11:59 [INFO] __main__:   database closed
19:11:59 [INFO] __main__:   goodbye
19:12:04 [INFO] __main__: === Game Server starting ===
19:12:04 [INFO] __main__: Loading configuration …
19:12:05 [INFO] __main__:   items:        210 loaded from config
19:12:05 [INFO] __main__:   map:          4 paths, 23 build tiles from config/maps/default.yaml
19:12:05 [INFO] __main__:   ai_templates: 2 entries from config/ai_templates.yaml
19:12:05 [INFO] gameserver.loaders.game_config_loader: Loaded game config from config/game.yaml (29 keys)
19:12:05 [INFO] __main__:   game_config:  loaded
19:12:05 [INFO] __main__: Initializing persistence …
19:12:05 [INFO] gameserver.persistence.database: Database connected: gameserver.db
19:12:05 [INFO] __main__:   database:     connected (gameserver.db)
19:12:05 [INFO] gameserver.persistence.state_load: Restoring state from state.yaml (saved at 2026-02-08T19:11:59, version 1)
19:12:05 [INFO] gameserver.persistence.state_load: Restored 2 empires, 0 attacks, 0 battles
19:12:05 [INFO] __main__:   state:        restored from disk (2 empires, 0 attacks)
19:12:05 [INFO] __main__: Creating services …
19:12:05 [INFO] __main__:   upgrade_provider: 210 items registered
19:12:05 [INFO] __main__:   all services created
19:12:05 [INFO] __main__: Wiring event handlers …
19:12:05 [INFO] __main__:   event handlers registered
19:12:05 [INFO] gameserver.engine.empire_service: Empire registered: uid=100 name='TestImperium'
19:12:05 [INFO] gameserver.engine.empire_service: Empire 100: recalculated effects → {}
19:12:05 [INFO] gameserver.engine.empire_service: Empire registered: uid=2 name='Empire1'
19:12:05 [INFO] gameserver.engine.empire_service: Empire 2: recalculated effects → {'life_offset': 0.001, 'gold_offset': 0.2, 'culture_offset': 0.15000000000000002, 'culture_modifier': 0.1, 'gold_modifier': 0.1, 'build_speed_modifier': 0.1}
19:12:05 [INFO] __main__: Restored 2 empires from saved state
19:12:05 [INFO] __main__: Starting network server …
19:12:05 [INFO] gameserver.network.handlers: Registered 31 message handlers: summary_request, item_request, military_request, map_load_request, map_save_request, new_item, new_structure, delete_structure, upgrade_structure, citizen_upgrade, change_citizen, increase_life, new_army, new_attack_request, change_army, new_wave, change_wave, end_siege, battle_register, battle_unregister, battle_next_wave_request, notification_request, user_message, timeline_request, userinfo_request, hall_of_fame_request, preferences_request, change_preferences, auth_request, signup, create_empire
19:12:05 [INFO] websockets.server: server listening on 0.0.0.0:8765
19:12:05 [INFO] gameserver.network.server: WebSocket server listening on ws://0.0.0.0:8765
19:12:05 [INFO] __main__:   WebSocket server listening on 0.0.0.0:8765
19:12:05 [INFO] gameserver.debug.dashboard: Debug dashboard running at http://0.0.0.0:9000/
19:12:05 [INFO] __main__: Starting game loop …
19:12:05 [INFO] __main__:   game loop running (1 s tick)
19:12:07 [INFO] websockets.server: connection open
19:12:07 [INFO] gameserver.network.server: Session registered: uid=-1
19:12:07 [INFO] gameserver.network.server: Client connected: uid=-1 remote=('192.168.178.2', 57830)
19:12:07 [INFO] gameserver.network.auth: Login success: eem (uid=2)
19:12:07 [INFO] gameserver.network.server: Session registered: uid=2
19:12:07 [INFO] gameserver.network.server: Session upgraded: guest=-1 → uid=2
19:12:08 [INFO] gameserver.network.server: Session removed: uid=2
19:12:08 [INFO] websockets.server: connection open
19:12:08 [INFO] gameserver.network.server: Session registered: uid=-2
19:12:08 [INFO] gameserver.network.server: Client connected: uid=-2 remote=('192.168.178.2', 57834)
19:12:08 [INFO] gameserver.network.auth: Login success: eem (uid=2)
19:12:08 [INFO] gameserver.network.server: Session registered: uid=2
19:12:08 [INFO] gameserver.network.server: Session upgraded: guest=-2 → uid=2
19:12:12 [INFO] gameserver.network.handlers: Map saved for empire Empire1 (uid=2): 3 tiles
19:12:18 [INFO] gameserver.network.handlers: Map saved for empire Empire1 (uid=2): 3 tiles
19:12:21 [INFO] gameserver.network.handlers: Map saved for empire Empire1 (uid=2): 3 tiles
19:12:21 [INFO] gameserver.network.handlers: Map saved for empire Empire1 (uid=2): 3 tiles
19:12:25 [INFO] __main__: Shutdown signal received — stopping …
19:12:25 [INFO] __main__: Shutting down …
19:12:25 [INFO] gameserver.persistence.state_save: Game state saved to state.yaml (2 empires, 0 attacks, 0 battles)
19:12:25 [INFO] websockets.server: server closing
19:12:25 [INFO] gameserver.network.server: Session removed: uid=2
19:12:25 [INFO] websockets.server: server closed
19:12:25 [INFO] gameserver.network.server: WebSocket server stopped
19:12:25 [INFO] __main__:   WebSocket server stopped
19:12:25 [INFO] __main__:   debug dashboard stopped
19:12:25 [INFO] __main__:   database closed
19:12:25 [INFO] __main__:   goodbye
19:12:27 [INFO] __main__: === Game Server starting ===
19:12:27 [INFO] __main__: Loading configuration …
19:12:27 [INFO] __main__:   items:        210 loaded from config
19:12:28 [INFO] __main__:   map:          4 paths, 23 build tiles from config/maps/default.yaml
19:12:28 [INFO] __main__:   ai_templates: 2 entries from config/ai_templates.yaml
19:12:28 [INFO] gameserver.loaders.game_config_loader: Loaded game config from config/game.yaml (29 keys)
19:12:28 [INFO] __main__:   game_config:  loaded
19:12:28 [INFO] __main__: Initializing persistence …
19:12:28 [INFO] gameserver.persistence.database: Database connected: gameserver.db
19:12:28 [INFO] __main__:   database:     connected (gameserver.db)
19:12:28 [INFO] gameserver.persistence.state_load: Restoring state from state.yaml (saved at 2026-02-08T19:12:25, version 1)
19:12:28 [INFO] gameserver.persistence.state_load: Restored 2 empires, 0 attacks, 0 battles
19:12:28 [INFO] __main__:   state:        restored from disk (2 empires, 0 attacks)
19:12:28 [INFO] __main__: Creating services …
19:12:28 [INFO] __main__:   upgrade_provider: 210 items registered
19:12:28 [INFO] __main__:   all services created
19:12:28 [INFO] __main__: Wiring event handlers …
19:12:28 [INFO] __main__:   event handlers registered
19:12:28 [INFO] gameserver.engine.empire_service: Empire registered: uid=100 name='TestImperium'
19:12:28 [INFO] gameserver.engine.empire_service: Empire 100: recalculated effects → {}
19:12:28 [INFO] gameserver.engine.empire_service: Empire registered: uid=2 name='Empire1'
19:12:28 [INFO] gameserver.engine.empire_service: Empire 2: recalculated effects → {'life_offset': 0.001, 'gold_offset': 0.2, 'culture_offset': 0.15000000000000002, 'culture_modifier': 0.1, 'gold_modifier': 0.1, 'build_speed_modifier': 0.1}
19:12:28 [INFO] __main__: Restored 2 empires from saved state
19:12:28 [INFO] __main__: Starting network server …
19:12:28 [INFO] gameserver.network.handlers: Registered 31 message handlers: summary_request, item_request, military_request, map_load_request, map_save_request, new_item, new_structure, delete_structure, upgrade_structure, citizen_upgrade, change_citizen, increase_life, new_army, new_attack_request, change_army, new_wave, change_wave, end_siege, battle_register, battle_unregister, battle_next_wave_request, notification_request, user_message, timeline_request, userinfo_request, hall_of_fame_request, preferences_request, change_preferences, auth_request, signup, create_empire
19:12:28 [INFO] websockets.server: server listening on 0.0.0.0:8765
19:12:28 [INFO] gameserver.network.server: WebSocket server listening on ws://0.0.0.0:8765
19:12:28 [INFO] __main__:   WebSocket server listening on 0.0.0.0:8765
19:12:28 [INFO] gameserver.debug.dashboard: Debug dashboard running at http://0.0.0.0:9000/
19:12:28 [INFO] __main__: Starting game loop …
19:12:28 [INFO] __main__:   game loop running (1 s tick)
19:12:28 [INFO] websockets.server: connection open
19:12:28 [INFO] gameserver.network.server: Session registered: uid=-1
19:12:28 [INFO] gameserver.network.server: Client connected: uid=-1 remote=('192.168.178.2', 57840)
19:12:28 [INFO] gameserver.network.auth: Login success: eem (uid=2)
19:12:28 [INFO] gameserver.network.server: Session registered: uid=2
19:12:28 [INFO] gameserver.network.server: Session upgraded: guest=-1 → uid=2
19:12:29 [INFO] gameserver.network.server: Session removed: uid=2
19:12:29 [INFO] websockets.server: connection open
19:12:29 [INFO] gameserver.network.server: Session registered: uid=-2
19:12:29 [INFO] gameserver.network.server: Client connected: uid=-2 remote=('192.168.178.2', 57845)
19:12:29 [INFO] gameserver.network.auth: Login success: eem (uid=2)
19:12:29 [INFO] gameserver.network.server: Session registered: uid=2
19:12:29 [INFO] gameserver.network.server: Session upgraded: guest=-2 → uid=2
19:13:00 [INFO] gameserver.network.handlers: Map saved for empire Empire1 (uid=2): 3 tiles
19:13:10 [INFO] gameserver.network.handlers: Map saved for empire Empire1 (uid=2): 3 tiles
19:14:25 [INFO] gameserver.network.server: Session removed: uid=2
19:14:25 [INFO] websockets.server: connection open
19:14:25 [INFO] gameserver.network.server: Session registered: uid=-3
19:14:25 [INFO] gameserver.network.server: Client connected: uid=-3 remote=('192.168.178.2', 63257)
19:14:25 [INFO] gameserver.network.auth: Login success: eem (uid=2)
19:14:25 [INFO] gameserver.network.server: Session registered: uid=2
19:14:25 [INFO] gameserver.network.server: Session upgraded: guest=-3 → uid=2
19:14:35 [INFO] gameserver.network.handlers: Map saved for empire Empire1 (uid=2): 3 tiles
19:14:39 [INFO] gameserver.network.handlers: Map saved for empire Empire1 (uid=2): 3 tiles
19:14:39 [INFO] gameserver.network.handlers: Map saved for empire Empire1 (uid=2): 3 tiles
19:16:27 [INFO] gameserver.network.server: Session removed: uid=2
19:16:27 [INFO] websockets.server: connection open
19:16:27 [INFO] gameserver.network.server: Session registered: uid=-4
19:16:27 [INFO] gameserver.network.server: Client connected: uid=-4 remote=('192.168.178.2', 51762)
19:16:27 [INFO] gameserver.network.auth: Login success: eem (uid=2)
19:16:27 [INFO] gameserver.network.server: Session registered: uid=2
19:16:27 [INFO] gameserver.network.server: Session upgraded: guest=-4 → uid=2
19:18:24 [INFO] gameserver.network.server: Session removed: uid=2
19:18:24 [INFO] websockets.server: connection open
19:18:24 [INFO] gameserver.network.server: Session registered: uid=-5
19:18:24 [INFO] gameserver.network.server: Client connected: uid=-5 remote=('192.168.178.2', 60595)
19:18:24 [INFO] gameserver.network.auth: Login success: eem (uid=2)
19:18:24 [INFO] gameserver.network.server: Session registered: uid=2
19:18:24 [INFO] gameserver.network.server: Session upgraded: guest=-5 → uid=2
19:18:35 [INFO] gameserver.network.handlers: Map saved for empire Empire1 (uid=2): 4 tiles
19:39:45 [INFO] gameserver.network.server: Session removed: uid=2
19:39:45 [INFO] websockets.server: connection open
19:39:45 [INFO] gameserver.network.server: Session registered: uid=-6
19:39:45 [INFO] gameserver.network.server: Client connected: uid=-6 remote=('192.168.178.2', 58684)
19:39:45 [INFO] gameserver.network.auth: Login success: eem (uid=2)
19:39:45 [INFO] gameserver.network.server: Session registered: uid=2
19:39:45 [INFO] gameserver.network.server: Session upgraded: guest=-6 → uid=2
19:39:48 [INFO] __main__: Shutdown signal received — stopping …
19:39:49 [INFO] __main__: Shutting down …
19:39:49 [INFO] gameserver.persistence.state_save: Game state saved to state.yaml (2 empires, 0 attacks, 0 battles)
19:39:49 [INFO] websockets.server: server closing
19:39:49 [INFO] gameserver.network.server: Session removed: uid=2
19:39:49 [INFO] websockets.server: server closed
19:39:49 [INFO] gameserver.network.server: WebSocket server stopped
19:39:49 [INFO] __main__:   WebSocket server stopped
19:39:49 [INFO] __main__:   debug dashboard stopped
19:39:49 [INFO] __main__:   database closed
19:39:49 [INFO] __main__:   goodbye
19:39:50 [INFO] __main__: === Game Server starting ===
19:39:50 [INFO] __main__: Loading configuration …
19:39:51 [INFO] __main__:   items:        210 loaded from config
19:39:51 [INFO] __main__:   map:          4 paths, 23 build tiles from config/maps/default.yaml
19:39:51 [INFO] __main__:   ai_templates: 2 entries from config/ai_templates.yaml
19:39:51 [INFO] gameserver.loaders.game_config_loader: Loaded game config from config/game.yaml (29 keys)
19:39:51 [INFO] __main__:   game_config:  loaded
19:39:51 [INFO] __main__: Initializing persistence …
19:39:51 [INFO] gameserver.persistence.database: Database connected: gameserver.db
19:39:51 [INFO] __main__:   database:     connected (gameserver.db)
19:39:51 [INFO] gameserver.persistence.state_load: Restoring state from state.yaml (saved at 2026-02-08T19:39:49, version 1)
19:39:51 [INFO] gameserver.persistence.state_load: Restored 2 empires, 0 attacks, 0 battles
19:39:51 [INFO] __main__:   state:        restored from disk (2 empires, 0 attacks)
19:39:51 [INFO] __main__: Creating services …
19:39:51 [INFO] __main__:   upgrade_provider: 210 items registered
19:39:51 [INFO] __main__:   all services created
19:39:51 [INFO] __main__: Wiring event handlers …
19:39:51 [INFO] __main__:   event handlers registered
19:39:51 [INFO] gameserver.engine.empire_service: Empire registered: uid=100 name='TestImperium'
19:39:51 [INFO] gameserver.engine.empire_service: Empire 100: recalculated effects → {}
19:39:51 [INFO] gameserver.engine.empire_service: Empire registered: uid=2 name='Empire1'
19:39:51 [INFO] gameserver.engine.empire_service: Empire 2: recalculated effects → {'life_offset': 0.001, 'gold_offset': 0.2, 'culture_offset': 0.15000000000000002, 'culture_modifier': 0.1, 'gold_modifier': 0.1, 'build_speed_modifier': 0.1}
19:39:51 [INFO] __main__: Restored 2 empires from saved state
19:39:51 [INFO] __main__: Starting network server …
19:39:51 [INFO] gameserver.network.handlers: Registered 31 message handlers: summary_request, item_request, military_request, map_load_request, map_save_request, new_item, new_structure, delete_structure, upgrade_structure, citizen_upgrade, change_citizen, increase_life, new_army, new_attack_request, change_army, new_wave, change_wave, end_siege, battle_register, battle_unregister, battle_next_wave_request, notification_request, user_message, timeline_request, userinfo_request, hall_of_fame_request, preferences_request, change_preferences, auth_request, signup, create_empire
19:39:51 [INFO] websockets.server: server listening on 0.0.0.0:8765
19:39:51 [INFO] gameserver.network.server: WebSocket server listening on ws://0.0.0.0:8765
19:39:51 [INFO] __main__:   WebSocket server listening on 0.0.0.0:8765
19:39:51 [INFO] gameserver.debug.dashboard: Debug dashboard running at http://0.0.0.0:9000/
19:39:51 [INFO] __main__: Starting game loop …
19:39:51 [INFO] __main__:   game loop running (1 s tick)
19:39:51 [INFO] websockets.server: connection open
19:39:51 [INFO] gameserver.network.server: Session registered: uid=-1
19:39:51 [INFO] gameserver.network.server: Client connected: uid=-1 remote=('192.168.178.2', 58689)
19:39:51 [INFO] gameserver.network.auth: Login success: eem (uid=2)
19:39:51 [INFO] gameserver.network.server: Session registered: uid=2
19:39:51 [INFO] gameserver.network.server: Session upgraded: guest=-1 → uid=2
19:39:58 [WARNING] gameserver.network.handlers: Map validation failed for Empire1 (uid=2): Map must contain exactly 1 castle (found 0)
19:39:58 [WARNING] gameserver.network.handlers: Map validation failed for Empire1 (uid=2): Map must contain exactly 1 castle (found 0)
19:40:47 [INFO] gameserver.network.handlers: Map saved for empire Empire1 (uid=2): 4 tiles
19:40:47 [INFO] gameserver.network.handlers: Map saved for empire Empire1 (uid=2): 4 tiles
19:40:57 [WARNING] gameserver.network.handlers: Map validation failed for Empire1 (uid=2): Map must contain exactly 1 castle (found 0)
19:41:00 [WARNING] gameserver.network.handlers: Map validation failed for Empire1 (uid=2): Map must contain exactly 1 castle (found 0)
19:41:00 [WARNING] gameserver.network.handlers: Map validation failed for Empire1 (uid=2): Map must contain exactly 1 castle (found 0)
19:41:46 [WARNING] gameserver.network.handlers: Map validation failed for Empire1 (uid=2): Map must contain exactly 1 castle (found 0)
19:41:47 [WARNING] gameserver.network.handlers: Map validation failed for Empire1 (uid=2): Map must contain exactly 1 castle (found 0)
19:41:47 [WARNING] gameserver.network.handlers: Map validation failed for Empire1 (uid=2): Map must contain exactly 1 castle (found 0)
19:41:47 [WARNING] gameserver.network.handlers: Map validation failed for Empire1 (uid=2): Map must contain exactly 1 castle (found 0)
19:41:49 [INFO] gameserver.network.server: Session removed: uid=2
19:41:49 [INFO] websockets.server: connection open
19:41:49 [INFO] gameserver.network.server: Session registered: uid=-2
19:41:49 [INFO] gameserver.network.server: Client connected: uid=-2 remote=('192.168.178.2', 52277)
19:41:49 [INFO] gameserver.network.auth: Login success: eem (uid=2)
19:41:49 [INFO] gameserver.network.server: Session registered: uid=2
19:41:49 [INFO] gameserver.network.server: Session upgraded: guest=-2 → uid=2
19:41:51 [INFO] gameserver.network.server: Session removed: uid=2
19:41:51 [INFO] websockets.server: connection open
19:41:51 [INFO] gameserver.network.server: Session registered: uid=-3
19:41:51 [INFO] gameserver.network.server: Client connected: uid=-3 remote=('192.168.178.2', 52280)
19:41:51 [INFO] gameserver.network.auth: Login success: eem (uid=2)
19:41:51 [INFO] gameserver.network.server: Session registered: uid=2
19:41:51 [INFO] gameserver.network.server: Session upgraded: guest=-3 → uid=2
19:41:54 [WARNING] gameserver.network.handlers: Map validation failed for Empire1 (uid=2): Map must contain exactly 1 castle (found 0)
19:41:56 [INFO] gameserver.network.handlers: Map saved for empire Empire1 (uid=2): 4 tiles
19:41:56 [INFO] gameserver.network.handlers: Map saved for empire Empire1 (uid=2): 4 tiles
19:42:00 [INFO] gameserver.network.server: Session removed: uid=2
19:42:00 [INFO] websockets.server: connection open
19:42:00 [INFO] gameserver.network.server: Session registered: uid=-4
19:42:00 [INFO] gameserver.network.server: Client connected: uid=-4 remote=('192.168.178.2', 52287)
19:42:00 [INFO] gameserver.network.auth: Login success: eem (uid=2)
19:42:00 [INFO] gameserver.network.server: Session registered: uid=2
19:42:00 [INFO] gameserver.network.server: Session upgraded: guest=-4 → uid=2
19:42:01 [INFO] gameserver.network.server: Session removed: uid=2
19:42:01 [INFO] websockets.server: connection open
19:42:01 [INFO] gameserver.network.server: Session registered: uid=-5
19:42:01 [INFO] gameserver.network.server: Client connected: uid=-5 remote=('192.168.178.2', 52311)
19:42:01 [INFO] gameserver.network.auth: Login success: eem (uid=2)
19:42:01 [INFO] gameserver.network.server: Session registered: uid=2
19:42:01 [INFO] gameserver.network.server: Session upgraded: guest=-5 → uid=2
19:42:09 [WARNING] gameserver.network.handlers: Map validation failed for Empire1 (uid=2): Map must contain exactly 1 castle (found 0)
19:42:10 [WARNING] gameserver.network.handlers: Map validation failed for Empire1 (uid=2): Map must contain exactly 1 castle (found 0)
19:42:16 [INFO] gameserver.network.handlers: Map saved for empire Empire1 (uid=2): 4 tiles
19:42:16 [INFO] gameserver.network.handlers: Map saved for empire Empire1 (uid=2): 4 tiles
19:44:02 [INFO] __main__: Shutdown signal received — stopping …
19:44:02 [INFO] __main__: Shutting down …
19:44:02 [INFO] gameserver.persistence.state_save: Game state saved to state.yaml (2 empires, 0 attacks, 0 battles)
19:44:02 [INFO] websockets.server: server closing
19:44:02 [INFO] gameserver.network.server: Session removed: uid=2
19:44:02 [INFO] websockets.server: server closed
19:44:02 [INFO] gameserver.network.server: WebSocket server stopped
19:44:02 [INFO] __main__:   WebSocket server stopped
19:44:02 [INFO] __main__:   debug dashboard stopped
19:44:02 [INFO] __main__:   database closed
19:44:02 [INFO] __main__:   goodbye
19:44:12 [INFO] __main__: === Game Server starting ===
19:44:12 [INFO] __main__: Loading configuration …
19:44:12 [INFO] __main__:   items:        210 loaded from config
19:44:12 [INFO] __main__:   map:          4 paths, 23 build tiles from config/maps/default.yaml
19:44:12 [INFO] __main__:   ai_templates: 2 entries from config/ai_templates.yaml
19:44:12 [INFO] gameserver.loaders.game_config_loader: Loaded game config from config/game.yaml (29 keys)
19:44:12 [INFO] __main__:   game_config:  loaded
19:44:12 [INFO] __main__: Initializing persistence …
19:44:12 [INFO] gameserver.persistence.database: Database connected: gameserver.db
19:44:12 [INFO] __main__:   database:     connected (gameserver.db)
19:44:13 [INFO] gameserver.persistence.state_load: Restoring state from state.yaml (saved at 2026-02-08T19:44:02, version 1)
19:44:13 [INFO] gameserver.persistence.state_load: Restored 2 empires, 0 attacks, 0 battles
19:44:13 [INFO] __main__:   state:        restored from disk (2 empires, 0 attacks)
19:44:13 [INFO] __main__: Creating services …
19:44:13 [INFO] __main__:   upgrade_provider: 210 items registered
19:44:13 [INFO] __main__:   all services created
19:44:13 [INFO] __main__: Wiring event handlers …
19:44:13 [INFO] __main__:   event handlers registered
19:44:13 [INFO] gameserver.engine.empire_service: Empire registered: uid=100 name='TestImperium'
19:44:13 [INFO] gameserver.engine.empire_service: Empire 100: recalculated effects → {}
19:44:13 [INFO] gameserver.engine.empire_service: Empire registered: uid=2 name='Empire1'
19:44:13 [INFO] gameserver.engine.empire_service: Empire 2: recalculated effects → {'life_offset': 0.001, 'gold_offset': 0.2, 'culture_offset': 0.15000000000000002, 'culture_modifier': 0.1, 'gold_modifier': 0.1, 'build_speed_modifier': 0.1}
19:44:13 [INFO] __main__: Restored 2 empires from saved state
19:44:13 [INFO] __main__: Starting network server …
19:44:13 [INFO] gameserver.network.handlers: Registered 31 message handlers: summary_request, item_request, military_request, map_load_request, map_save_request, new_item, new_structure, delete_structure, upgrade_structure, citizen_upgrade, change_citizen, increase_life, new_army, new_attack_request, change_army, new_wave, change_wave, end_siege, battle_register, battle_unregister, battle_next_wave_request, notification_request, user_message, timeline_request, userinfo_request, hall_of_fame_request, preferences_request, change_preferences, auth_request, signup, create_empire
19:44:13 [INFO] websockets.server: server listening on 0.0.0.0:8765
19:44:13 [INFO] gameserver.network.server: WebSocket server listening on ws://0.0.0.0:8765
19:44:13 [INFO] __main__:   WebSocket server listening on 0.0.0.0:8765
19:44:13 [INFO] gameserver.debug.dashboard: Debug dashboard running at http://0.0.0.0:9000/
19:44:13 [INFO] __main__: Starting game loop …
19:44:13 [INFO] __main__:   game loop running (1 s tick)
19:44:14 [INFO] websockets.server: connection open
19:44:14 [INFO] gameserver.network.server: Session registered: uid=-1
19:44:14 [INFO] gameserver.network.server: Client connected: uid=-1 remote=('192.168.178.2', 55077)
19:44:14 [INFO] gameserver.network.auth: Login success: eem (uid=2)
19:44:14 [INFO] gameserver.network.server: Session registered: uid=2
19:44:14 [INFO] gameserver.network.server: Session upgraded: guest=-1 → uid=2
19:44:18 [ERROR] websockets.server: opening handshake failed
Traceback (most recent call last):
  File "/home/pi/e3/.venv/lib/python3.9/site-packages/websockets/http11.py", line 138, in parse
    request_line = yield from parse_line(read_line)
  File "/home/pi/e3/.venv/lib/python3.9/site-packages/websockets/http11.py", line 309, in parse_line
    line = yield from read_line(MAX_LINE_LENGTH)
  File "/home/pi/e3/.venv/lib/python3.9/site-packages/websockets/streams.py", line 46, in read_line
    raise EOFError(f"stream ends after {p} bytes, before end of line")
EOFError: stream ends after 0 bytes, before end of line

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/pi/e3/.venv/lib/python3.9/site-packages/websockets/server.py", line 545, in parse
    request = yield from Request.parse(
  File "/home/pi/e3/.venv/lib/python3.9/site-packages/websockets/http11.py", line 140, in parse
    raise EOFError("connection closed while reading HTTP request line") from exc
EOFError: connection closed while reading HTTP request line

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/pi/e3/.venv/lib/python3.9/site-packages/websockets/asyncio/server.py", line 356, in conn_handler
    await connection.handshake(
  File "/home/pi/e3/.venv/lib/python3.9/site-packages/websockets/asyncio/server.py", line 207, in handshake
    raise self.protocol.handshake_exc
websockets.exceptions.InvalidMessage: did not receive a valid HTTP request
19:46:10 [INFO] gameserver.network.server: Session removed: uid=2
19:46:10 [INFO] websockets.server: connection open
19:46:10 [INFO] gameserver.network.server: Session registered: uid=-2
19:46:10 [INFO] gameserver.network.server: Client connected: uid=-2 remote=('192.168.178.2', 51773)
19:46:10 [INFO] gameserver.network.auth: Login success: eem (uid=2)
19:46:10 [INFO] gameserver.network.server: Session registered: uid=2
19:46:10 [INFO] gameserver.network.server: Session upgraded: guest=-2 → uid=2
19:46:13 [INFO] gameserver.network.handlers: Map saved for empire Empire1 (uid=2): 4 tiles
19:46:19 [INFO] __main__: Shutdown signal received — stopping …
19:46:20 [INFO] __main__: Shutting down …
19:46:20 [INFO] gameserver.persistence.state_save: Game state saved to state.yaml (2 empires, 0 attacks, 0 battles)
19:46:20 [INFO] websockets.server: server closing
19:46:20 [INFO] gameserver.network.server: Session removed: uid=2
19:46:20 [INFO] websockets.server: server closed
19:46:20 [INFO] gameserver.network.server: WebSocket server stopped
19:46:20 [INFO] __main__:   WebSocket server stopped
19:46:20 [INFO] __main__:   debug dashboard stopped
19:46:20 [INFO] __main__:   database closed
19:46:20 [INFO] __main__:   goodbye
19:46:21 [INFO] __main__: === Game Server starting ===
19:46:21 [INFO] __main__: Loading configuration …
19:46:22 [INFO] __main__:   items:        210 loaded from config
19:46:22 [INFO] __main__:   map:          4 paths, 23 build tiles from config/maps/default.yaml
19:46:22 [INFO] __main__:   ai_templates: 2 entries from config/ai_templates.yaml
19:46:22 [INFO] gameserver.loaders.game_config_loader: Loaded game config from config/game.yaml (29 keys)
19:46:22 [INFO] __main__:   game_config:  loaded
19:46:22 [INFO] __main__: Initializing persistence …
19:46:22 [INFO] gameserver.persistence.database: Database connected: gameserver.db
19:46:22 [INFO] __main__:   database:     connected (gameserver.db)
19:46:22 [INFO] gameserver.persistence.state_load: Restoring state from state.yaml (saved at 2026-02-08T19:46:20, version 1)
19:46:22 [INFO] gameserver.persistence.state_load: Restored 2 empires, 0 attacks, 0 battles
19:46:22 [INFO] __main__:   state:        restored from disk (2 empires, 0 attacks)
19:46:22 [INFO] __main__: Creating services …
19:46:22 [INFO] __main__:   upgrade_provider: 210 items registered
19:46:22 [INFO] __main__:   all services created
19:46:22 [INFO] __main__: Wiring event handlers …
19:46:22 [INFO] __main__:   event handlers registered
19:46:22 [INFO] gameserver.engine.empire_service: Empire registered: uid=100 name='TestImperium'
19:46:22 [INFO] gameserver.engine.empire_service: Empire 100: recalculated effects → {}
19:46:22 [INFO] gameserver.engine.empire_service: Empire registered: uid=2 name='Empire1'
19:46:22 [INFO] gameserver.engine.empire_service: Empire 2: recalculated effects → {'life_offset': 0.001, 'gold_offset': 0.2, 'culture_offset': 0.15000000000000002, 'culture_modifier': 0.1, 'gold_modifier': 0.1, 'build_speed_modifier': 0.1}
19:46:22 [INFO] __main__: Restored 2 empires from saved state
19:46:22 [INFO] __main__: Starting network server …
19:46:22 [INFO] gameserver.network.handlers: Registered 31 message handlers: summary_request, item_request, military_request, map_load_request, map_save_request, new_item, new_structure, delete_structure, upgrade_structure, citizen_upgrade, change_citizen, increase_life, new_army, new_attack_request, change_army, new_wave, change_wave, end_siege, battle_register, battle_unregister, battle_next_wave_request, notification_request, user_message, timeline_request, userinfo_request, hall_of_fame_request, preferences_request, change_preferences, auth_request, signup, create_empire
19:46:22 [INFO] websockets.server: server listening on 0.0.0.0:8765
19:46:22 [INFO] gameserver.network.server: WebSocket server listening on ws://0.0.0.0:8765
19:46:22 [INFO] __main__:   WebSocket server listening on 0.0.0.0:8765
19:46:22 [INFO] gameserver.debug.dashboard: Debug dashboard running at http://0.0.0.0:9000/
19:46:22 [INFO] __main__: Starting game loop …
19:46:22 [INFO] __main__:   game loop running (1 s tick)
19:46:23 [INFO] websockets.server: connection open
19:46:23 [INFO] gameserver.network.server: Session registered: uid=-1
19:46:23 [INFO] gameserver.network.server: Client connected: uid=-1 remote=('192.168.178.2', 57154)
19:46:23 [INFO] gameserver.network.auth: Login success: eem (uid=2)
19:46:23 [INFO] gameserver.network.server: Session registered: uid=2
19:46:23 [INFO] gameserver.network.server: Session upgraded: guest=-1 → uid=2
19:46:24 [INFO] gameserver.network.server: Session removed: uid=2
19:46:24 [INFO] websockets.server: connection open
19:46:24 [INFO] gameserver.network.server: Session registered: uid=-2
19:46:24 [INFO] gameserver.network.server: Client connected: uid=-2 remote=('192.168.178.2', 57178)
19:46:24 [INFO] gameserver.network.auth: Login success: eem (uid=2)
19:46:24 [INFO] gameserver.network.server: Session registered: uid=2
19:46:24 [INFO] gameserver.network.server: Session upgraded: guest=-2 → uid=2
19:46:26 [WARNING] gameserver.network.handlers: Map validation failed for Empire1 (uid=2): No passable path found from spawnpoint to castle
19:46:32 [INFO] gameserver.network.handlers: Map saved for empire Empire1 (uid=2): 4 tiles
19:46:32 [INFO] gameserver.network.handlers: Map saved for empire Empire1 (uid=2): 4 tiles
19:47:34 [WARNING] gameserver.network.handlers: Map validation failed for Empire1 (uid=2): No passable path found from spawnpoint to castle
19:47:36 [WARNING] gameserver.network.handlers: Map validation failed for Empire1 (uid=2): Map must contain exactly 1 castle (found 2)
19:47:39 [INFO] gameserver.network.handlers: Map saved for empire Empire1 (uid=2): 4 tiles
19:47:45 [WARNING] gameserver.network.handlers: Map validation failed for Empire1 (uid=2): Map must contain exactly 1 castle (found 0); Map must contain at least 1 spawnpoint
19:47:50 [WARNING] gameserver.network.handlers: Map validation failed for Empire1 (uid=2): Map must contain exactly 1 castle (found 0); Map must contain at least 1 spawnpoint
19:47:54 [WARNING] gameserver.network.handlers: Map validation failed for Empire1 (uid=2): Map must contain exactly 1 castle (found 0); Map must contain at least 1 spawnpoint
19:48:17 [INFO] __main__: Shutdown signal received — stopping …
19:48:17 [INFO] __main__: Shutting down …
19:48:17 [INFO] gameserver.persistence.state_save: Game state saved to state.yaml (2 empires, 0 attacks, 0 battles)
19:48:17 [INFO] websockets.server: server closing
19:48:17 [INFO] gameserver.network.server: Session removed: uid=2
19:48:17 [INFO] websockets.server: server closed
19:48:17 [INFO] gameserver.network.server: WebSocket server stopped
19:48:17 [INFO] __main__:   WebSocket server stopped
19:48:17 [INFO] __main__:   debug dashboard stopped
19:48:17 [INFO] __main__:   database closed
19:48:17 [INFO] __main__:   goodbye
19:48:26 [INFO] __main__: === Game Server starting ===
19:48:26 [INFO] __main__: Loading configuration …
19:48:27 [INFO] __main__:   items:        210 loaded from config
19:48:27 [INFO] __main__:   map:          4 paths, 23 build tiles from config/maps/default.yaml
19:48:27 [INFO] __main__:   ai_templates: 2 entries from config/ai_templates.yaml
19:48:27 [INFO] gameserver.loaders.game_config_loader: Loaded game config from config/game.yaml (29 keys)
19:48:27 [INFO] __main__:   game_config:  loaded
19:48:27 [INFO] __main__: Initializing persistence …
19:48:27 [INFO] gameserver.persistence.database: Database connected: gameserver.db
19:48:27 [INFO] __main__:   database:     connected (gameserver.db)
19:48:27 [INFO] gameserver.persistence.state_load: Restoring state from state.yaml (saved at 2026-02-08T19:48:17, version 1)
19:48:27 [INFO] gameserver.persistence.state_load: Restored 2 empires, 0 attacks, 0 battles
19:48:27 [INFO] __main__:   state:        restored from disk (2 empires, 0 attacks)
19:48:27 [INFO] __main__: Creating services …
19:48:27 [INFO] __main__:   upgrade_provider: 210 items registered
19:48:27 [INFO] __main__:   all services created
19:48:27 [INFO] __main__: Wiring event handlers …
19:48:27 [INFO] __main__:   event handlers registered
19:48:27 [INFO] gameserver.engine.empire_service: Empire registered: uid=100 name='TestImperium'
19:48:27 [INFO] gameserver.engine.empire_service: Empire 100: recalculated effects → {}
19:48:27 [INFO] gameserver.engine.empire_service: Empire registered: uid=2 name='Empire1'
19:48:27 [INFO] gameserver.engine.empire_service: Empire 2: recalculated effects → {'life_offset': 0.001, 'gold_offset': 0.2, 'culture_offset': 0.15000000000000002, 'culture_modifier': 0.1, 'gold_modifier': 0.1, 'build_speed_modifier': 0.1}
19:48:27 [INFO] __main__: Restored 2 empires from saved state
19:48:27 [INFO] __main__: Starting network server …
19:48:27 [INFO] gameserver.network.handlers: Registered 31 message handlers: summary_request, item_request, military_request, map_load_request, map_save_request, new_item, new_structure, delete_structure, upgrade_structure, citizen_upgrade, change_citizen, increase_life, new_army, new_attack_request, change_army, new_wave, change_wave, end_siege, battle_register, battle_unregister, battle_next_wave_request, notification_request, user_message, timeline_request, userinfo_request, hall_of_fame_request, preferences_request, change_preferences, auth_request, signup, create_empire
19:48:27 [INFO] websockets.server: server listening on 0.0.0.0:8765
19:48:27 [INFO] gameserver.network.server: WebSocket server listening on ws://0.0.0.0:8765
19:48:27 [INFO] __main__:   WebSocket server listening on 0.0.0.0:8765
19:48:27 [INFO] gameserver.debug.dashboard: Debug dashboard running at http://0.0.0.0:9000/
19:48:27 [INFO] __main__: Starting game loop …
19:48:27 [INFO] __main__:   game loop running (1 s tick)
19:48:27 [INFO] websockets.server: connection open
19:48:27 [INFO] gameserver.network.server: Session registered: uid=-1
19:48:27 [INFO] gameserver.network.server: Client connected: uid=-1 remote=('192.168.178.2', 60280)
19:48:27 [INFO] gameserver.network.auth: Login success: eem (uid=2)
19:48:27 [INFO] gameserver.network.server: Session registered: uid=2
19:48:27 [INFO] gameserver.network.server: Session upgraded: guest=-1 → uid=2
19:48:28 [ERROR] websockets.server: opening handshake failed
Traceback (most recent call last):
  File "/home/pi/e3/.venv/lib/python3.9/site-packages/websockets/http11.py", line 138, in parse
    request_line = yield from parse_line(read_line)
  File "/home/pi/e3/.venv/lib/python3.9/site-packages/websockets/http11.py", line 309, in parse_line
    line = yield from read_line(MAX_LINE_LENGTH)
  File "/home/pi/e3/.venv/lib/python3.9/site-packages/websockets/streams.py", line 46, in read_line
    raise EOFError(f"stream ends after {p} bytes, before end of line")
EOFError: stream ends after 0 bytes, before end of line

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/pi/e3/.venv/lib/python3.9/site-packages/websockets/server.py", line 545, in parse
    request = yield from Request.parse(
  File "/home/pi/e3/.venv/lib/python3.9/site-packages/websockets/http11.py", line 140, in parse
    raise EOFError("connection closed while reading HTTP request line") from exc
EOFError: connection closed while reading HTTP request line

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/pi/e3/.venv/lib/python3.9/site-packages/websockets/asyncio/server.py", line 356, in conn_handler
    await connection.handshake(
  File "/home/pi/e3/.venv/lib/python3.9/site-packages/websockets/asyncio/server.py", line 207, in handshake
    raise self.protocol.handshake_exc
websockets.exceptions.InvalidMessage: did not receive a valid HTTP request
19:48:28 [INFO] gameserver.network.server: Session removed: uid=2
19:48:28 [INFO] websockets.server: connection open
19:48:28 [INFO] gameserver.network.server: Session registered: uid=-2
19:48:28 [INFO] gameserver.network.server: Client connected: uid=-2 remote=('192.168.178.2', 60307)
19:48:28 [INFO] gameserver.network.auth: Login success: eem (uid=2)
19:48:28 [INFO] gameserver.network.server: Session registered: uid=2
19:48:28 [INFO] gameserver.network.server: Session upgraded: guest=-2 → uid=2
19:48:43 [INFO] __main__: Shutdown signal received — stopping …
19:48:43 [INFO] __main__: Shutting down …
19:48:43 [INFO] gameserver.persistence.state_save: Game state saved to state.yaml (2 empires, 0 attacks, 0 battles)
19:48:43 [INFO] websockets.server: server closing
19:48:43 [INFO] gameserver.network.server: Session removed: uid=2
19:48:43 [INFO] websockets.server: server closed
19:48:43 [INFO] gameserver.network.server: WebSocket server stopped
19:48:43 [INFO] __main__:   WebSocket server stopped
19:48:43 [INFO] __main__:   debug dashboard stopped
19:48:43 [INFO] __main__:   database closed
19:48:43 [INFO] __main__:   goodbye
19:48:48 [INFO] __main__: === Game Server starting ===
19:48:48 [INFO] __main__: Loading configuration …
19:48:49 [INFO] __main__:   items:        210 loaded from config
19:48:49 [INFO] __main__:   map:          4 paths, 23 build tiles from config/maps/default.yaml
19:48:49 [INFO] __main__:   ai_templates: 2 entries from config/ai_templates.yaml
19:48:49 [INFO] gameserver.loaders.game_config_loader: Loaded game config from config/game.yaml (29 keys)
19:48:49 [INFO] __main__:   game_config:  loaded
19:48:49 [INFO] __main__: Initializing persistence …
19:48:49 [INFO] gameserver.persistence.database: Database connected: gameserver.db
19:48:49 [INFO] __main__:   database:     connected (gameserver.db)
19:48:49 [INFO] gameserver.persistence.state_load: Restoring state from state.yaml (saved at 2026-02-08T19:48:43, version 1)
19:48:49 [INFO] gameserver.persistence.state_load: Restored 2 empires, 0 attacks, 0 battles
19:48:49 [INFO] __main__:   state:        restored from disk (2 empires, 0 attacks)
19:48:49 [INFO] __main__: Creating services …
19:48:49 [INFO] __main__:   upgrade_provider: 210 items registered
19:48:49 [INFO] __main__:   all services created
19:48:49 [INFO] __main__: Wiring event handlers …
19:48:49 [INFO] __main__:   event handlers registered
19:48:49 [INFO] gameserver.engine.empire_service: Empire registered: uid=100 name='TestImperium'
19:48:49 [INFO] gameserver.engine.empire_service: Empire 100: recalculated effects → {}
19:48:49 [INFO] gameserver.engine.empire_service: Empire registered: uid=2 name='Empire1'
19:48:49 [INFO] gameserver.engine.empire_service: Empire 2: recalculated effects → {'life_offset': 0.001, 'gold_offset': 0.2, 'culture_offset': 0.15000000000000002, 'culture_modifier': 0.1, 'gold_modifier': 0.1, 'build_speed_modifier': 0.1}
19:48:49 [INFO] __main__: Restored 2 empires from saved state
19:48:49 [INFO] __main__: Starting network server …
19:48:49 [INFO] gameserver.network.handlers: Registered 31 message handlers: summary_request, item_request, military_request, map_load_request, map_save_request, new_item, new_structure, delete_structure, upgrade_structure, citizen_upgrade, change_citizen, increase_life, new_army, new_attack_request, change_army, new_wave, change_wave, end_siege, battle_register, battle_unregister, battle_next_wave_request, notification_request, user_message, timeline_request, userinfo_request, hall_of_fame_request, preferences_request, change_preferences, auth_request, signup, create_empire
19:48:49 [INFO] websockets.server: server listening on 0.0.0.0:8765
19:48:49 [INFO] gameserver.network.server: WebSocket server listening on ws://0.0.0.0:8765
19:48:49 [INFO] __main__:   WebSocket server listening on 0.0.0.0:8765
19:48:49 [INFO] gameserver.debug.dashboard: Debug dashboard running at http://0.0.0.0:9000/
19:48:49 [INFO] __main__: Starting game loop …
19:48:49 [INFO] __main__:   game loop running (1 s tick)
19:48:51 [INFO] websockets.server: connection open
19:48:51 [INFO] gameserver.network.server: Session registered: uid=-1
19:48:51 [INFO] gameserver.network.server: Client connected: uid=-1 remote=('192.168.178.2', 57549)
19:48:51 [INFO] gameserver.network.auth: Login success: eem (uid=2)
19:48:51 [INFO] gameserver.network.server: Session registered: uid=2
19:48:51 [INFO] gameserver.network.server: Session upgraded: guest=-1 → uid=2
19:48:52 [INFO] gameserver.network.server: Session removed: uid=2
19:48:52 [INFO] websockets.server: connection open
19:48:52 [INFO] gameserver.network.server: Session registered: uid=-2
19:48:52 [INFO] gameserver.network.server: Client connected: uid=-2 remote=('192.168.178.2', 57552)
19:48:52 [INFO] gameserver.network.auth: Login success: eem (uid=2)
19:48:52 [INFO] gameserver.network.server: Session registered: uid=2
19:48:52 [INFO] gameserver.network.server: Session upgraded: guest=-2 → uid=2
19:48:58 [INFO] gameserver.network.handlers: Map saved for empire Empire1 (uid=2): 3 tiles
19:48:58 [INFO] gameserver.network.handlers: Map saved for empire Empire1 (uid=2): 3 tiles
19:52:42 [INFO] gameserver.network.server: Session removed: uid=2
19:52:42 [INFO] websockets.server: connection open
19:52:42 [INFO] gameserver.network.server: Session registered: uid=-3
19:52:42 [INFO] gameserver.network.server: Client connected: uid=-3 remote=('192.168.178.2', 56083)
19:52:42 [INFO] gameserver.network.auth: Login success: eem (uid=2)
19:52:42 [INFO] gameserver.network.server: Session registered: uid=2
19:52:42 [INFO] gameserver.network.server: Session upgraded: guest=-3 → uid=2
19:57:15 [INFO] gameserver.network.server: Session removed: uid=2
19:57:16 [INFO] websockets.server: connection open
19:57:16 [INFO] gameserver.network.server: Session registered: uid=-4
19:57:16 [INFO] gameserver.network.server: Client connected: uid=-4 remote=('192.168.178.2', 54140)
19:57:16 [INFO] gameserver.network.auth: Login success: eem (uid=2)
19:57:16 [INFO] gameserver.network.server: Session registered: uid=2
19:57:16 [INFO] gameserver.network.server: Session upgraded: guest=-4 → uid=2
20:06:19 [INFO] __main__: === Game Server starting ===
20:06:19 [INFO] __main__: Loading configuration …
20:06:19 [INFO] __main__:   items:        210 loaded from config
20:06:19 [INFO] __main__:   map:          4 paths, 23 build tiles from config/maps/default.yaml
20:06:19 [INFO] __main__:   ai_templates: 2 entries from config/ai_templates.yaml
20:06:19 [INFO] gameserver.loaders.game_config_loader: Loaded game config from config/game.yaml (29 keys)
20:06:19 [INFO] __main__:   game_config:  loaded
20:06:19 [INFO] __main__: Initializing persistence …
20:06:19 [INFO] gameserver.persistence.database: Database connected: gameserver.db
20:06:19 [INFO] __main__:   database:     connected (gameserver.db)
20:06:19 [INFO] gameserver.persistence.state_load: Restoring state from state.yaml (saved at 2026-02-08T19:48:43, version 1)
20:06:19 [ERROR] gameserver.persistence.state_load: Failed to restore empire: 100
Traceback (most recent call last):
  File "/home/pi/e3/python_server/src/gameserver/persistence/state_load.py", line 90, in load_state
    empire = _deserialize_empire(empire_dict)
  File "/home/pi/e3/python_server/src/gameserver/persistence/state_load.py", line 143, in _deserialize_empire
    armies = [_deserialize_army(a) for a in d.get("armies", [])]
  File "/home/pi/e3/python_server/src/gameserver/persistence/state_load.py", line 143, in <listcomp>
    armies = [_deserialize_army(a) for a in d.get("armies", [])]
  File "/home/pi/e3/python_server/src/gameserver/persistence/state_load.py", line 220, in _deserialize_army
    aid=d["aid"],
KeyError: 'aid'
20:06:19 [INFO] gameserver.persistence.state_load: Restored 1 empires, 0 attacks, 0 battles
20:06:19 [INFO] __main__:   state:        restored from disk (1 empires, 0 attacks)
20:06:19 [INFO] __main__: Creating services …
20:06:19 [INFO] __main__:   upgrade_provider: 210 items registered
20:06:19 [INFO] __main__:   all services created
20:06:19 [INFO] __main__: Wiring event handlers …
20:06:19 [INFO] __main__:   event handlers registered
20:06:19 [INFO] gameserver.engine.empire_service: Empire registered: uid=2 name='Empire1'
20:06:19 [INFO] gameserver.engine.empire_service: Empire 2: recalculated effects → {'life_offset': 0.001, 'gold_offset': 0.2, 'culture_offset': 0.15000000000000002, 'culture_modifier': 0.1, 'gold_modifier': 0.1, 'build_speed_modifier': 0.1}
20:06:19 [INFO] __main__: Restored 1 empires from saved state
20:06:19 [INFO] __main__: Starting network server …
20:06:19 [INFO] gameserver.network.handlers: Registered 32 message handlers: summary_request, item_request, military_request, map_load_request, map_save_request, new_item, new_structure, delete_structure, upgrade_structure, citizen_upgrade, change_citizen, increase_life, new_army, new_attack_request, change_army, new_wave, change_wave, end_siege, battle_register, battle_unregister, battle_next_wave_request, notification_request, user_message, timeline_request, userinfo_request, hall_of_fame_request, preferences_request, change_preferences, auth_request, signup, create_empire, battle_test_start
Traceback (most recent call last):
  File "/usr/lib/python3.9/runpy.py", line 197, in _run_module_as_main
    return _run_code(code, main_globals, None,
  File "/usr/lib/python3.9/runpy.py", line 87, in _run_code
    exec(code, run_globals)
  File "/home/pi/e3/python_server/src/gameserver/main.py", line 426, in <module>
    main()
  File "/home/pi/e3/python_server/src/gameserver/main.py", line 422, in main
    asyncio.run(_start())
  File "/usr/lib/python3.9/asyncio/runners.py", line 44, in run
    return loop.run_until_complete(main)
  File "/usr/lib/python3.9/asyncio/base_events.py", line 642, in run_until_complete
    return future.result()
  File "/home/pi/e3/python_server/src/gameserver/main.py", line 397, in _start
    await start_network(services)
  File "/home/pi/e3/python_server/src/gameserver/main.py", line 288, in start_network
    await services.server.start()
  File "/home/pi/e3/python_server/src/gameserver/network/server.py", line 57, in start
    self._server = await websockets.serve(
  File "/home/pi/e3/.venv/lib/python3.9/site-packages/websockets/asyncio/server.py", line 831, in __await_impl__
    server = await self.create_server
  File "/usr/lib/python3.9/asyncio/base_events.py", line 1494, in create_server
    raise OSError(err.errno, 'error while attempting '
OSError: [Errno 98] error while attempting to bind on address ('0.0.0.0', 8765): address already in use
20:06:23 [INFO] gameserver.network.server: Session removed: uid=2
20:06:23 [INFO] websockets.server: connection open
20:06:23 [INFO] gameserver.network.server: Session registered: uid=-5
20:06:23 [INFO] gameserver.network.server: Client connected: uid=-5 remote=('192.168.178.2', 49618)
20:06:23 [INFO] gameserver.network.auth: Login success: eem (uid=2)
20:06:23 [INFO] gameserver.network.server: Session registered: uid=2
20:06:23 [INFO] gameserver.network.server: Session upgraded: guest=-5 → uid=2
20:07:13 [INFO] gameserver.network.server: Session removed: uid=2
20:07:13 [INFO] websockets.server: connection open
20:07:13 [INFO] gameserver.network.server: Session registered: uid=-6
20:07:13 [INFO] gameserver.network.server: Client connected: uid=-6 remote=('192.168.178.2', 49660)
20:07:13 [INFO] gameserver.network.auth: Login success: eem (uid=2)
20:07:13 [INFO] gameserver.network.server: Session registered: uid=2
20:07:13 [INFO] gameserver.network.server: Session upgraded: guest=-6 → uid=2
20:10:07 [INFO] gameserver.network.server: Session removed: uid=2
20:10:07 [INFO] websockets.server: connection open
20:10:07 [INFO] gameserver.network.server: Session registered: uid=-7
20:10:07 [INFO] gameserver.network.server: Client connected: uid=-7 remote=('192.168.178.2', 54379)
20:10:07 [INFO] gameserver.network.auth: Login success: eem (uid=2)
20:10:07 [INFO] gameserver.network.server: Session registered: uid=2
20:10:07 [INFO] gameserver.network.server: Session upgraded: guest=-7 → uid=2
20:10:53 [INFO] __main__: Shutdown signal received — stopping …
20:10:53 [INFO] __main__: Shutting down …
20:10:53 [INFO] gameserver.persistence.state_save: Game state saved to state.yaml (2 empires, 0 attacks, 0 battles)
20:10:53 [INFO] websockets.server: server closing
20:10:53 [INFO] gameserver.network.server: Session removed: uid=2
20:10:53 [INFO] websockets.server: server closed
20:10:53 [INFO] gameserver.network.server: WebSocket server stopped
20:10:53 [INFO] __main__:   WebSocket server stopped
20:10:53 [INFO] __main__:   debug dashboard stopped
20:10:53 [INFO] __main__:   database closed
20:10:53 [INFO] __main__:   goodbye
20:12:57 [INFO] __main__: === Game Server starting ===
20:12:57 [INFO] __main__: Loading configuration …
20:12:58 [INFO] __main__:   items:        210 loaded from config
20:12:58 [INFO] __main__:   map:          4 paths, 23 build tiles from config/maps/default.yaml
20:12:58 [INFO] __main__:   ai_templates: 2 entries from config/ai_templates.yaml
20:12:58 [INFO] gameserver.loaders.game_config_loader: Loaded game config from config/game.yaml (29 keys)
20:12:58 [INFO] __main__:   game_config:  loaded
20:12:58 [INFO] __main__: Initializing persistence …
20:12:58 [INFO] gameserver.persistence.database: Database connected: gameserver.db
20:12:58 [INFO] __main__:   database:     connected (gameserver.db)
20:12:58 [INFO] gameserver.persistence.state_load: Restoring state from state.yaml (saved at 2026-02-08T20:12:55, version 1)
20:12:58 [INFO] gameserver.persistence.state_load: Restored 2 empires, 0 attacks, 0 battles
20:12:58 [INFO] __main__:   state:        restored from disk (2 empires, 0 attacks)
20:12:58 [INFO] __main__: Creating services …
20:12:58 [INFO] __main__:   upgrade_provider: 210 items registered
20:12:58 [INFO] __main__:   all services created
20:12:58 [INFO] __main__: Wiring event handlers …
20:12:58 [INFO] __main__:   event handlers registered
20:12:58 [INFO] gameserver.engine.empire_service: Empire registered: uid=100 name='TestImperium'
20:12:58 [INFO] gameserver.engine.empire_service: Empire 100: recalculated effects → {}
20:12:58 [INFO] gameserver.engine.empire_service: Empire registered: uid=2 name='Empire1'
20:12:58 [INFO] gameserver.engine.empire_service: Empire 2: recalculated effects → {'life_offset': 0.001, 'gold_offset': 0.2, 'culture_offset': 0.15000000000000002, 'culture_modifier': 0.1, 'gold_modifier': 0.1, 'build_speed_modifier': 0.1}
20:12:58 [INFO] __main__: Restored 2 empires from saved state
20:12:58 [INFO] __main__: Starting network server …
20:12:58 [INFO] gameserver.network.handlers: Registered 32 message handlers: summary_request, item_request, military_request, map_load_request, map_save_request, new_item, new_structure, delete_structure, upgrade_structure, citizen_upgrade, change_citizen, increase_life, new_army, new_attack_request, change_army, new_wave, change_wave, end_siege, battle_register, battle_unregister, battle_next_wave_request, notification_request, user_message, timeline_request, userinfo_request, hall_of_fame_request, preferences_request, change_preferences, auth_request, signup, create_empire, battle_test_start
20:12:58 [INFO] websockets.server: server listening on 0.0.0.0:8765
20:12:58 [INFO] gameserver.network.server: WebSocket server listening on ws://0.0.0.0:8765
20:12:58 [INFO] __main__:   WebSocket server listening on 0.0.0.0:8765
20:12:58 [INFO] gameserver.debug.dashboard: Debug dashboard running at http://0.0.0.0:9000/
20:12:58 [INFO] __main__: Starting game loop …
20:12:58 [INFO] __main__:   game loop running (1 s tick)
20:12:59 [INFO] websockets.server: connection open
20:12:59 [INFO] gameserver.network.server: Session registered: uid=-1
20:12:59 [INFO] gameserver.network.server: Client connected: uid=-1 remote=('192.168.178.2', 55598)
20:12:59 [INFO] gameserver.network.auth: Login success: eem (uid=2)
20:12:59 [INFO] gameserver.network.server: Session registered: uid=2
20:12:59 [INFO] gameserver.network.server: Session upgraded: guest=-1 → uid=2
20:13:02 [INFO] gameserver.network.server: Session removed: uid=2
20:13:02 [INFO] websockets.server: connection open
20:13:02 [INFO] gameserver.network.server: Session registered: uid=-2
20:13:02 [INFO] gameserver.network.server: Client connected: uid=-2 remote=('192.168.178.2', 55622)
20:13:02 [INFO] gameserver.network.auth: Login success: eem (uid=2)
20:13:02 [INFO] gameserver.network.server: Session registered: uid=2
20:13:02 [INFO] gameserver.network.server: Session upgraded: guest=-2 → uid=2
20:15:40 [INFO] gameserver.network.server: Session removed: uid=2
20:15:41 [INFO] websockets.server: connection open
20:15:41 [INFO] gameserver.network.server: Session registered: uid=-3
20:15:41 [INFO] gameserver.network.server: Client connected: uid=-3 remote=('192.168.178.2', 63863)
20:15:41 [INFO] gameserver.network.auth: Login success: eem (uid=2)
20:15:41 [INFO] gameserver.network.server: Session registered: uid=2
20:15:41 [INFO] gameserver.network.server: Session upgraded: guest=-3 → uid=2
20:18:52 [INFO] __main__: Shutdown signal received — stopping …
20:18:52 [INFO] __main__: Shutting down …
20:18:52 [INFO] gameserver.persistence.state_save: Game state saved to state.yaml (2 empires, 0 attacks, 0 battles)
20:18:52 [INFO] websockets.server: server closing
20:18:52 [INFO] gameserver.network.server: Session removed: uid=2
20:18:52 [INFO] websockets.server: server closed
20:18:52 [INFO] gameserver.network.server: WebSocket server stopped
20:18:52 [INFO] __main__:   WebSocket server stopped
20:18:52 [INFO] __main__:   debug dashboard stopped
20:18:52 [INFO] __main__:   database closed
20:18:52 [INFO] __main__:   goodbye
